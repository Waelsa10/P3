{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/waels/OneDrive/Desktop/Expo%20projects/P3/utils/getRecipientEmail.js"],"sourcesContent":["// utils/getRecipientEmail.js\r\n\r\n/**\r\n * Get the recipient email for a chat (WhatsApp-style)\r\n * @param {string[]} users - Array of user emails in the chat\r\n * @param {Object} userLoggedIn - Current logged-in user\r\n * @returns {string|null} Recipient email or null\r\n */\r\nconst getRecipientEmail = (users, userLoggedIn) => {\r\n  // ===================================\r\n  // 1ï¸âƒ£ VALIDATION\r\n  // ===================================\r\n  if (!users || !Array.isArray(users) || !userLoggedIn?.email) {\r\n    return null;\r\n  }\r\n\r\n  const currentUserEmail = userLoggedIn.email.toLowerCase().trim();\r\n  \r\n  // Clean and normalize all emails\r\n  const cleanedUsers = users\r\n    .filter(email => email && typeof email === 'string')\r\n    .map(email => email.toLowerCase().trim());\r\n\r\n  // Chat must have at least 1 user\r\n  if (cleanedUsers.length === 0) {\r\n    return null;\r\n  }\r\n\r\n  // ===================================\r\n  // 2ï¸âƒ£ SELF-CHAT DETECTION (Saved Messages)\r\n  // ===================================\r\n  // Get unique participants\r\n  const uniqueParticipants = [...new Set(cleanedUsers)];\r\n\r\n  // If there's only ONE unique participant and it's ME â†’ Self-chat\r\n  if (uniqueParticipants.length === 1 && uniqueParticipants[0] === currentUserEmail) {\r\n    return currentUserEmail;\r\n  }\r\n\r\n  // ===================================\r\n  // 3ï¸âƒ£ REGULAR CHAT - Find Other Person\r\n  // ===================================\r\n  // Find the first person who is NOT me\r\n  const recipient = cleanedUsers.find(email => email !== currentUserEmail);\r\n\r\n  if (recipient) {\r\n    return recipient;\r\n  }\r\n\r\n  // No valid recipient found\r\n  return null;\r\n};\r\n\r\nexport default getRecipientEmail;"],"names":[],"mappings":"AAAA,6BAA6B;AAE7B;;;;;CAKC;;;;AACD,MAAM,oBAAoB,CAAC,OAAO;IAChC,sCAAsC;IACtC,iBAAiB;IACjB,sCAAsC;IACtC,IAAI,CAAC,SAAS,CAAC,MAAM,OAAO,CAAC,UAAU,CAAC,cAAc,OAAO;QAC3D,OAAO;IACT;IAEA,MAAM,mBAAmB,aAAa,KAAK,CAAC,WAAW,GAAG,IAAI;IAE9D,iCAAiC;IACjC,MAAM,eAAe,MAClB,MAAM,CAAC,CAAA,QAAS,SAAS,OAAO,UAAU,UAC1C,GAAG,CAAC,CAAA,QAAS,MAAM,WAAW,GAAG,IAAI;IAExC,iCAAiC;IACjC,IAAI,aAAa,MAAM,KAAK,GAAG;QAC7B,OAAO;IACT;IAEA,sCAAsC;IACtC,2CAA2C;IAC3C,sCAAsC;IACtC,0BAA0B;IAC1B,MAAM,qBAAqB;WAAI,IAAI,IAAI;KAAc;IAErD,iEAAiE;IACjE,IAAI,mBAAmB,MAAM,KAAK,KAAK,kBAAkB,CAAC,EAAE,KAAK,kBAAkB;QACjF,OAAO;IACT;IAEA,sCAAsC;IACtC,uCAAuC;IACvC,sCAAsC;IACtC,sCAAsC;IACtC,MAAM,YAAY,aAAa,IAAI,CAAC,CAAA,QAAS,UAAU;IAEvD,IAAI,WAAW;QACb,OAAO;IACT;IAEA,2BAA2B;IAC3B,OAAO;AACT;uCAEe","debugId":null}},
    {"offset": {"line": 61, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/waels/OneDrive/Desktop/Expo%20projects/P3/components/ChatScreen/components/MessageStatus.jsx"],"sourcesContent":["// components/ChatScreen/components/MessageStatus.jsx\r\n\r\nimport React from \"react\";\r\nimport styled from \"styled-components\";\r\nimport DoneIcon from \"@mui/icons-material/Done\";\r\nimport DoneAllIcon from \"@mui/icons-material/DoneAll\";\r\nimport AccessTimeIcon from \"@mui/icons-material/AccessTime\";\r\nimport { MESSAGE_STATUS } from \"../constants\";\r\n\r\nfunction MessageStatus({ status, darkMode }) {\r\n  if (!status || status === MESSAGE_STATUS.SENT) {\r\n    // Single gray checkmark for sent\r\n    return (\r\n      <StatusIcon darkMode={darkMode}>\r\n        <DoneIcon style={{ fontSize: 16 }} />\r\n      </StatusIcon>\r\n    );\r\n  }\r\n\r\n  if (status === MESSAGE_STATUS.DELIVERED) {\r\n    // Double gray checkmarks for delivered\r\n    return (\r\n      <StatusIcon darkMode={darkMode}>\r\n        <DoneAllIcon style={{ fontSize: 16 }} />\r\n      </StatusIcon>\r\n    );\r\n  }\r\n\r\n  if (status === MESSAGE_STATUS.READ) {\r\n    // Double blue checkmarks for read\r\n    return (\r\n      <StatusIcon darkMode={darkMode} isRead={true}>\r\n        <DoneAllIcon style={{ fontSize: 16 }} />\r\n      </StatusIcon>\r\n    );\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\nexport default MessageStatus;\r\n\r\nconst StatusIcon = styled.span`\r\n  display: inline-flex;\r\n  align-items: center;\r\n  color: ${props => props.isRead ? '#53bdeb' : (props.darkMode ? '#8696a0' : '#667781')};\r\n  margin-left: 4px;\r\n`;\r\n\r\n// Styled Components\r\nconst StatusContainer = styled.span`\r\n  display: inline-flex;\r\n  align-items: center;\r\n  margin-left: 4px;\r\n  vertical-align: middle;\r\n`;\r\n\r\nconst SingleCheck = styled(DoneIcon)`\r\n  font-size: 16px !important;\r\n  color: ${props => props.darkMode ? '#8696a0' : '#667781'};\r\n`;\r\n\r\nconst DoubleCheckGray = styled(DoneAllIcon)`\r\n  font-size: 16px !important;\r\n  color: ${props => props.darkMode ? '#8696a0' : '#667781'};\r\n`;\r\n\r\nconst DoubleCheckBlue = styled(DoneAllIcon)`\r\n  font-size: 16px !important;\r\n  color: #53bdeb;\r\n`;\r\n\r\nconst PendingIcon = styled(AccessTimeIcon)`\r\n  font-size: 14px !important;\r\n  color: ${props => props.darkMode ? '#8696a0' : '#667781'};\r\n  opacity: 0.6;\r\n`;"],"names":[],"mappings":"AAAA,qDAAqD;;;;;;AAErD;AACA;AACA;AACA;AACA;AACA;;;;;;;;AAEA,SAAS,cAAc,EAAE,MAAM,EAAE,QAAQ,EAAE;IACzC,IAAI,CAAC,UAAU,WAAW,gJAAc,CAAC,IAAI,EAAE;QAC7C,iCAAiC;QACjC,qBACE,qKAAC;YAAW,UAAU;sBACpB,cAAA,qKAAC,sJAAQ;gBAAC,OAAO;oBAAE,UAAU;gBAAG;;;;;;;;;;;IAGtC;IAEA,IAAI,WAAW,gJAAc,CAAC,SAAS,EAAE;QACvC,uCAAuC;QACvC,qBACE,qKAAC;YAAW,UAAU;sBACpB,cAAA,qKAAC,yJAAW;gBAAC,OAAO;oBAAE,UAAU;gBAAG;;;;;;;;;;;IAGzC;IAEA,IAAI,WAAW,gJAAc,CAAC,IAAI,EAAE;QAClC,kCAAkC;QAClC,qBACE,qKAAC;YAAW,UAAU;YAAU,QAAQ;sBACtC,cAAA,qKAAC,yJAAW;gBAAC,OAAO;oBAAE,UAAU;gBAAG;;;;;;;;;;;IAGzC;IAEA,OAAO;AACT;uCAEe;AAEf,MAAM,aAAa,4IAAM,CAAC,IAAI,CAAC;;;SAGtB,EAAE,CAAA,QAAS,MAAM,MAAM,GAAG,YAAa,MAAM,QAAQ,GAAG,YAAY,UAAW;;AAExF,CAAC;AAED,oBAAoB;AACpB,MAAM,kBAAkB,4IAAM,CAAC,IAAI,CAAC;;;;;AAKpC,CAAC;AAED,MAAM,cAAc,IAAA,4IAAM,EAAC,sJAAQ,CAAC,CAAC;;SAE5B,EAAE,CAAA,QAAS,MAAM,QAAQ,GAAG,YAAY,UAAU;AAC3D,CAAC;AAED,MAAM,kBAAkB,IAAA,4IAAM,EAAC,yJAAW,CAAC,CAAC;;SAEnC,EAAE,CAAA,QAAS,MAAM,QAAQ,GAAG,YAAY,UAAU;AAC3D,CAAC;AAED,MAAM,kBAAkB,IAAA,4IAAM,EAAC,yJAAW,CAAC,CAAC;;;AAG5C,CAAC;AAED,MAAM,cAAc,IAAA,4IAAM,EAAC,4JAAc,CAAC,CAAC;;SAElC,EAAE,CAAA,QAAS,MAAM,QAAQ,GAAG,YAAY,UAAU;;AAE3D,CAAC","debugId":null}},
    {"offset": {"line": 178, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/waels/OneDrive/Desktop/Expo%20projects/P3/components/Chat.js"],"sourcesContent":["// components/Chat.jsx\r\nimport React, { useEffect, useState, useContext, useMemo } from \"react\";\r\nimport styled from \"styled-components\";\r\nimport { Avatar } from \"@mui/material\";\r\nimport { useAuthState } from \"react-firebase-hooks/auth\";\r\nimport { auth, db } from \"../firebase\";\r\nimport getRecipientEmail from \"../utils/getRecipientEmail\";\r\nimport { useRouter } from \"next/router\";\r\nimport { \r\n  collection, \r\n  query, \r\n  where, \r\n  orderBy, \r\n  limit,\r\n  onSnapshot \r\n} from \"firebase/firestore\";\r\nimport { useCollection } from \"react-firebase-hooks/firestore\";\r\nimport MessageStatus from \"./ChatScreen/components/MessageStatus\";\r\nimport { MESSAGE_STATUS } from \"./ChatScreen/constants\";\r\nimport { DarkModeContext } from \"./DarkModeProvider\";\r\n\r\nconst Chat = React.memo(({ id, users, latestMessage: propLatestMessage, customDisplayName }) => {\r\n  const router = useRouter();\r\n  const [user] = useAuthState(auth);\r\n  const [latestMessage, setLatestMessage] = useState(propLatestMessage || null);\r\n  const [unreadCount, setUnreadCount] = useState(0);\r\n\r\n  // Get dark mode context\r\n  const darkModeContext = useContext(DarkModeContext);\r\n  const { darkMode } = darkModeContext || { darkMode: false };\r\n\r\n  // âœ… MEMOIZED: Calculate recipient email\r\n  const recipientEmail = useMemo(() => {\r\n    if (!users || !user) return null;\r\n    return getRecipientEmail(users, user);\r\n  }, [users, user]);\r\n\r\n  // âœ… MEMOIZED: Check if self-chat\r\n  const isSelfChat = useMemo(() => {\r\n    if (!users || !user) return false;\r\n    const cleanUsers = [...new Set(users.filter(Boolean).map(e => e.toLowerCase()))];\r\n    return cleanUsers.length === 1 && cleanUsers[0] === user.email.toLowerCase();\r\n  }, [users, user]);\r\n\r\n  // âœ… MEMOIZED: Get display name (custom name or email)\r\n  const displayName = useMemo(() => {\r\n    if (isSelfChat) {\r\n      return customDisplayName || recipientEmail || user?.email;\r\n    }\r\n    return customDisplayName || recipientEmail;\r\n  }, [customDisplayName, recipientEmail, isSelfChat, user?.email]);\r\n\r\n  // Get recipient info - only query if recipientEmail exists\r\n  const recipientQuery = recipientEmail && !isSelfChat\r\n    ? query(collection(db, \"users\"), where(\"email\", \"==\", recipientEmail))\r\n    : null;\r\n  const [recipientSnapshot] = useCollection(recipientQuery);\r\n  const recipient = recipientSnapshot?.docs?.[0]?.data();\r\n\r\n  // Real-time listener for latest message and unread count\r\n  useEffect(() => {\r\n    // Exit early if required data is missing\r\n    if (!id || !user || !recipientEmail) {\r\n      return;\r\n    }\r\n\r\n    // Real-time listener for latest message\r\n    const messagesRef = collection(db, \"chats\", id, \"messages\");\r\n    const q = query(messagesRef, orderBy(\"timestamp\", \"desc\"), limit(1));\r\n    \r\n    const unsubscribeMessages = onSnapshot(\r\n      q, \r\n      (snapshot) => {\r\n        if (!snapshot.empty) {\r\n          const messageData = snapshot.docs[0].data();\r\n          setLatestMessage({\r\n            id: snapshot.docs[0].id,\r\n            ...messageData,\r\n            timestamp: messageData.timestamp?.toMillis(),\r\n          });\r\n        } else {\r\n          setLatestMessage(null);\r\n        }\r\n      }, \r\n      (error) => {\r\n        console.error(\"Error listening to messages:\", error);\r\n      }\r\n    );\r\n\r\n    // Real-time listener for unread count (skip for self-chat)\r\n    let unsubscribeUnread = () => {};\r\n    \r\n    if (!isSelfChat && recipientEmail) {\r\n      const unreadQuery = query(\r\n        messagesRef,\r\n        where(\"user\", \"==\", recipientEmail),\r\n        where(\"status\", \"in\", [MESSAGE_STATUS.SENT, MESSAGE_STATUS.DELIVERED])\r\n      );\r\n      \r\n      unsubscribeUnread = onSnapshot(\r\n        unreadQuery, \r\n        (snapshot) => {\r\n          setUnreadCount(snapshot.docs.length);\r\n        }, \r\n        (error) => {\r\n          console.error(\"Error listening to unread count:\", error);\r\n          setUnreadCount(0);\r\n        }\r\n      );\r\n    }\r\n\r\n    return () => {\r\n      unsubscribeMessages();\r\n      unsubscribeUnread();\r\n    };\r\n  }, [id, user, recipientEmail, isSelfChat]);\r\n\r\n  const enterChat = () => {\r\n    router.push(`/chat/${id}`);\r\n  };\r\n\r\n  // âœ… MEMOIZED: Format timestamp\r\n  const formatTimestamp = useMemo(() => {\r\n    return (timestamp) => {\r\n      if (!timestamp) return \"\";\r\n      \r\n      const messageDate = new Date(timestamp);\r\n      const today = new Date();\r\n      const yesterday = new Date(today);\r\n      yesterday.setDate(yesterday.getDate() - 1);\r\n\r\n      // Check if today\r\n      if (messageDate.toDateString() === today.toDateString()) {\r\n        return messageDate.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\r\n      }\r\n      \r\n      // Check if yesterday\r\n      if (messageDate.toDateString() === yesterday.toDateString()) {\r\n        return \"Yesterday\";\r\n      }\r\n      \r\n      // Check if within this week\r\n      const weekAgo = new Date(today);\r\n      weekAgo.setDate(weekAgo.getDate() - 7);\r\n      if (messageDate > weekAgo) {\r\n        return messageDate.toLocaleDateString([], { weekday: 'short' });\r\n      }\r\n      \r\n      // Older messages\r\n      return messageDate.toLocaleDateString([], { month: 'short', day: 'numeric' });\r\n    };\r\n  }, []);\r\n\r\n  // âœ… MEMOIZED: Truncate message\r\n  const truncateMessage = useMemo(() => {\r\n    return (message, maxLength = 35) => {\r\n      if (!message) return \"\";\r\n      if (message.length <= maxLength) return message;\r\n      return message.substring(0, maxLength) + \"...\";\r\n    };\r\n  }, []);\r\n\r\n  // âœ… MEMOIZED: Get message preview\r\n  const messagePreview = useMemo(() => {\r\n    if (!latestMessage) return \"No messages yet\";\r\n\r\n    // Location message\r\n    if (latestMessage.location) {\r\n      return \"ðŸ“ Location\";\r\n    }\r\n\r\n    // Voice message\r\n    if (latestMessage.voiceURL) {\r\n      return \"ðŸŽ¤ Voice message\";\r\n    }\r\n\r\n    // File attachment\r\n    if (latestMessage.fileURL) {\r\n      if (latestMessage.fileType?.startsWith('image/')) {\r\n        return \"ðŸ“· Photo\";\r\n      }\r\n      if (latestMessage.fileType?.startsWith('video/')) {\r\n        return \"ðŸŽ¥ Video\";\r\n      }\r\n      if (latestMessage.fileType?.startsWith('audio/')) {\r\n        return \"ðŸŽµ Audio\";\r\n      }\r\n      return `ðŸ“Ž ${truncateMessage(latestMessage.fileName || 'File', 25)}`;\r\n    }\r\n\r\n    // Regular text message\r\n    return truncateMessage(latestMessage.message);\r\n  }, [latestMessage, truncateMessage]);\r\n\r\n  const isOwnMessage = latestMessage?.user === user?.email;\r\n  const hasUnread = unreadCount > 0 && !isOwnMessage;\r\n\r\n  // Don't render if missing essential data\r\n  if (!recipientEmail) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <Container onClick={enterChat} darkMode={darkMode}>\r\n      {isSelfChat ? (\r\n        <UserAvatar src={user?.photoURL}>{user?.email?.[0]?.toUpperCase()}</UserAvatar>\r\n      ) : recipient ? (\r\n        <UserAvatar src={recipient?.photoURL} />\r\n      ) : (\r\n        <UserAvatar>{recipientEmail?.[0]?.toUpperCase()}</UserAvatar>\r\n      )}\r\n      <ChatContent>\r\n        <ChatHeader>\r\n          <RecipientName darkMode={darkMode}>\r\n            {isSelfChat ? `${displayName} (You)` : displayName}\r\n          </RecipientName>\r\n          {latestMessage && (\r\n            <MessageTime darkMode={darkMode}>\r\n              {formatTimestamp(latestMessage.timestamp)}\r\n            </MessageTime>\r\n          )}\r\n        </ChatHeader>\r\n        <LastMessageContainer>\r\n          <LastMessage isOwnMessage={isOwnMessage}>\r\n            {isOwnMessage && latestMessage && (\r\n              <StatusWrapper>\r\n                <MessageStatus \r\n                  status={latestMessage.status || MESSAGE_STATUS.SENT}\r\n                  darkMode={darkMode}\r\n                />\r\n              </StatusWrapper>\r\n            )}\r\n            <MessageText hasUnread={hasUnread} darkMode={darkMode}>\r\n              {messagePreview}\r\n            </MessageText>\r\n          </LastMessage>\r\n          {hasUnread && (\r\n            <UnreadBadge darkMode={darkMode}>{unreadCount}</UnreadBadge>\r\n          )}\r\n        </LastMessageContainer>\r\n      </ChatContent>\r\n    </Container>\r\n  );\r\n}, (prevProps, nextProps) => {\r\n  // âœ… Custom comparison - only re-render if these change\r\n  return (\r\n    prevProps.id === nextProps.id &&\r\n    JSON.stringify(prevProps.users) === JSON.stringify(nextProps.users) &&\r\n    prevProps.latestMessage?.timestamp === nextProps.latestMessage?.timestamp &&\r\n    prevProps.latestMessage?.message === nextProps.latestMessage?.message &&\r\n    prevProps.customDisplayName === nextProps.customDisplayName\r\n  );\r\n});\r\n\r\nChat.displayName = 'Chat';\r\n\r\nexport default Chat;\r\n\r\n// Styled Components\r\nconst Container = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  cursor: pointer;\r\n  padding: 15px;\r\n  word-break: break-word;\r\n  transition: background-color 0.2s;\r\n\r\n  :hover {\r\n    background-color: ${props => props.darkMode ? '#2a2a2a' : '#f5f5f5'};\r\n  }\r\n`;\r\n\r\nconst UserAvatar = styled(Avatar)`\r\n  margin: 5px;\r\n  margin-right: 15px;\r\n  flex-shrink: 0;\r\n`;\r\n\r\nconst ChatContent = styled.div`\r\n  flex: 1;\r\n  display: flex;\r\n  flex-direction: column;\r\n  overflow: hidden;\r\n  min-width: 0;\r\n`;\r\n\r\nconst ChatHeader = styled.div`\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 4px;\r\n`;\r\n\r\nconst RecipientName = styled.p`\r\n  margin: 0;\r\n  font-weight: 600;\r\n  font-size: 15px;\r\n  color: ${props => props.darkMode ? '#e0e0e0' : '#000'};\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  white-space: nowrap;\r\n  flex: 1;\r\n`;\r\n\r\nconst MessageTime = styled.span`\r\n  font-size: 12px;\r\n  color: ${props => props.darkMode ? '#8696a0' : '#667781'};\r\n  margin-left: 8px;\r\n  flex-shrink: 0;\r\n`;\r\n\r\nconst LastMessageContainer = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  gap: 8px;\r\n`;\r\n\r\nconst LastMessage = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 4px;\r\n  flex: 1;\r\n  min-width: 0;\r\n`;\r\n\r\nconst StatusWrapper = styled.span`\r\n  display: inline-flex;\r\n  align-items: center;\r\n  flex-shrink: 0;\r\n`;\r\n\r\nconst MessageText = styled.span`\r\n  font-size: 14px;\r\n  color: ${props => {\r\n    if (props.hasUnread) {\r\n      return props.darkMode ? '#e0e0e0' : '#000';\r\n    }\r\n    return props.darkMode ? '#8696a0' : '#667781';\r\n  }};\r\n  font-weight: ${props => props.hasUnread ? '600' : '400'};\r\n  white-space: nowrap;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  flex: 1;\r\n`;\r\n\r\nconst UnreadBadge = styled.div`\r\n  background-color: ${props => props.darkMode ? '#00a884' : '#25d366'};\r\n  color: white;\r\n  border-radius: 50%;\r\n  min-width: 20px;\r\n  height: 20px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  font-size: 12px;\r\n  font-weight: 600;\r\n  padding: 0 6px;\r\n  flex-shrink: 0;\r\n`;"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 609, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/waels/OneDrive/Desktop/Expo%20projects/P3/components/Sidebar.js"],"sourcesContent":["// components/Sidebar.jsx\r\nimport React, { useState, useContext, useEffect, useMemo, useCallback } from \"react\";\r\nimport { useAuthState } from \"react-firebase-hooks/auth\";\r\nimport { auth, db } from \"../firebase\";\r\nimport styled from \"styled-components\";\r\nimport Avatar from \"@mui/material/Avatar\";\r\nimport Button from \"@mui/material/Button\";\r\nimport IconButton from \"@mui/material/IconButton\";\r\nimport ChatIcon from \"@mui/icons-material/Chat\";\r\nimport MoreVertIcon from \"@mui/icons-material/MoreVert\";\r\nimport SearchIcon from \"@mui/icons-material/Search\";\r\nimport CloseIcon from \"@mui/icons-material/Close\";\r\nimport ArchiveIcon from \"@mui/icons-material/Archive\";\r\nimport UnarchiveIcon from \"@mui/icons-material/Unarchive\";\r\nimport DeleteIcon from \"@mui/icons-material/Delete\";\r\nimport BlockIcon from \"@mui/icons-material/Block\";\r\nimport PersonOffIcon from \"@mui/icons-material/PersonOff\";\r\nimport SettingsIcon from \"@mui/icons-material/Settings\";\r\nimport InfoIcon from \"@mui/icons-material/Info\";\r\nimport Chat from \"./Chat\";\r\nimport { useCollection } from \"react-firebase-hooks/firestore\";\r\nimport * as EmailValidator from \"email-validator\";\r\nimport { \r\n  collection, \r\n  query, \r\n  where, \r\n  addDoc, \r\n  doc, \r\n  updateDoc,\r\n  arrayUnion,\r\n  arrayRemove,\r\n  setDoc,\r\n  orderBy,\r\n  limit,\r\n  getDocs,\r\n  getDoc,\r\n} from \"firebase/firestore\";\r\nimport Menu from \"@mui/material/Menu\";\r\nimport MenuItem from \"@mui/material/MenuItem\";\r\nimport Dialog from \"@mui/material/Dialog\";\r\nimport DialogTitle from \"@mui/material/DialogTitle\";\r\nimport DialogContent from \"@mui/material/DialogContent\";\r\nimport DialogActions from \"@mui/material/DialogActions\";\r\nimport FormControlLabel from \"@mui/material/FormControlLabel\";\r\nimport Switch from \"@mui/material/Switch\";\r\nimport Typography from \"@mui/material/Typography\";\r\nimport List from \"@mui/material/List\";\r\nimport ListItem from \"@mui/material/ListItem\";\r\nimport ListItemText from \"@mui/material/ListItemText\";\r\nimport ListItemSecondaryAction from \"@mui/material/ListItemSecondaryAction\";\r\nimport { DarkModeContext } from \"./DarkModeProvider\";\r\n\r\nconst Sidebar = React.memo(({ isMobile, sidebarOpen, setSidebarOpen }) => {\r\n  const [user] = useAuthState(auth);\r\n  const [anchorEl, setAnchorEl] = useState(null);\r\n  const [headerAnchorEl, setHeaderAnchorEl] = useState(null);\r\n  const [selectedChatId, setSelectedChatId] = useState(null);\r\n  const [selectedChatUsers, setSelectedChatUsers] = useState(null);\r\n  const [searchTerm, setSearchTerm] = useState(\"\");\r\n  const [settingsOpen, setSettingsOpen] = useState(false);\r\n  const [aboutOpen, setAboutOpen] = useState(false);\r\n  const [blockedUsersOpen, setBlockedUsersOpen] = useState(false);\r\n  const [chatsList, setChatsList] = useState([]);\r\n  const [displayNames, setDisplayNames] = useState({});\r\n  const [showArchived, setShowArchived] = useState(false);\r\n  \r\n  // Get dark mode context\r\n  const darkModeContext = useContext(DarkModeContext);\r\n  const { darkMode, toggleDarkMode } = darkModeContext || { darkMode: false, toggleDarkMode: () => {} };\r\n\r\n  const userChatsRef = user\r\n    ? query(\r\n        collection(db, \"chats\"),\r\n        where(\"users\", \"array-contains\", user.email)\r\n      )\r\n    : null;\r\n\r\n  const [chatsSnapshot, loading, error] = useCollection(userChatsRef);\r\n\r\n  // Get current user document to check blocked users\r\n  const userDocRef = user ? doc(db, \"users\", user.uid) : null;\r\n  const [userDocSnapshot] = useCollection(userDocRef ? query(collection(db, \"users\"), where(\"__name__\", \"==\", user.uid)) : null);\r\n  const currentUserData = userDocSnapshot?.docs?.[0]?.data();\r\n  const blockedUsers = currentUserData?.blockedUsers || [];\r\n\r\n  // âœ… Fetch display names for all contacts\r\n  useEffect(() => {\r\n    if (!user || !chatsSnapshot) return;\r\n\r\n    const fetchDisplayNames = async () => {\r\n      const names = {};\r\n      \r\n      // Get all unique recipient emails\r\n      const recipientEmails = new Set();\r\n      chatsSnapshot.docs.forEach((chat) => {\r\n        const chatUsers = chat.data().users || [];\r\n        chatUsers.forEach((email) => {\r\n          if (email !== user.email) {\r\n            recipientEmails.add(email);\r\n          }\r\n        });\r\n      });\r\n\r\n      // Fetch display names for each recipient\r\n      await Promise.all(\r\n        Array.from(recipientEmails).map(async (recipientEmail) => {\r\n          try {\r\n            const contactRef = doc(db, \"users\", user.uid, \"contacts\", recipientEmail);\r\n            const contactSnap = await getDoc(contactRef);\r\n            \r\n            if (contactSnap.exists()) {\r\n              names[recipientEmail] = contactSnap.data().displayName;\r\n            }\r\n          } catch (error) {\r\n            console.error(`Error fetching display name for ${recipientEmail}:`, error);\r\n          }\r\n        })\r\n      );\r\n\r\n      setDisplayNames(names);\r\n    };\r\n\r\n    fetchDisplayNames();\r\n  }, [user, chatsSnapshot]);\r\n\r\n  // âœ… OPTIMIZED: Load and sort chats with cleaned users array\r\n  useEffect(() => {\r\n    if (!chatsSnapshot || !user) {\r\n      setChatsList([]);\r\n      return;\r\n    }\r\n\r\n    const loadChatsWithLatestMessage = async () => {\r\n      const chatsWithMessages = await Promise.all(\r\n        chatsSnapshot.docs\r\n          .filter((chat) => {\r\n            const deletedBy = chat.data().deletedBy || [];\r\n            const archivedBy = chat.data().archivedBy || [];\r\n            \r\n            // Don't show deleted chats\r\n            if (deletedBy.includes(user.email)) {\r\n              return false;\r\n            }\r\n            \r\n            // Filter based on archive view\r\n            const isArchived = archivedBy.includes(user.email);\r\n            return showArchived ? isArchived : !isArchived;\r\n          })\r\n          .map(async (chat) => {\r\n            try {\r\n              const chatData = chat.data();\r\n              \r\n              // âœ… FIXED: Validate and clean users array\r\n              if (!chatData.users || !Array.isArray(chatData.users)) {\r\n                console.error(`âŒ Invalid users array for chat ${chat.id}:`, chatData.users);\r\n                return null;\r\n              }\r\n              \r\n              // âœ… FIXED: Remove duplicates for display (but keep original for self-chat detection)\r\n              const cleanUsers = chatData.users.filter(email => email && typeof email === 'string');\r\n              \r\n              const messagesRef = collection(db, \"chats\", chat.id, \"messages\");\r\n              const q = query(messagesRef, orderBy(\"timestamp\", \"desc\"), limit(1));\r\n              const snapshot = await getDocs(q);\r\n              \r\n              const latestMessage = snapshot.empty \r\n                ? null \r\n                : {\r\n                    ...snapshot.docs[0].data(),\r\n                    timestamp: snapshot.docs[0].data().timestamp?.toMillis() || 0\r\n                  };\r\n\r\n              return {\r\n                id: chat.id,\r\n                data: {\r\n                  ...chatData,\r\n                  users: cleanUsers, // âœ… Clean users array\r\n                },\r\n                latestMessage,\r\n                latestTimestamp: latestMessage?.timestamp || 0,\r\n              };\r\n            } catch (error) {\r\n              console.error(\"Error loading message for chat:\", chat.id, error);\r\n              return {\r\n                id: chat.id,\r\n                data: chat.data(),\r\n                latestMessage: null,\r\n                latestTimestamp: 0,\r\n              };\r\n            }\r\n          })\r\n      );\r\n\r\n      // âœ… Filter out any null entries\r\n      const validChats = chatsWithMessages.filter(Boolean);\r\n\r\n      // Sort by latest message timestamp (newest first)\r\n      const sortedChats = validChats.sort((a, b) => {\r\n        return b.latestTimestamp - a.latestTimestamp;\r\n      });\r\n\r\n      setChatsList(sortedChats);\r\n    };\r\n\r\n    loadChatsWithLatestMessage();\r\n  }, [chatsSnapshot, user, showArchived]);\r\n\r\n  // âœ… Toggle archive view\r\n  const toggleArchiveView = useCallback(() => {\r\n    setShowArchived(prev => !prev);\r\n  }, []);\r\n\r\n  // âœ… MEMOIZED: Check if chat already exists\r\n  const chatAlreadyExist = useCallback((recipientEmail) => {\r\n    if (!chatsSnapshot) return false;\r\n    \r\n    if (recipientEmail === user.email) {\r\n      return !!chatsSnapshot.docs.find((chat) => {\r\n        const users = chat.data().users;\r\n        return users.length === 2 && users[0] === user.email && users[1] === user.email;\r\n      });\r\n    }\r\n    \r\n    return !!chatsSnapshot.docs.find((chat) => {\r\n      const users = chat.data().users;\r\n      return users.includes(recipientEmail) && users.includes(user.email);\r\n    });\r\n  }, [chatsSnapshot, user]);\r\n\r\n  // âœ… MEMOIZED: Create chat function\r\n  const createChat = useCallback(async () => {\r\n    if (!user) {\r\n      console.error(\"No user logged in\");\r\n      return;\r\n    }\r\n\r\n    const input = prompt(\r\n      \"Please enter an email address for the user you wish to chat with\"\r\n    );\r\n    \r\n    if (!input) {\r\n      return;\r\n    }\r\n\r\n    if (!EmailValidator.validate(input)) {\r\n      alert(\"Please enter a valid email address\");\r\n      return;\r\n    }\r\n\r\n    if (chatAlreadyExist(input)) {\r\n      alert(\"Chat already exists with this user\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      await addDoc(collection(db, \"chats\"), {\r\n        users: [user.email, input],\r\n        deletedBy: [],\r\n        archivedBy: [],\r\n        createdAt: new Date(),\r\n      });\r\n    } catch (error) {\r\n      console.error(\"Error creating chat:\", error);\r\n      alert(`Failed to create chat: ${error.message}`);\r\n    }\r\n  }, [user, chatAlreadyExist]);\r\n\r\n  // âœ… MEMOIZED: Menu handlers\r\n  const handleMenuOpen = useCallback((event, chatId, chatUsers) => {\r\n    setAnchorEl(event.currentTarget);\r\n    setSelectedChatId(chatId);\r\n    setSelectedChatUsers(chatUsers);\r\n  }, []);\r\n\r\n  const handleMenuClose = useCallback(() => {\r\n    setAnchorEl(null);\r\n    setSelectedChatId(null);\r\n    setSelectedChatUsers(null);\r\n  }, []);\r\n\r\n  const handleHeaderMenuOpen = useCallback((event) => {\r\n    setHeaderAnchorEl(event.currentTarget);\r\n  }, []);\r\n\r\n  const handleHeaderMenuClose = useCallback(() => {\r\n    setHeaderAnchorEl(null);\r\n  }, []);\r\n\r\n  const handleSettingsOpen = useCallback(() => {\r\n    setSettingsOpen(true);\r\n    handleHeaderMenuClose();\r\n  }, [handleHeaderMenuClose]);\r\n\r\n  const handleSettingsClose = useCallback(() => {\r\n    setSettingsOpen(false);\r\n  }, []);\r\n\r\n  const handleAboutOpen = useCallback(() => {\r\n    setAboutOpen(true);\r\n    handleHeaderMenuClose();\r\n  }, [handleHeaderMenuClose]);\r\n\r\n  const handleAboutClose = useCallback(() => {\r\n    setAboutOpen(false);\r\n  }, []);\r\n\r\n  const handleBlockedUsersOpen = useCallback(() => {\r\n    setBlockedUsersOpen(true);\r\n    handleHeaderMenuClose();\r\n  }, [handleHeaderMenuClose]);\r\n\r\n  const handleBlockedUsersClose = useCallback(() => {\r\n    setBlockedUsersOpen(false);\r\n  }, []);\r\n\r\n  // âœ… MEMOIZED: Archive chat\r\n  const archiveChat = useCallback(async () => {\r\n    if (!selectedChatId || !user) return;\r\n    try {\r\n      const chatRef = doc(db, \"chats\", selectedChatId);\r\n      const chatDoc = await getDoc(chatRef);\r\n      const archivedBy = chatDoc.data()?.archivedBy || [];\r\n      const isArchived = archivedBy.includes(user.email);\r\n\r\n      if (isArchived) {\r\n        // Unarchive\r\n        await updateDoc(chatRef, {\r\n          archivedBy: arrayRemove(user.email),\r\n        });\r\n        alert(\"Chat unarchived\");\r\n      } else {\r\n        // Archive\r\n        await updateDoc(chatRef, {\r\n          archivedBy: arrayUnion(user.email),\r\n        });\r\n        alert(\"Chat archived\");\r\n      }\r\n      \r\n      handleMenuClose();\r\n    } catch (error) {\r\n      console.error(\"Error archiving/unarchiving chat:\", error);\r\n      alert(\"Failed to archive/unarchive chat\");\r\n    }\r\n  }, [selectedChatId, user, handleMenuClose]);\r\n\r\n  // âœ… MEMOIZED: Delete chat\r\n  const deleteChat = useCallback(async () => {\r\n    if (!selectedChatId || !user) return;\r\n    try {\r\n      const chatRef = doc(db, \"chats\", selectedChatId);\r\n      await updateDoc(chatRef, {\r\n        deletedBy: arrayUnion(user.email),\r\n      });\r\n      handleMenuClose();\r\n      alert(\"Chat deleted\");\r\n    } catch (error) {\r\n      console.error(\"Error deleting chat:\", error);\r\n      alert(\"Failed to delete chat\");\r\n    }\r\n  }, [selectedChatId, user, handleMenuClose]);\r\n\r\n  // âœ… MEMOIZED: Block user\r\n  const blockUser = useCallback(async () => {\r\n    if (!selectedChatUsers || !user) return;\r\n    \r\n    const recipientEmail = selectedChatUsers.find((email) => email !== user.email);\r\n    \r\n    if (!recipientEmail || recipientEmail === user.email) {\r\n      alert(\"You cannot block yourself\");\r\n      return;\r\n    }\r\n    \r\n    try {\r\n      const userDocRef = doc(db, \"users\", user.uid);\r\n      \r\n      await setDoc(userDocRef, {\r\n        email: user.email,\r\n        blockedUsers: arrayUnion(recipientEmail),\r\n      }, { merge: true });\r\n      \r\n      handleMenuClose();\r\n      alert(`${recipientEmail} has been blocked. They can no longer send you messages.`);\r\n    } catch (error) {\r\n      console.error(\"Error blocking user:\", error);\r\n      alert(\"Failed to block user\");\r\n    }\r\n  }, [selectedChatUsers, user, handleMenuClose]);\r\n\r\n  // âœ… MEMOIZED: Unblock user\r\n  const unblockUser = useCallback(async (emailToUnblock) => {\r\n    if (!user) return;\r\n    \r\n    try {\r\n      const userDocRef = doc(db, \"users\", user.uid);\r\n      \r\n      await updateDoc(userDocRef, {\r\n        blockedUsers: arrayRemove(emailToUnblock),\r\n      });\r\n      \r\n      alert(`${emailToUnblock} has been unblocked`);\r\n    } catch (error) {\r\n      console.error(\"Error unblocking user:\", error);\r\n      alert(\"Failed to unblock user\");\r\n    }\r\n  }, [user]);\r\n\r\n  // âœ… MEMOIZED: Check if user is blocked\r\n  const isUserBlocked = useCallback(() => {\r\n    if (!selectedChatUsers || !user) return false;\r\n    const recipientEmail = selectedChatUsers.find((email) => email !== user.email);\r\n    if (!recipientEmail) return false;\r\n    return blockedUsers.includes(recipientEmail);\r\n  }, [selectedChatUsers, user, blockedUsers]);\r\n\r\n  // âœ… Check if selected chat is archived\r\n  const isSelectedChatArchived = useCallback(() => {\r\n    if (!selectedChatId || !chatsSnapshot) return false;\r\n    const chat = chatsSnapshot.docs.find(doc => doc.id === selectedChatId);\r\n    if (!chat) return false;\r\n    const archivedBy = chat.data()?.archivedBy || [];\r\n    return archivedBy.includes(user.email);\r\n  }, [selectedChatId, chatsSnapshot, user]);\r\n\r\n  // âœ… Get display name for a recipient\r\n  const getDisplayName = useCallback((recipientEmail) => {\r\n    return displayNames[recipientEmail] || null;\r\n  }, [displayNames]);\r\n\r\n  // âœ… MEMOIZED: Filter chats by search term\r\n  const filteredChats = useMemo(() => {\r\n    if (!searchTerm.trim()) return chatsList;\r\n    \r\n    const searchLower = searchTerm.toLowerCase();\r\n    return chatsList.filter((chat) => {\r\n      const chatUsers = chat.data.users || [];\r\n      const otherUser = chatUsers.find((email) => email !== user.email);\r\n      \r\n      if (!otherUser) {\r\n        return user.email?.toLowerCase().includes(searchLower);\r\n      }\r\n      \r\n      // Search by both email and display name\r\n      const displayName = getDisplayName(otherUser);\r\n      return otherUser?.toLowerCase().includes(searchLower) ||\r\n             displayName?.toLowerCase().includes(searchLower);\r\n    });\r\n  }, [chatsList, searchTerm, user, getDisplayName]);\r\n\r\n  // âœ… Count archived chats\r\n  const archivedCount = useMemo(() => {\r\n    if (!chatsSnapshot || !user) return 0;\r\n    return chatsSnapshot.docs.filter(chat => {\r\n      const archivedBy = chat.data()?.archivedBy || [];\r\n      const deletedBy = chat.data()?.deletedBy || [];\r\n      return archivedBy.includes(user.email) && !deletedBy.includes(user.email);\r\n    }).length;\r\n  }, [chatsSnapshot, user]);\r\n\r\n  if (!user) return <Container darkMode={darkMode}>Loading...</Container>;\r\n\r\n  return (\r\n    <>\r\n      {/* Overlay for mobile */}\r\n      {isMobile && sidebarOpen && (\r\n        <Overlay onClick={() => setSidebarOpen(false)} />\r\n      )}\r\n\r\n      <Container \r\n        darkMode={darkMode} \r\n        isMobile={isMobile}\r\n        sidebarOpen={sidebarOpen}\r\n      >\r\n        <Header darkMode={darkMode}>\r\n          <UserAvatar onClick={() => auth.signOut()} src={user.photoURL} />\r\n          <IconsContainer>\r\n            <IconButton onClick={toggleArchiveView} title={showArchived ? \"Show active chats\" : \"Show archived chats\"}>\r\n              {showArchived ? (\r\n                <UnarchiveIcon style={{ color: darkMode ? '#25D366' : '#128C7E' }}/>\r\n              ) : (\r\n                <ChatIcon style={{ color: darkMode ? 'gray' : 'inherit' }}/>\r\n              )}\r\n            </IconButton>\r\n            {!showArchived && archivedCount > 0 && (\r\n              <ArchiveBadge darkMode={darkMode}>{archivedCount}</ArchiveBadge>\r\n            )}\r\n            <IconButton onClick={handleHeaderMenuOpen}>\r\n              <MoreVertIcon style={{ color: darkMode ? 'gray' : 'inherit' }}/>\r\n            </IconButton>\r\n            {isMobile && (\r\n              <IconButton onClick={() => setSidebarOpen(false)}>\r\n                <CloseIcon style={{ color: darkMode ? 'gray' : 'inherit' }}/>\r\n              </IconButton>\r\n            )}\r\n          </IconsContainer>\r\n        </Header>\r\n\r\n        {showArchived && (\r\n          <ArchiveHeader darkMode={darkMode}>\r\n            <ArchiveIcon style={{ fontSize: 20, marginRight: 8 }} />\r\n            <span>Archived Chats ({archivedCount})</span>\r\n          </ArchiveHeader>\r\n        )}\r\n\r\n        <Search darkMode={darkMode}>\r\n          <SearchIcon />\r\n          <SearchInput \r\n            darkMode={darkMode}\r\n            placeholder={showArchived ? \"Search archived chats\" : \"Search in chats\"}\r\n            type=\"text\"\r\n            value={searchTerm}\r\n            onChange={(e) => setSearchTerm(e.target.value)}\r\n          />\r\n        </Search>\r\n\r\n        {!showArchived && (\r\n          <SidebarButton onClick={createChat} disabled={loading}>\r\n            Start a new chat\r\n          </SidebarButton>\r\n        )}\r\n\r\n        {loading ? (\r\n          <LoadingContainer darkMode={darkMode}>\r\n            <Typography>Loading chats...</Typography>\r\n          </LoadingContainer>\r\n        ) : filteredChats.length === 0 ? (\r\n          <EmptyState darkMode={darkMode}>\r\n            <Typography variant=\"body2\">\r\n              {showArchived ? \"No archived chats\" : \"No chats yet\"}\r\n            </Typography>\r\n          </EmptyState>\r\n        ) : (\r\n          filteredChats.map((chat) => {\r\n            const chatUsers = chat.data.users || [];\r\n            const otherUser = chatUsers.find((email) => email !== user.email);\r\n            const customDisplayName = otherUser ? getDisplayName(otherUser) : null;\r\n            \r\n            return (\r\n              <ChatWrapper key={chat.id} darkMode={darkMode}>\r\n                <Chat \r\n                  id={chat.id} \r\n                  users={chat.data.users} \r\n                  latestMessage={chat.latestMessage}\r\n                  customDisplayName={customDisplayName}\r\n                />\r\n                <OptionsButton\r\n                  onClick={(e) => handleMenuOpen(e, chat.id, chat.data.users)}\r\n                >\r\n                  <MoreVertIcon fontSize=\"small\" />\r\n                </OptionsButton>\r\n              </ChatWrapper>\r\n            );\r\n          })\r\n        )}\r\n\r\n        {/* Header Menu */}\r\n        <Menu\r\n          anchorEl={headerAnchorEl}\r\n          open={Boolean(headerAnchorEl)}\r\n          onClose={handleHeaderMenuClose}\r\n          PaperProps={{\r\n            style: {\r\n              backgroundColor: darkMode ? '#2a2a2a' : 'white',\r\n              color: darkMode ? '#e0e0e0' : 'black',\r\n            },\r\n          }}\r\n        >\r\n          <MenuItem onClick={handleSettingsOpen}>\r\n            <SettingsIcon fontSize=\"small\" style={{ marginRight: 8, color: darkMode ? '#64b5f6' : '#1976d2' }} />\r\n            Settings\r\n          </MenuItem>\r\n          <MenuItem onClick={handleBlockedUsersOpen}>\r\n            <PersonOffIcon fontSize=\"small\" style={{ marginRight: 8, color: darkMode ? '#ff9800' : '#f57c00' }} />\r\n            Blocked Users\r\n          </MenuItem>\r\n          <MenuItem onClick={handleAboutOpen}>\r\n            <InfoIcon fontSize=\"small\" style={{ marginRight: 8, color: darkMode ? '#4caf50' : '#2e7d32' }} />\r\n            About\r\n          </MenuItem>\r\n        </Menu>\r\n\r\n        {/* Chat Context Menu */}\r\n        <Menu\r\n          anchorEl={anchorEl}\r\n          open={Boolean(anchorEl)}\r\n          onClose={handleMenuClose}\r\n          PaperProps={{\r\n            style: {\r\n              backgroundColor: darkMode ? '#2a2a2a' : 'white',\r\n              color: darkMode ? '#e0e0e0' : 'black',\r\n            },\r\n          }}\r\n        >\r\n          <MenuItem onClick={archiveChat}>\r\n            {isSelectedChatArchived() ? (\r\n              <>\r\n                <UnarchiveIcon fontSize=\"small\" style={{ marginRight: 8, color: darkMode ? '#64b5f6' : '#1976d2' }} />\r\n                Unarchive Chat\r\n              </>\r\n            ) : (\r\n              <>\r\n                <ArchiveIcon fontSize=\"small\" style={{ marginRight: 8, color: darkMode ? '#64b5f6' : '#1976d2' }} />\r\n                Archive Chat\r\n              </>\r\n            )}\r\n          </MenuItem>\r\n          \r\n          {selectedChatUsers && selectedChatUsers.find((email) => email !== user.email) && (\r\n            <>\r\n              {isUserBlocked() ? (\r\n                <MenuItem onClick={() => {\r\n                  const recipientEmail = selectedChatUsers.find((email) => email !== user.email);\r\n                  unblockUser(recipientEmail);\r\n                  handleMenuClose();\r\n                }}>\r\n                  <PersonOffIcon fontSize=\"small\" style={{ marginRight: 8, color: darkMode ? '#4caf50' : '#2e7d32' }} />\r\n                  Unblock User\r\n                </MenuItem>\r\n              ) : (\r\n                <MenuItem onClick={blockUser}>\r\n                  <BlockIcon fontSize=\"small\" style={{ marginRight: 8, color: darkMode ? '#ff9800' : '#f57c00' }} />\r\n                  Block User\r\n                </MenuItem>\r\n              )}\r\n            </>\r\n          )}\r\n          \r\n          <MenuItem onClick={deleteChat}>\r\n            <DeleteIcon fontSize=\"small\" style={{ marginRight: 8, color: '#f44336' }} />\r\n            Delete Chat\r\n          </MenuItem>\r\n        </Menu>\r\n\r\n        <Dialog \r\n          open={settingsOpen} \r\n          onClose={handleSettingsClose} \r\n          maxWidth=\"sm\" \r\n          fullWidth\r\n          PaperProps={{\r\n            style: {\r\n              backgroundColor: darkMode ? '#1e1e1e' : 'white',\r\n              color: darkMode ? '#e0e0e0' : 'black',\r\n            },\r\n          }}\r\n        >\r\n          <DialogTitle>\r\n            <DialogTitleContainer>\r\n              <SettingsIcon style={{ marginRight: 8, color: darkMode ? '#64b5f6' : '#1976d2' }} />\r\n              Settings\r\n            </DialogTitleContainer>\r\n          </DialogTitle>\r\n          <DialogContent>\r\n            <FormControlLabel\r\n              control={\r\n                <Switch\r\n                  checked={darkMode}\r\n                  onChange={toggleDarkMode}\r\n                  color=\"primary\"\r\n                />\r\n              }\r\n              label=\"Dark Mode\"\r\n            />\r\n          </DialogContent>\r\n          <DialogActions>\r\n            <Button onClick={handleSettingsClose}>Close</Button>\r\n          </DialogActions>\r\n        </Dialog>\r\n\r\n        <Dialog \r\n          open={blockedUsersOpen} \r\n          onClose={handleBlockedUsersClose} \r\n          maxWidth=\"sm\" \r\n          fullWidth\r\n          PaperProps={{\r\n            style: {\r\n              backgroundColor: darkMode ? '#1e1e1e' : 'white',\r\n              color: darkMode ? '#e0e0e0' : 'black',\r\n            },\r\n          }}\r\n        >\r\n          <DialogTitle>\r\n            <DialogTitleContainer>\r\n              <PersonOffIcon style={{ marginRight: 8, color: darkMode ? '#ff9800' : '#f57c00' }} />\r\n              Blocked Users\r\n            </DialogTitleContainer>\r\n          </DialogTitle>\r\n          <DialogContent>\r\n            {blockedUsers.length === 0 ? (\r\n              <Typography variant=\"body2\" color=\"textSecondary\">\r\n                No blocked users\r\n              </Typography>\r\n            ) : (\r\n              <List>\r\n                {blockedUsers.map((blockedEmail) => (\r\n                  <ListItem key={blockedEmail}>\r\n                    <ListItemText \r\n                      primary={getDisplayName(blockedEmail) || blockedEmail}\r\n                      secondary={getDisplayName(blockedEmail) ? blockedEmail : null}\r\n                      primaryTypographyProps={{\r\n                        style: { color: darkMode ? '#e0e0e0' : 'black' }\r\n                      }}\r\n                      secondaryTypographyProps={{\r\n                        style: { color: darkMode ? '#888' : '#666' }\r\n                      }}\r\n                    />\r\n                    <ListItemSecondaryAction>\r\n                      <Button \r\n                        variant=\"outlined\" \r\n                        size=\"small\"\r\n                        onClick={() => unblockUser(blockedEmail)}\r\n                      >\r\n                        Unblock\r\n                      </Button>\r\n                    </ListItemSecondaryAction>\r\n                  </ListItem>\r\n                ))}\r\n              </List>\r\n            )}\r\n          </DialogContent>\r\n          <DialogActions>\r\n            <Button onClick={handleBlockedUsersClose}>Close</Button>\r\n          </DialogActions>\r\n        </Dialog>\r\n\r\n        <Dialog \r\n          open={aboutOpen} \r\n          onClose={handleAboutClose} \r\n          maxWidth=\"sm\" \r\n          fullWidth\r\n          PaperProps={{\r\n            style: {\r\n              backgroundColor: darkMode ? '#1e1e1e' : 'white',\r\n              color: darkMode ? '#e0e0e0' : 'black',\r\n            },\r\n          }}\r\n        >\r\n          <DialogTitle>\r\n            <DialogTitleContainer>\r\n              <InfoIcon style={{ marginRight: 8, color: darkMode ? '#4caf50' : '#2e7d32' }} />\r\n              About\r\n            </DialogTitleContainer>\r\n          </DialogTitle>\r\n          <DialogContent>\r\n            <Typography variant=\"h6\" gutterBottom>\r\n              Chat Application\r\n            </Typography>\r\n            <Typography variant=\"body1\" paragraph>\r\n              Version: 1.0.0\r\n            </Typography>\r\n            <Typography variant=\"body2\" paragraph>\r\n              A real-time messaging application built with React and Firebase.\r\n              Connect with friends and family through instant messaging.\r\n            </Typography>\r\n            <Typography variant=\"body2\" paragraph>\r\n              <strong>Features:</strong>\r\n            </Typography>\r\n            <Typography variant=\"body2\" component=\"div\">\r\n              <ul>\r\n                <li>Real-time messaging</li>\r\n                <li>User authentication</li>\r\n                <li>Search chats</li>\r\n                <li>Block/Unblock users</li>\r\n                <li>Archive/Unarchive chats</li>\r\n                <li>Delete conversations</li>\r\n                <li>Dark mode support</li>\r\n                <li>Chat with yourself (like WhatsApp)</li>\r\n                <li>Sorted by latest message</li>\r\n                <li>File sharing support</li>\r\n                <li>Voice messages</li>\r\n                <li>Custom display names</li>\r\n                <li>Location sharing</li>\r\n                <li>Camera photo capture</li>\r\n                <li>Message status indicators</li>\r\n                <li>Reply to messages</li>\r\n              </ul>\r\n            </Typography>\r\n            <Typography variant=\"body2\" color=\"textSecondary\" style={{ marginTop: 20 }}>\r\n              Â© 2024 Chat App. All rights reserved.\r\n            </Typography>\r\n          </DialogContent>\r\n          <DialogActions>\r\n            <Button onClick={handleAboutClose}>Close</Button>\r\n          </DialogActions>\r\n        </Dialog>\r\n      </Container>\r\n    </>\r\n  );\r\n});\r\n\r\nSidebar.displayName = 'Sidebar';\r\n\r\nexport default Sidebar;\r\n\r\n// Styled Components\r\nconst Overlay = styled.div`\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background-color: rgba(0, 0, 0, 0.5);\r\n  z-index: 998;\r\n  \r\n  @media (min-width: 1025px) {\r\n    display: none;\r\n  }\r\n`;\r\n\r\nconst Container = styled.div`\r\n  flex: 0.45;\r\n  border-right: 1px solid ${props => props.darkMode ? '#333' : 'whitesmoke'};\r\n  height: 100vh;\r\n  min-width: 300px;\r\n  max-width: 350px;\r\n  overflow-y: scroll;\r\n  display: flex;\r\n  flex-direction: column;\r\n  background-color: ${props => props.darkMode ? '#1e1e1e' : 'white'};\r\n  color: ${props => props.darkMode ? '#e0e0e0' : 'black'};\r\n\r\n  ::-webkit-scrollbar {\r\n    display: none;\r\n  }\r\n\r\n  -ms-overflow-style: none;\r\n  scrollbar-width: none;\r\n\r\n  @media (max-width: 1024px) {\r\n    ${props => props.sidebarOpen ? `\r\n      position: fixed;\r\n      left: 0;\r\n      top: 0;\r\n      bottom: 0;\r\n      right: 0;\r\n      z-index: 999;\r\n      max-width: 100%;\r\n      width: 100%;\r\n      transform: translateX(0);\r\n    ` : `\r\n      position: fixed;\r\n      left: 0;\r\n      top: 0;\r\n      bottom: 0;\r\n      z-index: 999;\r\n      max-width: 85%;\r\n      width: 85%;\r\n      transform: translateX(-100%);\r\n    `}\r\n    transition: transform 0.3s ease-in-out;\r\n    box-shadow: ${props => props.sidebarOpen ? '2px 0 10px rgba(0,0,0,0.3)' : 'none'};\r\n  }\r\n`;\r\n\r\nconst UserAvatar = styled(Avatar)`\r\n  cursor: pointer;\r\n\r\n  :hover {\r\n    opacity: 0.8;\r\n  }\r\n`;\r\n\r\nconst SidebarButton = styled(Button)`\r\n  width: 100%;\r\n  &&& {\r\n    border-top: 1px solid whitesmoke;\r\n    border-bottom: 1px solid whitesmoke;\r\n  }\r\n`;\r\n\r\nconst Search = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  padding: 5px;\r\n  border-radius: 2px;\r\n  padding: 20px;\r\n  background-color: ${props => props.darkMode ? '#2a2a2a' : 'white'};\r\n`;\r\n\r\nconst SearchInput = styled.input`\r\n  outline-width: 0;\r\n  border: none;\r\n  flex: 1;\r\n  background-color: ${props => props.darkMode ? '#2a2a2a' : 'white'};\r\n  color: ${props => props.darkMode ? '#e0e0e0' : 'black'};\r\n  \r\n  ::placeholder {\r\n    color: ${props => props.darkMode ? '#888' : '#999'};\r\n  }\r\n`;\r\n\r\nconst Header = styled.div`\r\n  display: flex;\r\n  position: sticky;\r\n  top: 0;\r\n  background-color: ${props => props.darkMode ? '#1e1e1e' : 'white'};\r\n  z-index: 1;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  padding: 15px;\r\n  height: 80px;\r\n  border-bottom: 1px solid ${props => props.darkMode ? '#333' : 'whitesmoke'};\r\n`;\r\n\r\nconst IconsContainer = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  position: relative;\r\n`;\r\n\r\nconst ArchiveBadge = styled.div`\r\n  position: absolute;\r\n  top: 8px;\r\n  left: 28px;\r\n  background-color: ${props => props.darkMode ? '#00a884' : '#25d366'};\r\n  color: white;\r\n  border-radius: 50%;\r\n  min-width: 18px;\r\n  height: 18px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  font-size: 10px;\r\n  font-weight: 600;\r\n  padding: 0 4px;\r\n`;\r\n\r\nconst ArchiveHeader = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  padding: 12px 20px;\r\n  background-color: ${props => props.darkMode ? '#2a2a2a' : '#f0f0f0'};\r\n  color: ${props => props.darkMode ? '#25D366' : '#128C7E'};\r\n  font-weight: 500;\r\n  font-size: 14px;\r\n  border-bottom: 1px solid ${props => props.darkMode ? '#333' : '#e0e0e0'};\r\n`;\r\n\r\nconst ChatWrapper = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  padding: 0 10px;\r\n  \r\n  &:hover {\r\n    background-color: ${props => props.darkMode ? '#2a2a2a' : '#f5f5f5'};\r\n  }\r\n`;\r\n\r\nconst OptionsButton = styled(IconButton)`\r\n  visibility: hidden;\r\n  \r\n  ${ChatWrapper}:hover & {\r\n    visibility: visible;\r\n  }\r\n`;\r\n\r\nconst LoadingContainer = styled.div`\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  padding: 20px;\r\n  color: ${props => props.darkMode ? '#888' : '#666'};\r\n`;\r\n\r\nconst EmptyState = styled.div`\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  padding: 40px 20px;\r\n  color: ${props => props.darkMode ? '#888' : '#666'};\r\n`;\r\n\r\nconst DialogTitleContainer = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n`;"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2150, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/waels/OneDrive/Desktop/Expo%20projects/P3/components/ChatScreen/hooks/useEmojiPicker.js"],"sourcesContent":["// components/ChatScreen/hooks/useEmojiPicker.js\r\nimport { useState, useEffect } from \"react\";\r\nimport { EMOJIS } from \"../constants\";\r\n\r\nexport const useEmojiPicker = () => {\r\n  const [emojiAnchorEl, setEmojiAnchorEl] = useState(null);\r\n  const [selectedEmojiCategory, setSelectedEmojiCategory] = useState(\"recent\");\r\n  const [recentEmojis, setRecentEmojis] = useState([]);\r\n  const [emojiSearchTerm, setEmojiSearchTerm] = useState(\"\");\r\n\r\n  // Load recent emojis from localStorage\r\n  useEffect(() => {\r\n    const stored = localStorage.getItem(\"recentEmojis\");\r\n    if (stored) {\r\n      setRecentEmojis(JSON.parse(stored));\r\n    }\r\n  }, []);\r\n\r\n  const saveRecentEmoji = (emoji) => {\r\n    const updated = [emoji, ...recentEmojis.filter((e) => e !== emoji)].slice(0, 30);\r\n    setRecentEmojis(updated);\r\n    localStorage.setItem(\"recentEmojis\", JSON.stringify(updated));\r\n  };\r\n\r\n  const handleEmojiPickerOpen = (event) => {\r\n    setEmojiAnchorEl(event.currentTarget);\r\n  };\r\n\r\n  const handleEmojiPickerClose = () => {\r\n    setEmojiAnchorEl(null);\r\n    setEmojiSearchTerm(\"\");\r\n  };\r\n\r\n  const getFilteredEmojis = () => {\r\n    if (selectedEmojiCategory === \"recent\") {\r\n      return recentEmojis;\r\n    }\r\n\r\n    const categoryEmojis = EMOJIS[selectedEmojiCategory] || [];\r\n    return categoryEmojis;\r\n  };\r\n\r\n  return {\r\n    emojiAnchorEl,\r\n    selectedEmojiCategory,\r\n    setSelectedEmojiCategory,\r\n    emojiSearchTerm,\r\n    setEmojiSearchTerm,\r\n    recentEmojis,\r\n    handleEmojiPickerOpen,\r\n    handleEmojiPickerClose,\r\n    saveRecentEmoji,\r\n    getFilteredEmojis,\r\n    openEmojiPicker: Boolean(emojiAnchorEl),\r\n  };\r\n};"],"names":[],"mappings":"AAAA,gDAAgD;;;;;AAChD;AACA;;;AAEO,MAAM,iBAAiB;IAC5B,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,+GAAQ,EAAC;IACnD,MAAM,CAAC,uBAAuB,yBAAyB,GAAG,IAAA,+GAAQ,EAAC;IACnE,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,+GAAQ,EAAC,EAAE;IACnD,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,+GAAQ,EAAC;IAEvD,uCAAuC;IACvC,IAAA,gHAAS,EAAC;QACR,MAAM,SAAS,aAAa,OAAO,CAAC;QACpC,IAAI,QAAQ;YACV,gBAAgB,KAAK,KAAK,CAAC;QAC7B;IACF,GAAG,EAAE;IAEL,MAAM,kBAAkB,CAAC;QACvB,MAAM,UAAU;YAAC;eAAU,aAAa,MAAM,CAAC,CAAC,IAAM,MAAM;SAAO,CAAC,KAAK,CAAC,GAAG;QAC7E,gBAAgB;QAChB,aAAa,OAAO,CAAC,gBAAgB,KAAK,SAAS,CAAC;IACtD;IAEA,MAAM,wBAAwB,CAAC;QAC7B,iBAAiB,MAAM,aAAa;IACtC;IAEA,MAAM,yBAAyB;QAC7B,iBAAiB;QACjB,mBAAmB;IACrB;IAEA,MAAM,oBAAoB;QACxB,IAAI,0BAA0B,UAAU;YACtC,OAAO;QACT;QAEA,MAAM,iBAAiB,wIAAM,CAAC,sBAAsB,IAAI,EAAE;QAC1D,OAAO;IACT;IAEA,OAAO;QACL;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,iBAAiB,QAAQ;IAC3B;AACF","debugId":null}},
    {"offset": {"line": 2211, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/waels/OneDrive/Desktop/Expo%20projects/P3/lib/cloudinary.js"],"sourcesContent":["// lib/cloudinary.js\r\n\r\nconst CLOUDINARY_CLOUD_NAME = process.env.NEXT_PUBLIC_CLOUDINARY_CLOUD_NAME;\r\nconst CLOUDINARY_UPLOAD_PRESET = process.env.NEXT_PUBLIC_CLOUDINARY_UPLOAD_PRESET;\r\n\r\n// Validate environment variables\r\nif (!CLOUDINARY_CLOUD_NAME) {\r\n  console.error('âŒ NEXT_PUBLIC_CLOUDINARY_CLOUD_NAME is not set in .env.local');\r\n}\r\n\r\nif (!CLOUDINARY_UPLOAD_PRESET) {\r\n  console.error('âŒ NEXT_PUBLIC_CLOUDINARY_UPLOAD_PRESET is not set in .env.local');\r\n}\r\n\r\nconst CLOUDINARY_URL = `https://api.cloudinary.com/v1_1/${CLOUDINARY_CLOUD_NAME}/auto/upload`;\r\n\r\n/**\r\n * Upload file to Cloudinary\r\n * @param {Blob|File} file - The file to upload\r\n * @param {Function} onProgress - Progress callback (0-100)\r\n * @returns {Promise<string>} - Download URL\r\n */\r\nexport const uploadToCloudinary = async (file, onProgress = null) => {\r\n  return new Promise((resolve, reject) => {\r\n    // Validation\r\n    if (!CLOUDINARY_CLOUD_NAME || !CLOUDINARY_UPLOAD_PRESET) {\r\n      reject(new Error('Cloudinary configuration is missing. Check your .env.local file.'));\r\n      return;\r\n    }\r\n\r\n    if (!file) {\r\n      reject(new Error('No file provided'));\r\n      return;\r\n    }\r\n\r\n    console.log('ðŸ”„ Starting Cloudinary upload...');\r\n    console.log('ðŸ“¦ File size:', file.size, 'bytes');\r\n    console.log('ðŸ“¦ File type:', file.type);\r\n    console.log('â˜ï¸ Cloud name:', CLOUDINARY_CLOUD_NAME);\r\n    console.log('ðŸ”‘ Upload preset:', CLOUDINARY_UPLOAD_PRESET);\r\n\r\n    const formData = new FormData();\r\n    formData.append('file', file);\r\n    formData.append('upload_preset', CLOUDINARY_UPLOAD_PRESET);\r\n    formData.append('folder', 'chat-app');\r\n\r\n    const xhr = new XMLHttpRequest();\r\n\r\n    // Track upload progress\r\n    if (onProgress) {\r\n      xhr.upload.addEventListener('progress', (e) => {\r\n        if (e.lengthComputable) {\r\n          const percentComplete = (e.loaded / e.total) * 100;\r\n          console.log(`ðŸ“¤ Upload progress: ${Math.round(percentComplete)}%`);\r\n          onProgress(percentComplete);\r\n        }\r\n      });\r\n    }\r\n\r\n    xhr.addEventListener('load', () => {\r\n      if (xhr.status === 200) {\r\n        try {\r\n          const response = JSON.parse(xhr.responseText);\r\n          console.log('âœ… Upload successful!');\r\n          console.log('ðŸ”— URL:', response.secure_url);\r\n          resolve(response.secure_url);\r\n        } catch (parseError) {\r\n          console.error('âŒ Failed to parse response:', parseError);\r\n          reject(new Error('Failed to parse Cloudinary response'));\r\n        }\r\n      } else {\r\n        console.error('âŒ Upload failed with status:', xhr.status);\r\n        console.error('ðŸ“„ Response:', xhr.responseText);\r\n        \r\n        let errorMessage = `Upload failed (${xhr.status})`;\r\n        try {\r\n          const errorResponse = JSON.parse(xhr.responseText);\r\n          errorMessage = errorResponse.error?.message || errorMessage;\r\n        } catch (e) {\r\n          // Ignore parsing error\r\n        }\r\n        \r\n        reject(new Error(errorMessage));\r\n      }\r\n    });\r\n\r\n    xhr.addEventListener('error', () => {\r\n      console.error('âŒ Network error during upload');\r\n      reject(new Error('Network error during upload'));\r\n    });\r\n\r\n    xhr.addEventListener('abort', () => {\r\n      console.log('âš ï¸ Upload cancelled');\r\n      reject(new Error('Upload cancelled'));\r\n    });\r\n\r\n    console.log('ðŸš€ Sending request to:', CLOUDINARY_URL);\r\n    xhr.open('POST', CLOUDINARY_URL);\r\n    xhr.send(formData);\r\n  });\r\n};\r\n\r\n/**\r\n * Test Cloudinary configuration\r\n */\r\nexport const testCloudinaryConfig = () => {\r\n  console.log('ðŸ§ª Testing Cloudinary Configuration:');\r\n  console.log('Cloud Name:', CLOUDINARY_CLOUD_NAME || 'âŒ NOT SET');\r\n  console.log('Upload Preset:', CLOUDINARY_UPLOAD_PRESET || 'âŒ NOT SET');\r\n  console.log('URL:', CLOUDINARY_URL);\r\n  \r\n  if (!CLOUDINARY_CLOUD_NAME || !CLOUDINARY_UPLOAD_PRESET) {\r\n    console.error('âŒ Cloudinary is not configured properly!');\r\n    console.error('ðŸ’¡ Make sure you have created .env.local file in your project root');\r\n    console.error('ðŸ’¡ The file should contain:');\r\n    console.error('   NEXT_PUBLIC_CLOUDINARY_CLOUD_NAME=your_cloud_name');\r\n    console.error('   NEXT_PUBLIC_CLOUDINARY_UPLOAD_PRESET=your_preset_name');\r\n    return false;\r\n  }\r\n  \r\n  console.log('âœ… Cloudinary configuration looks good!');\r\n  return true;\r\n};"],"names":[],"mappings":"AAAA,oBAAoB;;;;;;;AAEpB,MAAM;AACN,MAAM;AAEN,iCAAiC;AACjC;;AAIA;;AAIA,MAAM,iBAAiB,CAAC,gCAAgC,EAAE,sBAAsB,YAAY,CAAC;AAQtF,MAAM,qBAAqB,OAAO,MAAM,aAAa,IAAI;IAC9D,OAAO,IAAI,QAAQ,CAAC,SAAS;QAC3B,aAAa;QACb;;QAKA,IAAI,CAAC,MAAM;YACT,OAAO,IAAI,MAAM;YACjB;QACF;QAEA,QAAQ,GAAG,CAAC;QACZ,QAAQ,GAAG,CAAC,iBAAiB,KAAK,IAAI,EAAE;QACxC,QAAQ,GAAG,CAAC,iBAAiB,KAAK,IAAI;QACtC,QAAQ,GAAG,CAAC,kBAAkB;QAC9B,QAAQ,GAAG,CAAC,qBAAqB;QAEjC,MAAM,WAAW,IAAI;QACrB,SAAS,MAAM,CAAC,QAAQ;QACxB,SAAS,MAAM,CAAC,iBAAiB;QACjC,SAAS,MAAM,CAAC,UAAU;QAE1B,MAAM,MAAM,IAAI;QAEhB,wBAAwB;QACxB,IAAI,YAAY;YACd,IAAI,MAAM,CAAC,gBAAgB,CAAC,YAAY,CAAC;gBACvC,IAAI,EAAE,gBAAgB,EAAE;oBACtB,MAAM,kBAAkB,AAAC,EAAE,MAAM,GAAG,EAAE,KAAK,GAAI;oBAC/C,QAAQ,GAAG,CAAC,CAAC,oBAAoB,EAAE,KAAK,KAAK,CAAC,iBAAiB,CAAC,CAAC;oBACjE,WAAW;gBACb;YACF;QACF;QAEA,IAAI,gBAAgB,CAAC,QAAQ;YAC3B,IAAI,IAAI,MAAM,KAAK,KAAK;gBACtB,IAAI;oBACF,MAAM,WAAW,KAAK,KAAK,CAAC,IAAI,YAAY;oBAC5C,QAAQ,GAAG,CAAC;oBACZ,QAAQ,GAAG,CAAC,WAAW,SAAS,UAAU;oBAC1C,QAAQ,SAAS,UAAU;gBAC7B,EAAE,OAAO,YAAY;oBACnB,QAAQ,KAAK,CAAC,+BAA+B;oBAC7C,OAAO,IAAI,MAAM;gBACnB;YACF,OAAO;gBACL,QAAQ,KAAK,CAAC,gCAAgC,IAAI,MAAM;gBACxD,QAAQ,KAAK,CAAC,gBAAgB,IAAI,YAAY;gBAE9C,IAAI,eAAe,CAAC,eAAe,EAAE,IAAI,MAAM,CAAC,CAAC,CAAC;gBAClD,IAAI;oBACF,MAAM,gBAAgB,KAAK,KAAK,CAAC,IAAI,YAAY;oBACjD,eAAe,cAAc,KAAK,EAAE,WAAW;gBACjD,EAAE,OAAO,GAAG;gBACV,uBAAuB;gBACzB;gBAEA,OAAO,IAAI,MAAM;YACnB;QACF;QAEA,IAAI,gBAAgB,CAAC,SAAS;YAC5B,QAAQ,KAAK,CAAC;YACd,OAAO,IAAI,MAAM;QACnB;QAEA,IAAI,gBAAgB,CAAC,SAAS;YAC5B,QAAQ,GAAG,CAAC;YACZ,OAAO,IAAI,MAAM;QACnB;QAEA,QAAQ,GAAG,CAAC,0BAA0B;QACtC,IAAI,IAAI,CAAC,QAAQ;QACjB,IAAI,IAAI,CAAC;IACX;AACF;AAKO,MAAM,uBAAuB;IAClC,QAAQ,GAAG,CAAC;IACZ,QAAQ,GAAG,CAAC,eAAe,yBAAyB;IACpD,QAAQ,GAAG,CAAC,kBAAkB,4BAA4B;IAC1D,QAAQ,GAAG,CAAC,QAAQ;IAEpB;;IASA,QAAQ,GAAG,CAAC;IACZ,OAAO;AACT","debugId":null}},
    {"offset": {"line": 2308, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/waels/OneDrive/Desktop/Expo%20projects/P3/components/ChatScreen/utils.js"],"sourcesContent":["import { db } from \"../../firebase\";\r\nimport { collection, query, where, getDocs } from \"firebase/firestore\";\r\n\r\nexport const checkIfBlocked = async (currentUserEmail, recipientEmail) => {\r\n  try {\r\n    // Don't check blocking for self-chat\r\n    if (currentUserEmail === recipientEmail) {\r\n      return false;\r\n    }\r\n\r\n    // Check if current user is blocked by recipient\r\n    const usersRef = collection(db, \"users\");\r\n    const q = query(usersRef, where(\"email\", \"==\", recipientEmail));\r\n    const querySnapshot = await getDocs(q);\r\n\r\n    if (!querySnapshot.empty) {\r\n      const recipientData = querySnapshot.docs[0].data();\r\n      const blockedUsers = recipientData.blockedUsers || [];\r\n      \r\n      if (blockedUsers.includes(currentUserEmail)) {\r\n        return true;\r\n      }\r\n    }\r\n\r\n    return false;\r\n  } catch (error) {\r\n    console.error(\"Error checking if blocked:\", error);\r\n    return false;\r\n  }\r\n};\r\n\r\nexport const buildReplyData = (replyingTo) => {\r\n  if (!replyingTo) return null;\r\n\r\n  const replyData = {\r\n    messageId: replyingTo.id,\r\n    user: replyingTo.user,\r\n    message: replyingTo.message,\r\n  };\r\n\r\n  if (replyingTo.fileURL) {\r\n    replyData.fileURL = replyingTo.fileURL;\r\n    replyData.fileName = replyingTo.fileName;\r\n    replyData.fileType = replyingTo.fileType;\r\n  }\r\n\r\n  if (replyingTo.voiceURL) {\r\n    replyData.voiceURL = replyingTo.voiceURL;\r\n    replyData.duration = replyingTo.duration;\r\n  }\r\n\r\n  return replyData;\r\n};\r\n\r\nexport const formatFileSize = (bytes) => {\r\n  if (bytes === 0) return \"0 Bytes\";\r\n  const k = 1024;\r\n  const sizes = [\"Bytes\", \"KB\", \"MB\", \"GB\"];\r\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\r\n  return Math.round(bytes / Math.pow(k, i) * 100) / 100 + \" \" + sizes[i];\r\n};\r\n\r\nexport const formatTime = (seconds) => {\r\n  if (!seconds || seconds < 0) return \"0:00\";\r\n  \r\n  const mins = Math.floor(seconds / 60);\r\n  const secs = Math.floor(seconds % 60);\r\n  \r\n  return `${mins}:${secs.toString().padStart(2, \"0\")}`;\r\n};\r\n\r\nexport const getFileIcon = (fileType) => {\r\n  if (fileType?.startsWith(\"image/\")) return \"ðŸ–¼ï¸\";\r\n  if (fileType?.startsWith(\"video/\")) return \"ðŸŽ¥\";\r\n  if (fileType?.startsWith(\"audio/\")) return \"ðŸŽµ\";\r\n  if (fileType?.includes(\"pdf\")) return \"ðŸ“„\";\r\n  if (fileType?.includes(\"word\") || fileType?.includes(\"document\")) return \"ðŸ“\";\r\n  if (fileType?.includes(\"sheet\") || fileType?.includes(\"excel\")) return \"ðŸ“Š\";\r\n  if (fileType?.includes(\"zip\") || fileType?.includes(\"rar\")) return \"ðŸ“¦\";\r\n  return \"ðŸ“Ž\";\r\n};"],"names":[],"mappings":";;;;;;;;;;;;AAAA;AACA;;;;;;;;AAEO,MAAM,iBAAiB,OAAO,kBAAkB;IACrD,IAAI;QACF,qCAAqC;QACrC,IAAI,qBAAqB,gBAAgB;YACvC,OAAO;QACT;QAEA,gDAAgD;QAChD,MAAM,WAAW,IAAA,wJAAU,EAAC,uHAAE,EAAE;QAChC,MAAM,IAAI,IAAA,mJAAK,EAAC,UAAU,IAAA,mJAAK,EAAC,SAAS,MAAM;QAC/C,MAAM,gBAAgB,MAAM,IAAA,qJAAO,EAAC;QAEpC,IAAI,CAAC,cAAc,KAAK,EAAE;YACxB,MAAM,gBAAgB,cAAc,IAAI,CAAC,EAAE,CAAC,IAAI;YAChD,MAAM,eAAe,cAAc,YAAY,IAAI,EAAE;YAErD,IAAI,aAAa,QAAQ,CAAC,mBAAmB;gBAC3C,OAAO;YACT;QACF;QAEA,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,8BAA8B;QAC5C,OAAO;IACT;AACF;AAEO,MAAM,iBAAiB,CAAC;IAC7B,IAAI,CAAC,YAAY,OAAO;IAExB,MAAM,YAAY;QAChB,WAAW,WAAW,EAAE;QACxB,MAAM,WAAW,IAAI;QACrB,SAAS,WAAW,OAAO;IAC7B;IAEA,IAAI,WAAW,OAAO,EAAE;QACtB,UAAU,OAAO,GAAG,WAAW,OAAO;QACtC,UAAU,QAAQ,GAAG,WAAW,QAAQ;QACxC,UAAU,QAAQ,GAAG,WAAW,QAAQ;IAC1C;IAEA,IAAI,WAAW,QAAQ,EAAE;QACvB,UAAU,QAAQ,GAAG,WAAW,QAAQ;QACxC,UAAU,QAAQ,GAAG,WAAW,QAAQ;IAC1C;IAEA,OAAO;AACT;AAEO,MAAM,iBAAiB,CAAC;IAC7B,IAAI,UAAU,GAAG,OAAO;IACxB,MAAM,IAAI;IACV,MAAM,QAAQ;QAAC;QAAS;QAAM;QAAM;KAAK;IACzC,MAAM,IAAI,KAAK,KAAK,CAAC,KAAK,GAAG,CAAC,SAAS,KAAK,GAAG,CAAC;IAChD,OAAO,KAAK,KAAK,CAAC,QAAQ,KAAK,GAAG,CAAC,GAAG,KAAK,OAAO,MAAM,MAAM,KAAK,CAAC,EAAE;AACxE;AAEO,MAAM,aAAa,CAAC;IACzB,IAAI,CAAC,WAAW,UAAU,GAAG,OAAO;IAEpC,MAAM,OAAO,KAAK,KAAK,CAAC,UAAU;IAClC,MAAM,OAAO,KAAK,KAAK,CAAC,UAAU;IAElC,OAAO,GAAG,KAAK,CAAC,EAAE,KAAK,QAAQ,GAAG,QAAQ,CAAC,GAAG,MAAM;AACtD;AAEO,MAAM,cAAc,CAAC;IAC1B,IAAI,UAAU,WAAW,WAAW,OAAO;IAC3C,IAAI,UAAU,WAAW,WAAW,OAAO;IAC3C,IAAI,UAAU,WAAW,WAAW,OAAO;IAC3C,IAAI,UAAU,SAAS,QAAQ,OAAO;IACtC,IAAI,UAAU,SAAS,WAAW,UAAU,SAAS,aAAa,OAAO;IACzE,IAAI,UAAU,SAAS,YAAY,UAAU,SAAS,UAAU,OAAO;IACvE,IAAI,UAAU,SAAS,UAAU,UAAU,SAAS,QAAQ,OAAO;IACnE,OAAO;AACT","debugId":null}},
    {"offset": {"line": 2405, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/waels/OneDrive/Desktop/Expo%20projects/P3/components/ChatScreen/hooks/useFileUpload.js"],"sourcesContent":["// components/ChatScreen/hooks/useFileUpload.js\r\nimport { useState, useRef } from \"react\";\r\nimport { addDoc, collection, doc, setDoc, serverTimestamp } from \"firebase/firestore\";\r\nimport { db } from \"../../../firebase\";\r\nimport { uploadToCloudinary } from \"../../../lib/cloudinary\";\r\nimport { checkIfBlocked, buildReplyData } from \"../utils\";\r\nimport { MESSAGE_STATUS } from \"../constants\";\r\n\r\nexport const useFileUpload = (chatId, user, recipientEmail) => {\r\n  const [selectedFile, setSelectedFile] = useState(null);\r\n  const [filePreview, setFilePreview] = useState(null);\r\n  const [showFileConfirmation, setShowFileConfirmation] = useState(false);\r\n  const [uploadProgress, setUploadProgress] = useState(0);\r\n  const [isUploading, setIsUploading] = useState(false);\r\n  const fileInputRef = useRef(null);\r\n\r\n  const handleAttachClick = () => {\r\n    if (fileInputRef.current) {\r\n      fileInputRef.current.click();\r\n    }\r\n  };\r\n\r\n  const handleFileSelect = (e) => {\r\n    const file = e.target.files[0];\r\n    if (file) {\r\n      setSelectedFile(file);\r\n      \r\n      // Create preview for images\r\n      if (file.type.startsWith(\"image/\")) {\r\n        const reader = new FileReader();\r\n        reader.onloadend = () => {\r\n          setFilePreview(reader.result);\r\n        };\r\n        reader.readAsDataURL(file);\r\n      } else {\r\n        setFilePreview(null);\r\n      }\r\n      \r\n      setShowFileConfirmation(true);\r\n    }\r\n    \r\n    // Reset the input value so the same file can be selected again\r\n    e.target.value = '';\r\n  };\r\n\r\n  const cancelFileSelection = () => {\r\n    setSelectedFile(null);\r\n    setFilePreview(null);\r\n    setShowFileConfirmation(false);\r\n    setUploadProgress(0);\r\n  };\r\n\r\n  const sendFileMessage = async (input, replyingTo, setSendingError, setInput, setReplyingTo, scrollToBottom, isSelfChat = false) => {\r\n    if (!selectedFile || !chatId || !user || !recipientEmail) return;\r\n\r\n    setIsUploading(true);\r\n    setSendingError(null);\r\n\r\n    try {\r\n      // Skip blocking check for self-chat\r\n      if (!isSelfChat) {\r\n        const isBlocked = await checkIfBlocked(user.email, recipientEmail);\r\n        if (isBlocked) {\r\n          setSendingError(\"You cannot send messages to this user. You have been blocked.\");\r\n          setIsUploading(false);\r\n          return;\r\n        }\r\n      }\r\n\r\n      // Upload to Cloudinary with progress tracking\r\n      const fileURL = await uploadToCloudinary(selectedFile, (progress) => {\r\n        setUploadProgress(progress);\r\n      });\r\n\r\n      // Update user's last seen\r\n      const userRef = doc(db, \"users\", user.uid);\r\n      await setDoc(\r\n        userRef,\r\n        {\r\n          lastSeen: serverTimestamp(),\r\n        },\r\n        { merge: true }\r\n      );\r\n\r\n      // Build message data\r\n      const messageData = {\r\n        timestamp: serverTimestamp(),\r\n        message: input || \"\",\r\n        user: user.email,\r\n        photoURL: user.photoURL,\r\n        fileURL: fileURL,\r\n        fileName: selectedFile.name,\r\n        fileType: selectedFile.type,\r\n        fileSize: selectedFile.size,\r\n        status: MESSAGE_STATUS.SENT, // Initial status is SENT (1 gray check)\r\n      };\r\n\r\n      // Add reply data if replying\r\n      const replyData = buildReplyData(replyingTo);\r\n      if (replyData) {\r\n        messageData.replyTo = replyData;\r\n      }\r\n\r\n      // Send the message\r\n      await addDoc(collection(db, \"chats\", chatId, \"messages\"), messageData);\r\n\r\n      // Reset states\r\n      setInput(\"\");\r\n      setSelectedFile(null);\r\n      setFilePreview(null);\r\n      setShowFileConfirmation(false);\r\n      setUploadProgress(0);\r\n      setReplyingTo(null);\r\n      scrollToBottom();\r\n    } catch (error) {\r\n      console.error(\"Error sending file:\", error);\r\n      setSendingError(`Failed to send file: ${error.message}`);\r\n    } finally {\r\n      setIsUploading(false);\r\n    }\r\n  };\r\n\r\n  return {\r\n    selectedFile,\r\n    filePreview,\r\n    showFileConfirmation,\r\n    uploadProgress,\r\n    isUploading,\r\n    fileInputRef,\r\n    handleAttachClick,\r\n    handleFileSelect,\r\n    cancelFileSelection,\r\n    sendFileMessage,\r\n  };\r\n};"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2544, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/waels/OneDrive/Desktop/Expo%20projects/P3/components/ChatScreen/hooks/useVoiceRecording.js"],"sourcesContent":["// components/ChatScreen/hooks/useVoiceRecording.js\r\nimport { useState, useRef, useEffect } from \"react\";\r\nimport { addDoc, collection, doc, setDoc, serverTimestamp } from \"firebase/firestore\";\r\nimport { db } from \"../../../firebase\";\r\nimport { uploadToCloudinary } from \"../../../lib/cloudinary\";\r\nimport { checkIfBlocked, buildReplyData } from \"../utils\";\r\nimport { MESSAGE_STATUS } from \"../constants\";\r\n\r\nexport const useVoiceRecording = (chatId, user, recipientEmail) => {\r\n  const [isRecording, setIsRecording] = useState(false);\r\n  const [recordingTime, setRecordingTime] = useState(0);\r\n  const [audioBlob, setAudioBlob] = useState(null);\r\n  const [uploadProgress, setUploadProgress] = useState(0);\r\n  const [isUploading, setIsUploading] = useState(false);\r\n\r\n  const mediaRecorderRef = useRef(null);\r\n  const audioChunksRef = useRef([]);\r\n\r\n  // Recording timer\r\n  useEffect(() => {\r\n    let interval;\r\n    if (isRecording) {\r\n      interval = setInterval(() => {\r\n        setRecordingTime((prev) => prev + 1);\r\n      }, 1000);\r\n    } else {\r\n      setRecordingTime(0);\r\n    }\r\n    return () => clearInterval(interval);\r\n  }, [isRecording]);\r\n\r\n  const startRecording = async (setSendingError) => {\r\n    try {\r\n      const stream = await navigator.mediaDevices.getUserMedia({ audio: true });\r\n      \r\n      // Check for supported MIME types\r\n      let mimeType = 'audio/webm';\r\n      if (!MediaRecorder.isTypeSupported(mimeType)) {\r\n        mimeType = 'audio/webm;codecs=opus';\r\n        if (!MediaRecorder.isTypeSupported(mimeType)) {\r\n          mimeType = 'audio/ogg;codecs=opus';\r\n          if (!MediaRecorder.isTypeSupported(mimeType)) {\r\n            mimeType = 'audio/mp4';\r\n            if (!MediaRecorder.isTypeSupported(mimeType)) {\r\n              mimeType = ''; // Let browser choose\r\n            }\r\n          }\r\n        }\r\n      }\r\n      \r\n      console.log('Using MIME type:', mimeType || 'default');\r\n      \r\n      const options = mimeType ? { mimeType } : {};\r\n      const mediaRecorder = new MediaRecorder(stream, options);\r\n      mediaRecorderRef.current = mediaRecorder;\r\n      audioChunksRef.current = [];\r\n\r\n      mediaRecorder.ondataavailable = (event) => {\r\n        console.log('Data available:', event.data.size, 'bytes');\r\n        if (event.data.size > 0) {\r\n          audioChunksRef.current.push(event.data);\r\n        }\r\n      };\r\n\r\n      mediaRecorder.onstop = () => {\r\n        console.log('Recording stopped, chunks:', audioChunksRef.current.length);\r\n        const audioBlob = new Blob(audioChunksRef.current, { \r\n          type: mimeType || 'audio/webm' \r\n        });\r\n        \r\n        console.log('Blob size:', audioBlob.size);\r\n        \r\n        // Check if blob has data\r\n        if (audioBlob.size > 0) {\r\n          setAudioBlob(audioBlob);\r\n        } else {\r\n          console.error('No audio data captured');\r\n          setSendingError(\"Recording failed: No audio data captured. Please try again.\");\r\n        }\r\n        \r\n        stream.getTracks().forEach((track) => track.stop());\r\n      };\r\n\r\n      mediaRecorder.onerror = (event) => {\r\n        console.error('MediaRecorder error:', event.error);\r\n        setSendingError(`Recording error: ${event.error.name}`);\r\n      };\r\n\r\n      // Start with timeslice to ensure data is collected periodically\r\n      mediaRecorder.start(100); // Collect data every 100ms\r\n      setIsRecording(true);\r\n    } catch (error) {\r\n      console.error(\"Error starting recording:\", error);\r\n      setSendingError(\"Failed to access microphone. Please check permissions.\");\r\n    }\r\n  };\r\n\r\n  const stopRecording = () => {\r\n    if (mediaRecorderRef.current && isRecording) {\r\n      mediaRecorderRef.current.stop();\r\n      setIsRecording(false);\r\n    }\r\n  };\r\n\r\n  const cancelRecording = () => {\r\n    if (mediaRecorderRef.current && isRecording) {\r\n      mediaRecorderRef.current.stop();\r\n      setIsRecording(false);\r\n    }\r\n    setAudioBlob(null);\r\n    setRecordingTime(0);\r\n  };\r\n\r\n  const sendVoiceMessage = async (replyingTo, setSendingError, setReplyingTo, scrollToBottom, isSelfChat = false) => {\r\n    if (!audioBlob || !chatId || !user || !recipientEmail) return;\r\n\r\n    setIsUploading(true);\r\n    setSendingError(null);\r\n\r\n    try {\r\n      // Skip blocking check for self-chat\r\n      if (!isSelfChat) {\r\n        const isBlocked = await checkIfBlocked(user.email, recipientEmail);\r\n        if (isBlocked) {\r\n          setSendingError(\"You cannot send messages to this user. You have been blocked.\");\r\n          setIsUploading(false);\r\n          return;\r\n        }\r\n      }\r\n\r\n      // Upload to Cloudinary with progress tracking\r\n      const voiceURL = await uploadToCloudinary(audioBlob, (progress) => {\r\n        setUploadProgress(progress);\r\n      });\r\n\r\n      // Update user's last seen\r\n      const userRef = doc(db, \"users\", user.uid);\r\n      await setDoc(\r\n        userRef,\r\n        {\r\n          lastSeen: serverTimestamp(),\r\n        },\r\n        { merge: true }\r\n      );\r\n\r\n      // Build message data\r\n      const messageData = {\r\n        timestamp: serverTimestamp(),\r\n        message: \"\", // Empty message for voice\r\n        user: user.email,\r\n        photoURL: user.photoURL,\r\n        voiceURL: voiceURL,\r\n        voiceDuration: recordingTime,\r\n        status: MESSAGE_STATUS.SENT, // Initial status is SENT (1 gray check)\r\n      };\r\n\r\n      // Add reply data if replying\r\n      const replyData = buildReplyData(replyingTo);\r\n      if (replyData) {\r\n        messageData.replyTo = replyData;\r\n      }\r\n\r\n      // Send the message\r\n      await addDoc(collection(db, \"chats\", chatId, \"messages\"), messageData);\r\n\r\n      // Reset states\r\n      setAudioBlob(null);\r\n      setUploadProgress(0);\r\n      setReplyingTo(null);\r\n      scrollToBottom();\r\n    } catch (error) {\r\n      console.error(\"Error sending voice message:\", error);\r\n      setSendingError(`Failed to send voice message: ${error.message}`);\r\n    } finally {\r\n      setIsUploading(false);\r\n    }\r\n  };\r\n\r\n  return {\r\n    isRecording,\r\n    recordingTime,\r\n    audioBlob,\r\n    uploadProgress,\r\n    isUploading,\r\n    startRecording,\r\n    stopRecording,\r\n    cancelRecording,\r\n    sendVoiceMessage,\r\n  };\r\n};"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2735, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/waels/OneDrive/Desktop/Expo%20projects/P3/components/ChatScreen/hooks/useCamera.js"],"sourcesContent":["// components/ChatScreen/hooks/useCamera.js\r\nimport { useState, useRef } from \"react\";\r\nimport { addDoc, collection, doc, setDoc, serverTimestamp } from \"firebase/firestore\";\r\nimport { db } from \"../../../firebase\";\r\nimport { uploadToCloudinary } from \"../../../lib/cloudinary\";\r\nimport { checkIfBlocked, buildReplyData } from \"../utils\";\r\nimport { MESSAGE_STATUS } from \"../constants\";\r\n\r\nexport const useCamera = (chatId, user, recipientEmail) => {\r\n  const [showCamera, setShowCamera] = useState(false);\r\n  const [capturedImage, setCapturedImage] = useState(null);\r\n  const [capturedImageBlob, setCapturedImageBlob] = useState(null);\r\n  const [stream, setStream] = useState(null);\r\n  const [uploadProgress, setUploadProgress] = useState(0);\r\n  const [isUploading, setIsUploading] = useState(false);\r\n  const videoRef = useRef(null);\r\n\r\n  const startCamera = async () => {\r\n    try {\r\n      const mediaStream = await navigator.mediaDevices.getUserMedia({\r\n        video: { \r\n          facingMode: \"user\",\r\n          width: { ideal: 1280 },\r\n          height: { ideal: 720 }\r\n        },\r\n        audio: false,\r\n      });\r\n      setStream(mediaStream);\r\n      setShowCamera(true);\r\n      \r\n      // Wait for video element to be available\r\n      setTimeout(() => {\r\n        if (videoRef.current) {\r\n          videoRef.current.srcObject = mediaStream;\r\n        }\r\n      }, 100);\r\n    } catch (error) {\r\n      console.error(\"Error accessing camera:\", error);\r\n      alert(\"Unable to access camera. Please check permissions.\");\r\n    }\r\n  };\r\n\r\n  const capturePhoto = () => {\r\n    if (videoRef.current) {\r\n      const canvas = document.createElement(\"canvas\");\r\n      const video = videoRef.current;\r\n      \r\n      // Set canvas dimensions to match video\r\n      canvas.width = video.videoWidth;\r\n      canvas.height = video.videoHeight;\r\n      \r\n      const ctx = canvas.getContext(\"2d\");\r\n      ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\r\n      \r\n      // Convert canvas to blob with high quality\r\n      canvas.toBlob((blob) => {\r\n        if (blob) {\r\n          console.log(\"ðŸ“¸ Photo captured:\", {\r\n            size: blob.size,\r\n            type: blob.type,\r\n            width: canvas.width,\r\n            height: canvas.height\r\n          });\r\n          \r\n          // Create preview URL\r\n          const previewUrl = URL.createObjectURL(blob);\r\n          setCapturedImage(previewUrl);\r\n          setCapturedImageBlob(blob);\r\n          stopCamera();\r\n        } else {\r\n          console.error(\"Failed to create blob from canvas\");\r\n          alert(\"Failed to capture photo. Please try again.\");\r\n        }\r\n      }, \"image/jpeg\", 0.95);\r\n    }\r\n  };\r\n\r\n  const stopCamera = () => {\r\n    if (stream) {\r\n      stream.getTracks().forEach((track) => track.stop());\r\n      setStream(null);\r\n    }\r\n    setShowCamera(false);\r\n  };\r\n\r\n  const retakePhoto = () => {\r\n    if (capturedImage) {\r\n      URL.revokeObjectURL(capturedImage);\r\n    }\r\n    setCapturedImage(null);\r\n    setCapturedImageBlob(null);\r\n    startCamera();\r\n  };\r\n\r\n  const cancelPhoto = () => {\r\n    if (capturedImage) {\r\n      URL.revokeObjectURL(capturedImage);\r\n    }\r\n    setCapturedImage(null);\r\n    setCapturedImageBlob(null);\r\n    stopCamera();\r\n    setUploadProgress(0);\r\n  };\r\n\r\n  const sendPhoto = async (input, replyingTo, setSendingError, setInput, setReplyingTo, scrollToBottom, isSelfChat = false) => {\r\n    if (!capturedImageBlob || !chatId || !user || !recipientEmail) {\r\n      console.error(\"Missing required data for sending photo\");\r\n      return;\r\n    }\r\n\r\n    setIsUploading(true);\r\n    setSendingError(null);\r\n\r\n    try {\r\n      console.log(\"ðŸ“¤ Starting photo upload...\");\r\n      \r\n      // Skip blocking check for self-chat\r\n      if (!isSelfChat) {\r\n        const isBlocked = await checkIfBlocked(user.email, recipientEmail);\r\n        if (isBlocked) {\r\n          setSendingError(\"You cannot send messages to this user. You have been blocked.\");\r\n          setIsUploading(false);\r\n          return;\r\n        }\r\n      }\r\n\r\n      // Convert blob to file with proper metadata\r\n      const timestamp = Date.now();\r\n      const fileName = `camera_photo_${timestamp}.jpg`;\r\n      const file = new File([capturedImageBlob], fileName, { \r\n        type: \"image/jpeg\",\r\n        lastModified: timestamp\r\n      });\r\n\r\n      console.log(\"ðŸ“¸ Photo file created:\", {\r\n        name: file.name,\r\n        size: file.size,\r\n        type: file.type\r\n      });\r\n\r\n      // Upload to Cloudinary\r\n      const fileURL = await uploadToCloudinary(file, (progress) => {\r\n        console.log(`â¬†ï¸ Upload progress: ${progress}%`);\r\n        setUploadProgress(progress);\r\n      });\r\n\r\n      console.log(\"âœ… Upload complete, URL:\", fileURL);\r\n\r\n      // Update user's last seen\r\n      const userRef = doc(db, \"users\", user.uid);\r\n      await setDoc(\r\n        userRef,\r\n        {\r\n          lastSeen: serverTimestamp(),\r\n        },\r\n        { merge: true }\r\n      );\r\n\r\n      // Build message data\r\n      const messageData = {\r\n        timestamp: serverTimestamp(),\r\n        message: input || \"\",\r\n        user: user.email,\r\n        photoURL: user.photoURL,\r\n        fileURL: fileURL,\r\n        fileName: fileName,\r\n        fileType: \"image/jpeg\",\r\n        fileSize: capturedImageBlob.size,\r\n        status: MESSAGE_STATUS.SENT,\r\n      };\r\n\r\n      // Add reply data if replying\r\n      const replyData = buildReplyData(replyingTo);\r\n      if (replyData) {\r\n        messageData.replyTo = replyData;\r\n      }\r\n\r\n      console.log(\"ðŸ’¾ Saving message to Firestore:\", messageData);\r\n\r\n      // Send the message\r\n      await addDoc(collection(db, \"chats\", chatId, \"messages\"), messageData);\r\n\r\n      console.log(\"âœ… Message saved successfully\");\r\n\r\n      // Clean up\r\n      if (capturedImage) {\r\n        URL.revokeObjectURL(capturedImage);\r\n      }\r\n\r\n      // Reset states\r\n      setInput(\"\");\r\n      setCapturedImage(null);\r\n      setCapturedImageBlob(null);\r\n      setUploadProgress(0);\r\n      setReplyingTo(null);\r\n      scrollToBottom();\r\n    } catch (error) {\r\n      console.error(\"âŒ Error sending photo:\", error);\r\n      setSendingError(`Failed to send photo: ${error.message}`);\r\n    } finally {\r\n      setIsUploading(false);\r\n    }\r\n  };\r\n\r\n  return {\r\n    showCamera,\r\n    capturedImage,\r\n    uploadProgress,\r\n    isUploading,\r\n    videoRef,\r\n    startCamera,\r\n    capturePhoto,\r\n    retakePhoto,\r\n    cancelPhoto,\r\n    sendPhoto,\r\n  };\r\n};"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2951, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/waels/OneDrive/Desktop/Expo%20projects/P3/components/ChatScreen/hooks/useLocation.js"],"sourcesContent":["// components/ChatScreen/hooks/useLocation.js\r\nimport { useState } from \"react\";\r\nimport { addDoc, collection, doc, setDoc, serverTimestamp } from \"firebase/firestore\";\r\nimport { db } from \"../../../firebase\";\r\nimport { checkIfBlocked, buildReplyData } from \"../utils\";\r\nimport { MESSAGE_STATUS } from \"../constants\";\r\n\r\nexport const useLocation = (chatId, user, recipientEmail) => {\r\n  const [isGettingLocation, setIsGettingLocation] = useState(false);\r\n  const [showLocationPreview, setShowLocationPreview] = useState(false);\r\n  const [locationData, setLocationData] = useState(null);\r\n\r\n  const getLocation = () => {\r\n    if (!navigator.geolocation) {\r\n      alert(\"Geolocation is not supported by your browser\");\r\n      return;\r\n    }\r\n\r\n    setIsGettingLocation(true);\r\n    setShowLocationPreview(true);\r\n\r\n    navigator.geolocation.getCurrentPosition(\r\n      (position) => {\r\n        const { latitude, longitude } = position.coords;\r\n        setLocationData({\r\n          latitude,\r\n          longitude,\r\n          url: `https://www.google.com/maps?q=${latitude},${longitude}`,\r\n        });\r\n        setIsGettingLocation(false);\r\n      },\r\n      (error) => {\r\n        console.error(\"Error getting location:\", error);\r\n        let errorMessage = \"Unable to retrieve your location.\";\r\n        \r\n        switch(error.code) {\r\n          case error.PERMISSION_DENIED:\r\n            errorMessage = \"Location permission denied. Please enable location access in your browser settings.\";\r\n            break;\r\n          case error.POSITION_UNAVAILABLE:\r\n            errorMessage = \"Location information is unavailable.\";\r\n            break;\r\n          case error.TIMEOUT:\r\n            errorMessage = \"Location request timed out.\";\r\n            break;\r\n        }\r\n        \r\n        alert(errorMessage);\r\n        setIsGettingLocation(false);\r\n        setShowLocationPreview(false);\r\n      },\r\n      {\r\n        enableHighAccuracy: true,\r\n        timeout: 10000,\r\n        maximumAge: 0\r\n      }\r\n    );\r\n  };\r\n\r\n  const cancelLocation = () => {\r\n    setLocationData(null);\r\n    setShowLocationPreview(false);\r\n    setIsGettingLocation(false);\r\n  };\r\n\r\n  const sendLocation = async (input, replyingTo, setSendingError, setInput, setReplyingTo, scrollToBottom, isSelfChat = false) => {\r\n    if (!locationData || !chatId || !user || !recipientEmail) {\r\n      console.error(\"Missing required data for sending location\");\r\n      return;\r\n    }\r\n\r\n    setSendingError(null);\r\n\r\n    try {\r\n      // Skip blocking check for self-chat\r\n      if (!isSelfChat) {\r\n        const isBlocked = await checkIfBlocked(user.email, recipientEmail);\r\n        if (isBlocked) {\r\n          setSendingError(\"You cannot send messages to this user. You have been blocked.\");\r\n          return;\r\n        }\r\n      }\r\n\r\n      // Update user's last seen\r\n      const userRef = doc(db, \"users\", user.uid);\r\n      await setDoc(\r\n        userRef,\r\n        {\r\n          lastSeen: serverTimestamp(),\r\n        },\r\n        { merge: true }\r\n      );\r\n\r\n      // Build message data\r\n      const messageData = {\r\n        timestamp: serverTimestamp(),\r\n        message: input || \"ðŸ“ Shared Location\",\r\n        user: user.email,\r\n        photoURL: user.photoURL,\r\n        location: {\r\n          latitude: locationData.latitude,\r\n          longitude: locationData.longitude,\r\n          url: locationData.url,\r\n        },\r\n        status: MESSAGE_STATUS.SENT,\r\n      };\r\n\r\n      // Add reply data if replying\r\n      const replyData = buildReplyData(replyingTo);\r\n      if (replyData) {\r\n        messageData.replyTo = replyData;\r\n      }\r\n\r\n      console.log(\"ðŸ“ Sending location message:\", messageData);\r\n\r\n      // Send the message\r\n      await addDoc(collection(db, \"chats\", chatId, \"messages\"), messageData);\r\n\r\n      // Reset states\r\n      setInput(\"\");\r\n      setLocationData(null);\r\n      setShowLocationPreview(false);\r\n      setReplyingTo(null);\r\n      scrollToBottom();\r\n      \r\n      console.log(\"âœ… Location message sent successfully\");\r\n    } catch (error) {\r\n      console.error(\"Error sending location:\", error);\r\n      setSendingError(`Failed to send location: ${error.message}`);\r\n    }\r\n  };\r\n\r\n  return {\r\n    isGettingLocation,\r\n    showLocationPreview,\r\n    locationData,\r\n    getLocation,\r\n    cancelLocation,\r\n    sendLocation,\r\n  };\r\n}; "],"names":[],"mappings":"AAAA,6CAA6C;;;;;AAC7C;AACA;AACA;AACA;AACA;;;;;;;;;;;;AAEO,MAAM,cAAc,CAAC,QAAQ,MAAM;IACxC,MAAM,CAAC,mBAAmB,qBAAqB,GAAG,IAAA,+GAAQ,EAAC;IAC3D,MAAM,CAAC,qBAAqB,uBAAuB,GAAG,IAAA,+GAAQ,EAAC;IAC/D,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,+GAAQ,EAAC;IAEjD,MAAM,cAAc;QAClB,IAAI,CAAC,UAAU,WAAW,EAAE;YAC1B,MAAM;YACN;QACF;QAEA,qBAAqB;QACrB,uBAAuB;QAEvB,UAAU,WAAW,CAAC,kBAAkB,CACtC,CAAC;YACC,MAAM,EAAE,QAAQ,EAAE,SAAS,EAAE,GAAG,SAAS,MAAM;YAC/C,gBAAgB;gBACd;gBACA;gBACA,KAAK,CAAC,8BAA8B,EAAE,SAAS,CAAC,EAAE,WAAW;YAC/D;YACA,qBAAqB;QACvB,GACA,CAAC;YACC,QAAQ,KAAK,CAAC,2BAA2B;YACzC,IAAI,eAAe;YAEnB,OAAO,MAAM,IAAI;gBACf,KAAK,MAAM,iBAAiB;oBAC1B,eAAe;oBACf;gBACF,KAAK,MAAM,oBAAoB;oBAC7B,eAAe;oBACf;gBACF,KAAK,MAAM,OAAO;oBAChB,eAAe;oBACf;YACJ;YAEA,MAAM;YACN,qBAAqB;YACrB,uBAAuB;QACzB,GACA;YACE,oBAAoB;YACpB,SAAS;YACT,YAAY;QACd;IAEJ;IAEA,MAAM,iBAAiB;QACrB,gBAAgB;QAChB,uBAAuB;QACvB,qBAAqB;IACvB;IAEA,MAAM,eAAe,OAAO,OAAO,YAAY,iBAAiB,UAAU,eAAe,gBAAgB,aAAa,KAAK;QACzH,IAAI,CAAC,gBAAgB,CAAC,UAAU,CAAC,QAAQ,CAAC,gBAAgB;YACxD,QAAQ,KAAK,CAAC;YACd;QACF;QAEA,gBAAgB;QAEhB,IAAI;YACF,oCAAoC;YACpC,IAAI,CAAC,YAAY;gBACf,MAAM,YAAY,MAAM,IAAA,4IAAc,EAAC,KAAK,KAAK,EAAE;gBACnD,IAAI,WAAW;oBACb,gBAAgB;oBAChB;gBACF;YACF;YAEA,0BAA0B;YAC1B,MAAM,UAAU,IAAA,iJAAG,EAAC,uHAAE,EAAE,SAAS,KAAK,GAAG;YACzC,MAAM,IAAA,oJAAM,EACV,SACA;gBACE,UAAU,IAAA,6JAAe;YAC3B,GACA;gBAAE,OAAO;YAAK;YAGhB,qBAAqB;YACrB,MAAM,cAAc;gBAClB,WAAW,IAAA,6JAAe;gBAC1B,SAAS,SAAS;gBAClB,MAAM,KAAK,KAAK;gBAChB,UAAU,KAAK,QAAQ;gBACvB,UAAU;oBACR,UAAU,aAAa,QAAQ;oBAC/B,WAAW,aAAa,SAAS;oBACjC,KAAK,aAAa,GAAG;gBACvB;gBACA,QAAQ,gJAAc,CAAC,IAAI;YAC7B;YAEA,6BAA6B;YAC7B,MAAM,YAAY,IAAA,4IAAc,EAAC;YACjC,IAAI,WAAW;gBACb,YAAY,OAAO,GAAG;YACxB;YAEA,QAAQ,GAAG,CAAC,gCAAgC;YAE5C,mBAAmB;YACnB,MAAM,IAAA,oJAAM,EAAC,IAAA,wJAAU,EAAC,uHAAE,EAAE,SAAS,QAAQ,aAAa;YAE1D,eAAe;YACf,SAAS;YACT,gBAAgB;YAChB,uBAAuB;YACvB,cAAc;YACd;YAEA,QAAQ,GAAG,CAAC;QACd,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,2BAA2B;YACzC,gBAAgB,CAAC,yBAAyB,EAAE,MAAM,OAAO,EAAE;QAC7D;IACF;IAEA,OAAO;QACL;QACA;QACA;QACA;QACA;QACA;IACF;AACF","debugId":null}},
    {"offset": {"line": 3090, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/waels/OneDrive/Desktop/Expo%20projects/P3/components/ChatScreen/hooks/usePolls.js"],"sourcesContent":["// components/ChatScreen/hooks/usePolls.js\r\nimport { useState } from \"react\";\r\nimport { addDoc, collection, serverTimestamp } from \"firebase/firestore\";\r\nimport { db } from \"../../../firebase\";\r\nimport { MESSAGE_STATUS } from \"../constants\";\r\nimport { checkIfBlocked } from \"../utils\";\r\n\r\nexport const usePolls = (chatId, user, recipientEmail) => {\r\n  const [showPollDialog, setShowPollDialog] = useState(false);\r\n  const [pollQuestion, setPollQuestion] = useState(\"\");\r\n  const [pollOptions, setPollOptions] = useState([\"\", \"\"]);\r\n  const [allowMultipleAnswers, setAllowMultipleAnswers] = useState(false);\r\n  const [isSendingPoll, setIsSendingPoll] = useState(false);\r\n\r\n  const openPollDialog = () => {\r\n    setShowPollDialog(true);\r\n    setPollQuestion(\"\");\r\n    setPollOptions([\"\", \"\"]);\r\n    setAllowMultipleAnswers(false);\r\n  };\r\n\r\n  const closePollDialog = () => {\r\n    setShowPollDialog(false);\r\n    setPollQuestion(\"\");\r\n    setPollOptions([\"\", \"\"]);\r\n    setAllowMultipleAnswers(false);\r\n  };\r\n\r\n  const handleOptionChange = (index, value) => {\r\n    const newOptions = [...pollOptions];\r\n    newOptions[index] = value;\r\n    setPollOptions(newOptions);\r\n\r\n    // Add new blank option if last two options are filled\r\n    if (index === pollOptions.length - 1 && index >= 1) {\r\n      const lastTwoFilled = newOptions[index] && newOptions[index - 1];\r\n      if (lastTwoFilled && pollOptions.length < 10) {\r\n        setPollOptions([...newOptions, \"\"]);\r\n      }\r\n    }\r\n  };\r\n\r\n  const removeOption = (index) => {\r\n    if (pollOptions.length > 2) {\r\n      const newOptions = pollOptions.filter((_, i) => i !== index);\r\n      setPollOptions(newOptions);\r\n    }\r\n  };\r\n\r\n  const sendPoll = async (\r\n    replyingTo,\r\n    setSendingError,\r\n    setReplyingTo,\r\n    scrollToBottom,\r\n    isSelfChat\r\n  ) => {\r\n    if (!chatId || !user || !recipientEmail) {\r\n      console.error(\"Missing required data for sending poll\");\r\n      return;\r\n    }\r\n\r\n    if (!pollQuestion.trim()) {\r\n      setSendingError(\"Please enter a question for the poll\");\r\n      return;\r\n    }\r\n\r\n    const validOptions = pollOptions.filter((opt) => opt.trim());\r\n    if (validOptions.length < 2) {\r\n      setSendingError(\"Please provide at least 2 options\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setIsSendingPoll(true);\r\n\r\n      if (!isSelfChat) {\r\n        const isBlocked = await checkIfBlocked(user.email, recipientEmail);\r\n        if (isBlocked) {\r\n          setSendingError(\"You cannot send messages to this user.\");\r\n          return;\r\n        }\r\n      }\r\n\r\n      const pollData = {\r\n        timestamp: serverTimestamp(),\r\n        user: user.email,\r\n        photoURL: user.photoURL,\r\n        status: MESSAGE_STATUS.SENT,\r\n        poll: {\r\n          question: pollQuestion.trim(),\r\n          options: validOptions.map((opt) => ({\r\n            text: opt,\r\n            votes: [],\r\n          })),\r\n          allowMultipleAnswers,\r\n          createdBy: user.email,\r\n        },\r\n      };\r\n\r\n      if (replyingTo) {\r\n        pollData.replyTo = {\r\n          id: replyingTo.id,\r\n          user: replyingTo.user,\r\n          message: replyingTo.message,\r\n          timestamp: replyingTo.timestamp,\r\n        };\r\n      }\r\n\r\n      await addDoc(collection(db, \"chats\", chatId, \"messages\"), pollData);\r\n\r\n      closePollDialog();\r\n      if (setReplyingTo) setReplyingTo(null);\r\n      scrollToBottom();\r\n    } catch (error) {\r\n      console.error(\"Error sending poll:\", error);\r\n      setSendingError(\"Failed to send poll. Please try again.\");\r\n    } finally {\r\n      setIsSendingPoll(false);\r\n    }\r\n  };\r\n\r\n  return {\r\n    showPollDialog,\r\n    pollQuestion,\r\n    setPollQuestion,\r\n    pollOptions,\r\n    allowMultipleAnswers,\r\n    setAllowMultipleAnswers,\r\n    isSendingPoll,\r\n    openPollDialog,\r\n    closePollDialog,\r\n    handleOptionChange,\r\n    removeOption,\r\n    sendPoll,\r\n  };\r\n};"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3240, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/waels/OneDrive/Desktop/Expo%20projects/P3/components/ChatScreen/hooks/useRecipientData.js"],"sourcesContent":["// components/ChatScreen/hooks/useRecipientData.js\r\n\r\nimport { useCollection } from \"react-firebase-hooks/firestore\";\r\nimport { collection, query, where } from \"firebase/firestore\";\r\nimport { db } from \"../../../firebase\";\r\nimport { useMemo } from \"react\";\r\n\r\nexport const useRecipientData = (user, chat) => {\r\n  // âœ… Return early with null values if data is not ready\r\n  if (!user || !chat || !chat.users || chat.users.length === 0) {\r\n    console.log(\"â³ useRecipientData: Waiting for chat data...\", {\r\n      hasUser: !!user,\r\n      hasChat: !!chat,\r\n      hasUsers: !!chat?.users,\r\n      usersLength: chat?.users?.length,\r\n    });\r\n    return {\r\n      recipientEmail: null,\r\n      recipient: null,\r\n      recipientSnapshot: null,\r\n      isSelfChat: false,\r\n      isLoading: true,\r\n    };\r\n  }\r\n\r\n  // âœ… Memoize recipient calculation to prevent unnecessary recalculations\r\n  const recipientData = useMemo(() => {\r\n    // âœ… Clean the users array first\r\n    const cleanUsers = [...new Set(chat.users.filter(Boolean))];\r\n    \r\n    console.log(\"ðŸ” useRecipientData: Processing chat\", {\r\n      originalUsers: chat.users,\r\n      cleanUsers: cleanUsers,\r\n      currentUser: user.email,\r\n    });\r\n\r\n    // Normalize emails for comparison\r\n    const normalizedUserEmail = user.email.toLowerCase();\r\n    const normalizedUsers = cleanUsers.map(email => email?.toLowerCase()).filter(Boolean);\r\n\r\n    // Check if this is a self-chat (all users are the same person)\r\n    // components/ChatScreen/hooks/useRecipientData.js (in the useMemo)\r\n\r\n// Check if this is a self-chat\r\nconst isSelfChat = (\r\n  // Single user that matches current user\r\n  (normalizedUsers.length === 1 && normalizedUsers[0] === normalizedUserEmail) ||\r\n  // All users are the same person (for 2-user arrays)\r\n  (normalizedUsers.length === 2 && normalizedUsers.every(email => email === normalizedUserEmail))\r\n);\r\n\r\n    console.log(\"ðŸ” useRecipientData: Self-chat check\", {\r\n      normalizedUsers,\r\n      normalizedUserEmail,\r\n      isSelfChat,\r\n    });\r\n\r\n    // Handle self-chat case - use current user's email\r\n    if (isSelfChat) {\r\n      console.log(\"ðŸ’¬ useRecipientData: Self-chat detected - recipient is yourself\");\r\n      return {\r\n        recipientEmail: user.email,\r\n        isSelfChat: true,\r\n      };\r\n    }\r\n\r\n    // Find the OTHER user (not the current user)\r\n    const recipientEmail = cleanUsers.find(\r\n      (userEmail) => userEmail && userEmail.toLowerCase() !== normalizedUserEmail\r\n    );\r\n\r\n    // âœ… IMPORTANT: If we can't find a recipient, DON'T fallback to user.email\r\n    if (!recipientEmail) {\r\n      console.error(\"âŒ useRecipientData: Could not find recipient in chat.users\", {\r\n        cleanUsers,\r\n        currentUser: user.email,\r\n      });\r\n      return {\r\n        recipientEmail: null,\r\n        isSelfChat: false,\r\n      };\r\n    }\r\n\r\n    console.log(\"âœ… useRecipientData: Found recipient\", {\r\n      recipient: recipientEmail,\r\n      currentUser: user.email,\r\n      isSelfChat: false,\r\n    });\r\n\r\n    return {\r\n      recipientEmail,\r\n      isSelfChat: false,\r\n    };\r\n  }, [chat.users, user.email]);\r\n\r\n  // âœ… Only query Firestore if we have a valid recipient email\r\n  const recipientQuery = recipientData.recipientEmail\r\n    ? query(collection(db, \"users\"), where(\"email\", \"==\", recipientData.recipientEmail))\r\n    : null;\r\n\r\n  const [recipientSnapshot] = useCollection(recipientQuery);\r\n\r\n  const recipient = recipientSnapshot?.docs?.[0]?.data();\r\n\r\n  return {\r\n    recipientEmail: recipientData.recipientEmail,\r\n    recipient: recipient || {\r\n      email: recipientData.recipientEmail,\r\n      photoURL: recipientData.isSelfChat ? user.photoURL : null,\r\n    },\r\n    recipientSnapshot,\r\n    isSelfChat: recipientData.isSelfChat,\r\n    isLoading: false,\r\n  };\r\n};"],"names":[],"mappings":"AAAA,kDAAkD;;;;;AAElD;AACA;AACA;AACA;;;;;;;;;;AAEO,MAAM,mBAAmB,CAAC,MAAM;IACrC,uDAAuD;IACvD,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,KAAK,KAAK,IAAI,KAAK,KAAK,CAAC,MAAM,KAAK,GAAG;QAC5D,QAAQ,GAAG,CAAC,gDAAgD;YAC1D,SAAS,CAAC,CAAC;YACX,SAAS,CAAC,CAAC;YACX,UAAU,CAAC,CAAC,MAAM;YAClB,aAAa,MAAM,OAAO;QAC5B;QACA,OAAO;YACL,gBAAgB;YAChB,WAAW;YACX,mBAAmB;YACnB,YAAY;YACZ,WAAW;QACb;IACF;IAEA,wEAAwE;IACxE,MAAM,gBAAgB,IAAA,8GAAO,EAAC;QAC5B,gCAAgC;QAChC,MAAM,aAAa;eAAI,IAAI,IAAI,KAAK,KAAK,CAAC,MAAM,CAAC;SAAU;QAE3D,QAAQ,GAAG,CAAC,wCAAwC;YAClD,eAAe,KAAK,KAAK;YACzB,YAAY;YACZ,aAAa,KAAK,KAAK;QACzB;QAEA,kCAAkC;QAClC,MAAM,sBAAsB,KAAK,KAAK,CAAC,WAAW;QAClD,MAAM,kBAAkB,WAAW,GAAG,CAAC,CAAA,QAAS,OAAO,eAAe,MAAM,CAAC;QAE7E,+DAA+D;QAC/D,mEAAmE;QAEvE,+BAA+B;QAC/B,MAAM,aACJ,wCAAwC;QACvC,gBAAgB,MAAM,KAAK,KAAK,eAAe,CAAC,EAAE,KAAK,uBAEvD,gBAAgB,MAAM,KAAK,KAAK,gBAAgB,KAAK,CAAC,CAAA,QAAS,UAAU;QAGxE,QAAQ,GAAG,CAAC,wCAAwC;YAClD;YACA;YACA;QACF;QAEA,mDAAmD;QACnD,IAAI,YAAY;YACd,QAAQ,GAAG,CAAC;YACZ,OAAO;gBACL,gBAAgB,KAAK,KAAK;gBAC1B,YAAY;YACd;QACF;QAEA,6CAA6C;QAC7C,MAAM,iBAAiB,WAAW,IAAI,CACpC,CAAC,YAAc,aAAa,UAAU,WAAW,OAAO;QAG1D,0EAA0E;QAC1E,IAAI,CAAC,gBAAgB;YACnB,QAAQ,KAAK,CAAC,8DAA8D;gBAC1E;gBACA,aAAa,KAAK,KAAK;YACzB;YACA,OAAO;gBACL,gBAAgB;gBAChB,YAAY;YACd;QACF;QAEA,QAAQ,GAAG,CAAC,uCAAuC;YACjD,WAAW;YACX,aAAa,KAAK,KAAK;YACvB,YAAY;QACd;QAEA,OAAO;YACL;YACA,YAAY;QACd;IACF,GAAG;QAAC,KAAK,KAAK;QAAE,KAAK,KAAK;KAAC;IAE3B,4DAA4D;IAC5D,MAAM,iBAAiB,cAAc,cAAc,GAC/C,IAAA,mJAAK,EAAC,IAAA,wJAAU,EAAC,uHAAE,EAAE,UAAU,IAAA,mJAAK,EAAC,SAAS,MAAM,cAAc,cAAc,KAChF;IAEJ,MAAM,CAAC,kBAAkB,GAAG,IAAA,wLAAa,EAAC;IAE1C,MAAM,YAAY,mBAAmB,MAAM,CAAC,EAAE,EAAE;IAEhD,OAAO;QACL,gBAAgB,cAAc,cAAc;QAC5C,WAAW,aAAa;YACtB,OAAO,cAAc,cAAc;YACnC,UAAU,cAAc,UAAU,GAAG,KAAK,QAAQ,GAAG;QACvD;QACA;QACA,YAAY,cAAc,UAAU;QACpC,WAAW;IACb;AACF","debugId":null}},
    {"offset": {"line": 3355, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/waels/OneDrive/Desktop/Expo%20projects/P3/components/ChatScreen/hooks/useMessages.js"],"sourcesContent":["// components/ChatScreen/hooks/useMessages.js\r\nimport { useMemo } from \"react\";\r\nimport { collection, query, orderBy } from \"firebase/firestore\";\r\nimport { useCollection } from \"react-firebase-hooks/firestore\";\r\nimport { db } from \"../../../firebase\";\r\n\r\nexport const useMessages = (chatId) => {\r\n  const messagesRef = useMemo(() => {\r\n    if (!chatId) return null;\r\n    return collection(db, \"chats\", chatId, \"messages\");\r\n  }, [chatId]);\r\n\r\n  const messagesQuery = useMemo(() => {\r\n    if (!messagesRef) return null;\r\n    return query(messagesRef, orderBy(\"timestamp\", \"asc\"));\r\n  }, [messagesRef]);\r\n\r\n  const [messagesSnapshot] = useCollection(messagesQuery || null);\r\n\r\n  return {\r\n    messagesSnapshot,\r\n  };\r\n};"],"names":[],"mappings":"AAAA,6CAA6C;;;;;AAC7C;AACA;AACA;AACA;;;;;;;;;;AAEO,MAAM,cAAc,CAAC;IAC1B,MAAM,cAAc,IAAA,8GAAO,EAAC;QAC1B,IAAI,CAAC,QAAQ,OAAO;QACpB,OAAO,IAAA,wJAAU,EAAC,uHAAE,EAAE,SAAS,QAAQ;IACzC,GAAG;QAAC;KAAO;IAEX,MAAM,gBAAgB,IAAA,8GAAO,EAAC;QAC5B,IAAI,CAAC,aAAa,OAAO;QACzB,OAAO,IAAA,mJAAK,EAAC,aAAa,IAAA,qJAAO,EAAC,aAAa;IACjD,GAAG;QAAC;KAAY;IAEhB,MAAM,CAAC,iBAAiB,GAAG,IAAA,wLAAa,EAAC,iBAAiB;IAE1D,OAAO;QACL;IACF;AACF","debugId":null}},
    {"offset": {"line": 3398, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/waels/OneDrive/Desktop/Expo%20projects/P3/components/ChatScreen/utils/messageStatus.js"],"sourcesContent":["// components/ChatScreen/utils/messageStatus.js\r\n\r\nimport { \r\n  collection, \r\n  query, \r\n  where, \r\n  getDocs, \r\n  updateDoc, \r\n  doc,\r\n  onSnapshot,\r\n  writeBatch,\r\n  serverTimestamp,\r\n  getDoc\r\n} from \"firebase/firestore\";\r\nimport { db } from \"../../../firebase\";\r\nimport { MESSAGE_STATUS } from \"../constants\";\r\n\r\n/**\r\n * Verify that a chat actually involves the specified users\r\n * âœ… FIXED: Uses 'users' field to match your database structure\r\n */\r\nconst verifyChatParticipants = async (chatId, userEmail1, userEmail2) => {\r\n  try {\r\n    if (!chatId) {\r\n      console.error(`âŒ verifyChatParticipants: chatId is missing`);\r\n      return false;\r\n    }\r\n\r\n    const chatRef = doc(db, \"chats\", chatId);\r\n    const chatSnap = await getDoc(chatRef);\r\n    \r\n    if (!chatSnap.exists()) {\r\n      console.error(`âŒ [Chat: ${chatId}] Chat does not exist`);\r\n      return false;\r\n    }\r\n    \r\n    const chatData = chatSnap.data();\r\n    \r\n    // âœ… FIX: Use 'users' field (your actual database structure)\r\n    const participants = chatData.users || chatData.participants || [];\r\n    \r\n    console.log(`ðŸ” [Chat: ${chatId}] Verifying participants:`, {\r\n      chatUsers: participants,\r\n      checkingUser1: userEmail1,\r\n      checkingUser2: userEmail2,\r\n      chatDataFields: Object.keys(chatData),\r\n    });\r\n    \r\n    if (!Array.isArray(participants)) {\r\n      console.error(`âŒ [Chat: ${chatId}] 'users' field is not an array:`, typeof participants, participants);\r\n      return false;\r\n    }\r\n\r\n    if (participants.length === 0) {\r\n      console.error(`âŒ [Chat: ${chatId}] No users in chat`);\r\n      return false;\r\n    }\r\n    \r\n    // Check if both users are participants\r\n    const hasUser1 = participants.includes(userEmail1);\r\n    const hasUser2 = !userEmail2 || participants.includes(userEmail2);\r\n    \r\n    if (!hasUser1) {\r\n      console.error(`âŒ [Chat: ${chatId}] User1 (${userEmail1}) NOT in chat. Chat users: [${participants.join(', ')}]`);\r\n      return false;\r\n    }\r\n    \r\n    if (!hasUser2) {\r\n      console.error(`âŒ [Chat: ${chatId}] User2 (${userEmail2}) NOT in chat. Chat users: [${participants.join(', ')}]`);\r\n      return false;\r\n    }\r\n    \r\n    console.log(`âœ… [Chat: ${chatId}] Participants verified: Both ${userEmail1} and ${userEmail2} are in chat`);\r\n    return true;\r\n  } catch (error) {\r\n    console.error(`âŒ [Chat: ${chatId}] Error verifying chat participants:`, error);\r\n    return false;\r\n  }\r\n};\r\n\r\n/**\r\n * Verify message belongs to the specific chat\r\n */\r\nconst verifyMessageInChat = (messageDoc, expectedChatId) => {\r\n  const messagePath = messageDoc.ref.path;\r\n  const pathParts = messagePath.split('/');\r\n  \r\n  // Path should be: chats/{chatId}/messages/{messageId}\r\n  if (pathParts.length >= 4 && pathParts[0] === 'chats' && pathParts[2] === 'messages') {\r\n    const actualChatId = pathParts[1];\r\n    \r\n    if (actualChatId !== expectedChatId) {\r\n      console.error(`âŒ Message ${messageDoc.id} belongs to chat ${actualChatId}, not ${expectedChatId}`);\r\n      return false;\r\n    }\r\n    return true;\r\n  }\r\n  \r\n  console.error(`âŒ Invalid message path: ${messagePath}`);\r\n  return false;\r\n};\r\n\r\n/**\r\n * Mark a single message as delivered\r\n */\r\nexport const markMessageAsDelivered = async (chatId, messageId) => {\r\n  try {\r\n    if (!chatId || !messageId) {\r\n      console.error(`âŒ markMessageAsDelivered: Missing chatId or messageId`, { chatId, messageId });\r\n      return;\r\n    }\r\n\r\n    const messageRef = doc(db, \"chats\", chatId, \"messages\", messageId);\r\n    \r\n    // Verify message exists in this specific chat\r\n    const messageSnap = await getDoc(messageRef);\r\n    if (!messageSnap.exists()) {\r\n      console.error(`âŒ [Chat: ${chatId}] Message ${messageId} not found`);\r\n      return;\r\n    }\r\n    \r\n    await updateDoc(messageRef, {\r\n      status: MESSAGE_STATUS.DELIVERED,\r\n      deliveredAt: serverTimestamp(),\r\n    });\r\n    console.log(`âœ… [Chat: ${chatId}] Message ${messageId} marked as DELIVERED`);\r\n  } catch (error) {\r\n    console.error(`âŒ [Chat: ${chatId}] Error marking message as delivered:`, error);\r\n  }\r\n};\r\n\r\n/**\r\n * Mark a single message as read\r\n */\r\nexport const markMessageAsRead = async (chatId, messageId) => {\r\n  try {\r\n    if (!chatId || !messageId) {\r\n      console.error(`âŒ markMessageAsRead: Missing chatId or messageId`, { chatId, messageId });\r\n      return;\r\n    }\r\n\r\n    const messageRef = doc(db, \"chats\", chatId, \"messages\", messageId);\r\n    \r\n    // Verify message exists in this specific chat\r\n    const messageSnap = await getDoc(messageRef);\r\n    if (!messageSnap.exists()) {\r\n      console.error(`âŒ [Chat: ${chatId}] Message ${messageId} not found`);\r\n      return;\r\n    }\r\n    \r\n    await updateDoc(messageRef, {\r\n      status: MESSAGE_STATUS.READ,\r\n      readAt: serverTimestamp(),\r\n    });\r\n    console.log(`âœ… [Chat: ${chatId}] Message ${messageId} marked as READ`);\r\n  } catch (error) {\r\n    console.error(`âŒ [Chat: ${chatId}] Error marking message as read:`, error);\r\n  }\r\n};\r\n\r\n/**\r\n * Check if recipient is actually online (with threshold of 30 seconds)\r\n */\r\nexport const isRecipientOnline = async (recipientEmail) => {\r\n  try {\r\n    if (!recipientEmail) {\r\n      console.log(`â“ isRecipientOnline: No recipientEmail provided`);\r\n      return false;\r\n    }\r\n\r\n    const usersRef = collection(db, \"users\");\r\n    const q = query(usersRef, where(\"email\", \"==\", recipientEmail));\r\n    \r\n    const snapshot = await getDocs(q);\r\n    \r\n    if (snapshot.empty) {\r\n      console.log(`â“ Recipient ${recipientEmail} not found in users`);\r\n      return false;\r\n    }\r\n\r\n    const recipientData = snapshot.docs[0].data();\r\n    const lastSeen = recipientData.lastSeen?.toDate?.() || new Date(recipientData.lastSeen);\r\n    const now = new Date();\r\n    const secondsAgo = (now - lastSeen) / 1000;\r\n\r\n    const isOnline = secondsAgo < 30;\r\n    \r\n    if (isOnline) {\r\n      console.log(`ðŸŸ¢ Recipient ${recipientEmail} IS online (last seen ${Math.round(secondsAgo)}s ago)`);\r\n    } else {\r\n      console.log(`ðŸ”´ Recipient ${recipientEmail} OFFLINE (last seen ${Math.round(secondsAgo)}s ago)`);\r\n    }\r\n\r\n    return isOnline;\r\n  } catch (error) {\r\n    console.error(\"âŒ Error checking recipient online status:\", error);\r\n    return false;\r\n  }\r\n};\r\n\r\n/**\r\n * Mark YOUR messages (sent by currentUser) as DELIVERED ONLY when recipient is online\r\n */\r\nexport const markYourMessagesAsDelivered = async (chatId, recipientEmail, currentUserEmail) => {\r\n  try {\r\n    if (!chatId || !currentUserEmail) {\r\n      console.error(`âŒ markYourMessagesAsDelivered: Missing required params`, {\r\n        chatId,\r\n        currentUserEmail,\r\n        recipientEmail\r\n      });\r\n      return;\r\n    }\r\n\r\n    console.log(`ðŸ” [Chat: ${chatId}] Attempting to mark YOUR messages as DELIVERED`);\r\n    console.log(`   Current User: ${currentUserEmail}, Recipient: ${recipientEmail}`);\r\n    \r\n    // âœ… CRITICAL: Verify this is the correct chat BEFORE querying messages\r\n    const isValidChat = await verifyChatParticipants(chatId, currentUserEmail, recipientEmail);\r\n    if (!isValidChat) {\r\n      console.error(`âŒ [Chat: ${chatId}] Chat validation failed - ABORTING message status update`);\r\n      return;\r\n    }\r\n    \r\n    // Check if recipient is actually online\r\n    const online = await isRecipientOnline(recipientEmail);\r\n    \r\n    if (!online && recipientEmail) {\r\n      console.log(`â³ [Chat: ${chatId}] NOT marking YOUR messages as DELIVERED - recipient is offline`);\r\n      return;\r\n    }\r\n\r\n    const messagesRef = collection(db, \"chats\", chatId, \"messages\");\r\n    const q = query(\r\n      messagesRef,\r\n      where(\"user\", \"==\", currentUserEmail),\r\n      where(\"status\", \"==\", MESSAGE_STATUS.SENT)\r\n    );\r\n    \r\n    const snapshot = await getDocs(q);\r\n    \r\n    if (snapshot.empty) {\r\n      console.log(`âœ“ [Chat: ${chatId}] No SENT messages from you to mark as DELIVERED`);\r\n      return;\r\n    }\r\n\r\n    console.log(`ðŸ“‹ [Chat: ${chatId}] Found ${snapshot.docs.length} messages to update`);\r\n\r\n    const batch = writeBatch(db);\r\n    let updateCount = 0;\r\n    \r\n    snapshot.docs.forEach((document) => {\r\n      // Double-check message belongs to this chat\r\n      if (!verifyMessageInChat(document, chatId)) {\r\n        console.error(`âš ï¸ [Chat: ${chatId}] Skipping message ${document.id} - path mismatch`);\r\n        return;\r\n      }\r\n\r\n      const msgData = document.data();\r\n      console.log(`  ðŸ“ [Chat: ${chatId}] Updating message ${document.id} from ${msgData.user}`);\r\n      \r\n      batch.update(document.ref, {\r\n        status: MESSAGE_STATUS.DELIVERED,\r\n        deliveredAt: serverTimestamp(),\r\n      });\r\n      updateCount++;\r\n    });\r\n\r\n    if (updateCount === 0) {\r\n      console.log(`âš ï¸ [Chat: ${chatId}] No valid messages to update after verification`);\r\n      return;\r\n    }\r\n\r\n    await batch.commit();\r\n    console.log(`âœ… [Chat: ${chatId}] Marked ${updateCount} of YOUR messages as DELIVERED`);\r\n  } catch (error) {\r\n    console.error(`âŒ [Chat: ${chatId}] Error marking YOUR messages as delivered:`, error);\r\n  }\r\n};\r\n\r\n/**\r\n * Mark recipient's messages (FROM recipientEmail) as DELIVERED when you open chat\r\n */\r\nexport const markRecipientMessagesAsDelivered = async (chatId, recipientEmail, currentUserEmail = null) => {\r\n  try {\r\n    if (!chatId || !recipientEmail) {\r\n      console.error(`âŒ markRecipientMessagesAsDelivered: Missing required params`, {\r\n        chatId,\r\n        recipientEmail,\r\n        currentUserEmail\r\n      });\r\n      return;\r\n    }\r\n\r\n    console.log(`ðŸ” [Chat: ${chatId}] Attempting to mark RECIPIENT messages as DELIVERED`);\r\n    console.log(`   Recipient: ${recipientEmail}, Current User: ${currentUserEmail}`);\r\n    \r\n    // âœ… CRITICAL: Verify this is the correct chat\r\n    if (currentUserEmail) {\r\n      const isValidChat = await verifyChatParticipants(chatId, currentUserEmail, recipientEmail);\r\n      if (!isValidChat) {\r\n        console.error(`âŒ [Chat: ${chatId}] Chat validation failed - ABORTING`);\r\n        return;\r\n      }\r\n    }\r\n    \r\n    const messagesRef = collection(db, \"chats\", chatId, \"messages\");\r\n    const q = query(\r\n      messagesRef,\r\n      where(\"user\", \"==\", recipientEmail),\r\n      where(\"status\", \"==\", MESSAGE_STATUS.SENT)\r\n    );\r\n    \r\n    const snapshot = await getDocs(q);\r\n    \r\n    if (snapshot.empty) {\r\n      console.log(`âœ“ [Chat: ${chatId}] No SENT messages from recipient to mark as DELIVERED`);\r\n      return;\r\n    }\r\n\r\n    console.log(`ðŸ“‹ [Chat: ${chatId}] Found ${snapshot.docs.length} messages to update`);\r\n\r\n    const batch = writeBatch(db);\r\n    let updateCount = 0;\r\n    \r\n    snapshot.docs.forEach((document) => {\r\n      if (!verifyMessageInChat(document, chatId)) {\r\n        console.error(`âš ï¸ [Chat: ${chatId}] Skipping message ${document.id} - path mismatch`);\r\n        return;\r\n      }\r\n\r\n      const msgData = document.data();\r\n      console.log(`  ðŸ“ [Chat: ${chatId}] Updating message ${document.id} from ${msgData.user}`);\r\n      \r\n      batch.update(document.ref, {\r\n        status: MESSAGE_STATUS.DELIVERED,\r\n        deliveredAt: serverTimestamp(),\r\n      });\r\n      updateCount++;\r\n    });\r\n\r\n    if (updateCount === 0) {\r\n      console.log(`âš ï¸ [Chat: ${chatId}] No valid messages to update after verification`);\r\n      return;\r\n    }\r\n\r\n    await batch.commit();\r\n    console.log(`âœ… [Chat: ${chatId}] Marked ${updateCount} messages from recipient as DELIVERED`);\r\n  } catch (error) {\r\n    console.error(`âŒ [Chat: ${chatId}] Error marking recipient messages as delivered:`, error);\r\n  }\r\n};\r\n\r\n/**\r\n * Mark recipient's messages (FROM recipientEmail) as READ when you read them\r\n */\r\nexport const markRecipientMessagesAsRead = async (chatId, recipientEmail, currentUserEmail = null) => {\r\n  try {\r\n    if (!chatId || !recipientEmail) {\r\n      console.error(`âŒ markRecipientMessagesAsRead: Missing required params`, {\r\n        chatId,\r\n        recipientEmail,\r\n        currentUserEmail\r\n      });\r\n      return;\r\n    }\r\n\r\n    console.log(`ðŸ” [Chat: ${chatId}] Attempting to mark RECIPIENT messages as READ`);\r\n    console.log(`   Recipient: ${recipientEmail}, Current User: ${currentUserEmail}`);\r\n    \r\n    // âœ… CRITICAL: Verify this is the correct chat\r\n    if (currentUserEmail) {\r\n      const isValidChat = await verifyChatParticipants(chatId, currentUserEmail, recipientEmail);\r\n      if (!isValidChat) {\r\n        console.error(`âŒ [Chat: ${chatId}] Chat validation failed - ABORTING`);\r\n        return;\r\n      }\r\n    }\r\n    \r\n    const messagesRef = collection(db, \"chats\", chatId, \"messages\");\r\n    \r\n    // Get all messages that are not yet read\r\n    const sentQuery = query(\r\n      messagesRef,\r\n      where(\"user\", \"==\", recipientEmail),\r\n      where(\"status\", \"==\", MESSAGE_STATUS.SENT)\r\n    );\r\n    \r\n    const deliveredQuery = query(\r\n      messagesRef,\r\n      where(\"user\", \"==\", recipientEmail),\r\n      where(\"status\", \"==\", MESSAGE_STATUS.DELIVERED)\r\n    );\r\n\r\n    const [sentSnapshot, deliveredSnapshot] = await Promise.all([\r\n      getDocs(sentQuery),\r\n      getDocs(deliveredQuery)\r\n    ]);\r\n\r\n    const allDocs = [...sentSnapshot.docs, ...deliveredSnapshot.docs];\r\n    \r\n    if (allDocs.length === 0) {\r\n      console.log(`âœ“ [Chat: ${chatId}] No unread messages from recipient to mark as READ`);\r\n      return;\r\n    }\r\n\r\n    console.log(`ðŸ“‹ [Chat: ${chatId}] Found ${allDocs.length} messages to update`);\r\n\r\n    const batch = writeBatch(db);\r\n    let updateCount = 0;\r\n    \r\n    allDocs.forEach((document) => {\r\n      if (!verifyMessageInChat(document, chatId)) {\r\n        console.error(`âš ï¸ [Chat: ${chatId}] Skipping message ${document.id} - path mismatch`);\r\n        return;\r\n      }\r\n\r\n      const msgData = document.data();\r\n      console.log(`  ðŸ“ [Chat: ${chatId}] Updating message ${document.id} from ${msgData.user}`);\r\n      \r\n      batch.update(document.ref, {\r\n        status: MESSAGE_STATUS.READ,\r\n        readAt: serverTimestamp(),\r\n      });\r\n      updateCount++;\r\n    });\r\n\r\n    if (updateCount === 0) {\r\n      console.log(`âš ï¸ [Chat: ${chatId}] No valid messages to update after verification`);\r\n      return;\r\n    }\r\n\r\n    await batch.commit();\r\n    console.log(`âœ… [Chat: ${chatId}] Marked ${updateCount} messages from recipient as READ`);\r\n  } catch (error) {\r\n    console.error(`âŒ [Chat: ${chatId}] Error marking recipient messages as read:`, error);\r\n  }\r\n};\r\n\r\n/**\r\n * Mark YOUR messages (sent by currentUser) as READ when recipient has read them\r\n */\r\nexport const markYourMessagesAsRead = async (chatId, currentUserEmail, recipientEmail = null) => {\r\n  try {\r\n    if (!chatId || !currentUserEmail) {\r\n      console.error(`âŒ markYourMessagesAsRead: Missing required params`, {\r\n        chatId,\r\n        currentUserEmail,\r\n        recipientEmail\r\n      });\r\n      return;\r\n    }\r\n\r\n    console.log(`ðŸ” [Chat: ${chatId}] Attempting to mark YOUR messages as READ`);\r\n    console.log(`   Current User: ${currentUserEmail}, Recipient: ${recipientEmail}`);\r\n    \r\n    // âœ… CRITICAL: Verify this is the correct chat\r\n    if (recipientEmail) {\r\n      const isValidChat = await verifyChatParticipants(chatId, currentUserEmail, recipientEmail);\r\n      if (!isValidChat) {\r\n        console.error(`âŒ [Chat: ${chatId}] Chat validation failed - ABORTING`);\r\n        return;\r\n      }\r\n    }\r\n    \r\n    const messagesRef = collection(db, \"chats\", chatId, \"messages\");\r\n    \r\n    const sentQuery = query(\r\n      messagesRef,\r\n      where(\"user\", \"==\", currentUserEmail),\r\n      where(\"status\", \"==\", MESSAGE_STATUS.SENT)\r\n    );\r\n    \r\n    const deliveredQuery = query(\r\n      messagesRef,\r\n      where(\"user\", \"==\", currentUserEmail),\r\n      where(\"status\", \"==\", MESSAGE_STATUS.DELIVERED)\r\n    );\r\n\r\n    const [sentSnapshot, deliveredSnapshot] = await Promise.all([\r\n      getDocs(sentQuery),\r\n      getDocs(deliveredQuery)\r\n    ]);\r\n\r\n    const allDocs = [...sentSnapshot.docs, ...deliveredSnapshot.docs];\r\n    \r\n    if (allDocs.length === 0) {\r\n      console.log(`âœ“ [Chat: ${chatId}] No unread messages from you to update`);\r\n      return;\r\n    }\r\n\r\n    console.log(`ðŸ“‹ [Chat: ${chatId}] Found ${allDocs.length} messages to update`);\r\n\r\n    const batch = writeBatch(db);\r\n    let updateCount = 0;\r\n    \r\n    allDocs.forEach((document) => {\r\n      if (!verifyMessageInChat(document, chatId)) {\r\n        console.error(`âš ï¸ [Chat: ${chatId}] Skipping message ${document.id} - path mismatch`);\r\n        return;\r\n      }\r\n\r\n      const msgData = document.data();\r\n      console.log(`  ðŸ“ [Chat: ${chatId}] Updating message ${document.id} from ${msgData.user}`);\r\n      \r\n      batch.update(document.ref, {\r\n        status: MESSAGE_STATUS.READ,\r\n        readAt: serverTimestamp(),\r\n      });\r\n      updateCount++;\r\n    });\r\n\r\n    if (updateCount === 0) {\r\n      console.log(`âš ï¸ [Chat: ${chatId}] No valid messages to update after verification`);\r\n      return;\r\n    }\r\n\r\n    await batch.commit();\r\n    console.log(`âœ… [Chat: ${chatId}] Marked ${updateCount} of YOUR messages as READ`);\r\n  } catch (error) {\r\n    console.error(`âŒ [Chat: ${chatId}] Error marking YOUR messages as read:`, error);\r\n  }\r\n};\r\n\r\n// Kept for backwards compatibility\r\nexport const markUserMessagesAsDelivered = markRecipientMessagesAsDelivered;\r\nexport const markUserMessagesAsRead = markRecipientMessagesAsRead;\r\n\r\n/**\r\n * Listen to recipient's online status and mark messages as delivered\r\n */\r\nexport const subscribeToRecipientStatus = (recipientEmail, onStatusChange) => {\r\n  if (!recipientEmail) {\r\n    console.error(`âŒ subscribeToRecipientStatus: Missing recipientEmail`);\r\n    return () => {}; // Return empty unsubscribe function\r\n  }\r\n\r\n  const usersRef = collection(db, \"users\");\r\n  const q = query(usersRef, where(\"email\", \"==\", recipientEmail));\r\n  \r\n  const unsubscribe = onSnapshot(q, (snapshot) => {\r\n    if (!snapshot.empty) {\r\n      const recipientData = snapshot.docs[0].data();\r\n      console.log(`ðŸ‘ï¸ Recipient ${recipientEmail} status:`, {\r\n        lastSeen: recipientData.lastSeen?.toDate?.() || recipientData.lastSeen,\r\n      });\r\n      onStatusChange(recipientData);\r\n    }\r\n  }, (error) => {\r\n    console.error(\"âŒ Error subscribing to recipient status:\", error);\r\n  });\r\n\r\n  return unsubscribe;\r\n};"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3841, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/waels/OneDrive/Desktop/Expo%20projects/P3/components/ChatScreen/hooks/useMessageStatus.js"],"sourcesContent":["// components/ChatScreen/hooks/useMessageStatus.js\r\n\r\nimport { useEffect, useCallback, useRef } from \"react\";\r\nimport { useAuthState } from \"react-firebase-hooks/auth\";\r\nimport { auth, db } from \"../../../firebase\";\r\nimport { collection, query, where, onSnapshot } from \"firebase/firestore\";\r\nimport {\r\n  markYourMessagesAsDelivered,\r\n  markRecipientMessagesAsDelivered,\r\n  markRecipientMessagesAsRead,\r\n  markYourMessagesAsRead,\r\n} from \"../utils/messageStatus\";\r\nimport CheckIcon from '@mui/icons-material/Check';\r\nimport DoneAllIcon from '@mui/icons-material/DoneAll';\r\nimport AccessTimeIcon from '@mui/icons-material/AccessTime';\r\nimport ErrorIcon from '@mui/icons-material/Error';\r\nimport { MESSAGE_STATUS } from '../constants';\r\nconst MessageStatus = ({ status, darkMode }) => {\r\n  const getStatusIcon = () => {\r\n    switch (status) {\r\n      case MESSAGE_STATUS.SENDING:\r\n        return <AccessTimeIcon style={{ fontSize: 16, color: darkMode ? '#8696a0' : '#667781' }} />;\r\n      \r\n      case MESSAGE_STATUS.SENT:\r\n        return <CheckIcon style={{ fontSize: 16, color: darkMode ? '#8696a0' : '#667781' }} />;\r\n      \r\n      case MESSAGE_STATUS.DELIVERED:\r\n        return <DoneAllIcon style={{ fontSize: 16, color: darkMode ? '#8696a0' : '#667781' }} />;\r\n      \r\n      case MESSAGE_STATUS.READ:\r\n        return <DoneAllIcon style={{ fontSize: 16, color: '#53bdeb' }} />; // Blue checkmarks\r\n      \r\n      case MESSAGE_STATUS.FAILED:\r\n        return <ErrorIcon style={{ fontSize: 16, color: '#f44336' }} />;\r\n      \r\n      default:\r\n        return <CheckIcon style={{ fontSize: 16, color: darkMode ? '#8696a0' : '#667781' }} />;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <span style={{ display: 'inline-flex', alignItems: 'center', marginRight: 4 }}>\r\n      {getStatusIcon()}\r\n    </span>\r\n  );\r\n};\r\n\r\nexport default MessageStatus;\r\n/**\r\n * Hook to manage WhatsApp-like message status (SENT â†’ DELIVERED â†’ READ)\r\n * \r\n * For YOUR messages:\r\n * - SENT: Message sent\r\n * - DELIVERED: Recipient opened the app (when they go online)\r\n * - READ: Recipient opened the chat and read your message\r\n * \r\n * For RECIPIENT'S messages:\r\n * - SENT: Message sent\r\n * - DELIVERED: You opened the app (immediately when chat opens)\r\n * - READ: You read the message (when chat is visible/focused)\r\n */\r\nexport const useMessageStatus = (chatId, recipientEmail, currentUserEmail, isSelfChat = false) => {\r\n  const [user] = useAuthState(auth);\r\n  const selfChatTimeoutRef = useRef(null); // âœ… NEW: Track timeout\r\n\r\n  // âœ… NEW: Check if all required data is ready\r\n  const isReady = !!(chatId && user && recipientEmail && currentUserEmail);\r\n\r\n // âœ… Mark YOUR messages as DELIVERED when recipient comes online\r\nuseEffect(() => {\r\n  // âœ… CRITICAL: Don't run if data is not ready\r\n  if (!isReady) {\r\n    console.log(`â³ [Chat: ${chatId}] Waiting for data before setting up online listener...`);\r\n    return;\r\n  }\r\n\r\n  if (isSelfChat) {\r\n    console.log(`â­ï¸ [Chat: ${chatId}] Skipping YOUR DELIVERED update - self-chat`);\r\n    return;\r\n  }\r\n\r\n  // Sanity check: Don't monitor yourself\r\n  if (currentUserEmail === recipientEmail) {\r\n    console.warn(`âš ï¸ [Chat: ${chatId}] Skipping online listener - userEmail matches recipientEmail`);\r\n    return;\r\n  }\r\n\r\n  console.log(`ðŸ‘ï¸ [Chat: ${chatId}] Listening for ${recipientEmail} to come online...`);\r\n  console.log(`   Your messages from: ${currentUserEmail}`);\r\n\r\n  // âœ… CRITICAL: Capture current values to avoid stale closures\r\n  const currentChatId = chatId;\r\n  const currentRecipient = recipientEmail;\r\n  const currentUser = currentUserEmail;\r\n\r\n  // Set up real-time listener for recipient's online status\r\n  const usersRef = collection(db, \"users\");\r\n  const q = query(usersRef, where(\"email\", \"==\", currentRecipient));\r\n\r\n  const unsubscribe = onSnapshot(\r\n    q,\r\n    async (snapshot) => {\r\n      // âœ… Prevent running if chat has changed (stale listener)\r\n      if (chatId !== currentChatId) {\r\n        console.log(\r\n          `âš ï¸ [OLD Chat: ${currentChatId}] Ignoring stale listener callback - current chat is ${chatId}`\r\n        );\r\n        return;\r\n      }\r\n\r\n      if (snapshot.empty) {\r\n        console.log(`â“ [Chat: ${currentChatId}] Recipient ${currentRecipient} not found in users collection`);\r\n        return;\r\n      }\r\n\r\n      const recipientData = snapshot.docs[0].data();\r\n      const lastSeen = recipientData.lastSeen?.toDate?.() || new Date(recipientData.lastSeen);\r\n      const now = new Date();\r\n      const secondsAgo = (now - lastSeen) / 1000;\r\n\r\n      if (secondsAgo < 30) {\r\n        console.log(`ðŸŸ¢ [Chat: ${currentChatId}] RECIPIENT CAME ONLINE! (${Math.round(secondsAgo)}s ago)`);\r\n        console.log(`   Updating YOUR messages from ${currentUser} to DELIVERED`);\r\n        await markYourMessagesAsDelivered(currentChatId, currentRecipient, currentUser);\r\n      } else {\r\n        console.log(`ðŸ”´ [Chat: ${currentChatId}] Recipient offline (${Math.round(secondsAgo)}s ago)`);\r\n      }\r\n    },\r\n    (error) => {\r\n      console.error(`âŒ [Chat: ${currentChatId}] Error listening to recipient status:`, error);\r\n    }\r\n  );\r\n\r\n  return () => {\r\n    console.log(`ðŸ”Œ [Chat: ${currentChatId}] Stopping recipient status listener for ${currentRecipient}`);\r\n    unsubscribe();\r\n  };\r\n}, [chatId, recipientEmail, currentUserEmail, isSelfChat, isReady]);\r\n\r\n};"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 4034, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/waels/OneDrive/Desktop/Expo%20projects/P3/components/ChatScreen/hooks/useDisplayName.js"],"sourcesContent":["// components/ChatScreen/hooks/useDisplayName.js\r\nimport { useState, useEffect } from \"react\";\r\nimport { doc, onSnapshot } from \"firebase/firestore\";\r\nimport { db } from \"../../../firebase\";\r\n\r\nexport const useDisplayName = (userId, recipientEmail) => {\r\n  const [displayName, setDisplayName] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    if (!userId || !recipientEmail) {\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    console.log(`ðŸ‘€ Watching display name for: users/${userId}/contacts/${recipientEmail}`);\r\n\r\n    const contactRef = doc(db, \"users\", userId, \"contacts\", recipientEmail);\r\n    \r\n    const unsubscribe = onSnapshot(\r\n      contactRef,\r\n      (snapshot) => {\r\n        if (snapshot.exists()) {\r\n          const customName = snapshot.data().displayName;\r\n          console.log(`âœ… Display name found:`, customName);\r\n          setDisplayName(customName);\r\n        } else {\r\n          console.log(`â„¹ï¸ No custom display name set`);\r\n          setDisplayName(null);\r\n        }\r\n        setLoading(false);\r\n      },\r\n      (error) => {\r\n        console.error(\"âŒ Error fetching display name:\", error);\r\n        setDisplayName(null);\r\n        setLoading(false);\r\n      }\r\n    );\r\n\r\n    return () => {\r\n      console.log(`ðŸ”Œ Unsubscribing from display name listener`);\r\n      unsubscribe();\r\n    };\r\n  }, [userId, recipientEmail]);\r\n\r\n  return { displayName, loading };\r\n};"],"names":[],"mappings":"AAAA,gDAAgD;;;;;AAChD;AACA;AACA;;;;;;;;;AAEO,MAAM,iBAAiB,CAAC,QAAQ;IACrC,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,+GAAQ,EAAC;IAC/C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,+GAAQ,EAAC;IAEvC,IAAA,gHAAS,EAAC;QACR,IAAI,CAAC,UAAU,CAAC,gBAAgB;YAC9B,WAAW;YACX;QACF;QAEA,QAAQ,GAAG,CAAC,CAAC,oCAAoC,EAAE,OAAO,UAAU,EAAE,gBAAgB;QAEtF,MAAM,aAAa,IAAA,iJAAG,EAAC,uHAAE,EAAE,SAAS,QAAQ,YAAY;QAExD,MAAM,cAAc,IAAA,wJAAU,EAC5B,YACA,CAAC;YACC,IAAI,SAAS,MAAM,IAAI;gBACrB,MAAM,aAAa,SAAS,IAAI,GAAG,WAAW;gBAC9C,QAAQ,GAAG,CAAC,CAAC,qBAAqB,CAAC,EAAE;gBACrC,eAAe;YACjB,OAAO;gBACL,QAAQ,GAAG,CAAC,CAAC,6BAA6B,CAAC;gBAC3C,eAAe;YACjB;YACA,WAAW;QACb,GACA,CAAC;YACC,QAAQ,KAAK,CAAC,kCAAkC;YAChD,eAAe;YACf,WAAW;QACb;QAGF,OAAO;YACL,QAAQ,GAAG,CAAC,CAAC,2CAA2C,CAAC;YACzD;QACF;IACF,GAAG;QAAC;QAAQ;KAAe;IAE3B,OAAO;QAAE;QAAa;IAAQ;AAChC","debugId":null}},
    {"offset": {"line": 4099, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/waels/OneDrive/Desktop/Expo%20projects/P3/components/ChatScreen/components/ChatHeader.jsx"],"sourcesContent":["// components/ChatScreen/components/ChatHeader.jsx\r\nimport React from \"react\";\r\nimport styled from \"styled-components\";\r\nimport { Avatar, IconButton } from \"@mui/material\";\r\nimport MoreVertIcon from \"@mui/icons-material/MoreVert\";\r\nimport MenuIcon from \"@mui/icons-material/Menu\";\r\nimport TimeAgo from \"timeago-react\";\r\n\r\nfunction ChatHeader({\r\n  recipient,\r\n  recipientEmail,\r\n  recipientSnapshot,\r\n  isSelfChat,\r\n  customDisplayName,\r\n  onMoreClick,\r\n  darkMode,\r\n  isMobile,\r\n  onToggleSidebar,\r\n}) {\r\n  const getHeaderTitle = () => {\r\n    if (isSelfChat) {\r\n      return `${recipientEmail} (You)`;\r\n    }\r\n    // Use custom display name if available\r\n    if (customDisplayName) {\r\n      return customDisplayName;\r\n    }\r\n    return recipientEmail;\r\n  };\r\n\r\n  const getStatusText = () => {\r\n    if (isSelfChat) {\r\n      return \"Message yourself\";\r\n    }\r\n    \r\n    if (recipient?.lastSeen?.toDate) {\r\n      return (\r\n        <>\r\n          Last active: <TimeAgo datetime={recipient.lastSeen.toDate()} />\r\n        </>\r\n      );\r\n    }\r\n    \r\n    return \"Loading...\";\r\n  };\r\n\r\n  return (\r\n    <Header darkMode={darkMode}>\r\n      <HeaderLeft>\r\n        {isMobile && (\r\n          <IconButton onClick={onToggleSidebar} style={{ marginRight: '10px' }}>\r\n            <MenuIcon style={{ color: darkMode ? 'gray' : 'inherit' }}/>\r\n          </IconButton>\r\n        )}\r\n        {recipient ? (\r\n          <UserAvatar src={recipientSnapshot?.docs?.[0]?.data()?.photoURL} />\r\n        ) : (\r\n          <UserAvatar>{recipientEmail?.[0]?.toUpperCase()}</UserAvatar>\r\n        )}\r\n        <HeaderInformation darkMode={darkMode}>\r\n          <h3>{getHeaderTitle()}</h3>\r\n          <p>{getStatusText()}</p>\r\n        </HeaderInformation>\r\n      </HeaderLeft>\r\n      <HeaderActions>\r\n        <IconButton onClick={onMoreClick}>\r\n          <MoreVertIcon style={{ color: darkMode ? 'gray' : 'inherit' }} />\r\n        </IconButton>\r\n      </HeaderActions>\r\n    </Header>\r\n  );\r\n}\r\n\r\nexport default ChatHeader;\r\n\r\n// Styled Components remain the same...\r\nconst Header = styled.div`\r\n  position: sticky;\r\n  background-color: ${(props) => (props.darkMode ? \"#1e1e1e\" : \"white\")};\r\n  z-index: 100;\r\n  top: 0;\r\n  display: flex;\r\n  padding: 11px;\r\n  height: 80px;\r\n  align-items: center;\r\n  border-bottom: 1px solid ${(props) => (props.darkMode ? \"#333\" : \"whitesmoke\")};\r\n  justify-content: space-between;\r\n`;\r\n\r\nconst HeaderLeft = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  flex: 1;\r\n  min-width: 0;\r\n`;\r\n\r\nconst UserAvatar = styled(Avatar)`\r\n  margin: 5px;\r\n  margin-right: 15px;\r\n  flex-shrink: 0;\r\n`;\r\n\r\nconst HeaderInformation = styled.div`\r\n  margin-left: 15px;\r\n  flex: 1;\r\n  min-width: 0;\r\n\r\n  > h3 {\r\n    margin: 0;\r\n    margin-bottom: 3px;\r\n    color: ${(props) => (props.darkMode ? \"#e0e0e0\" : \"#000\")};\r\n    font-size: 16px;\r\n    font-weight: 500;\r\n    white-space: nowrap;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n  }\r\n\r\n  > p {\r\n    font-size: 13px;\r\n    color: ${(props) => (props.darkMode ? \"#888\" : \"gray\")};\r\n    margin: 0;\r\n    white-space: nowrap;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n  }\r\n\r\n  @media (max-width: 480px) {\r\n    margin-left: 10px;\r\n\r\n    > h3 {\r\n      font-size: 15px;\r\n    }\r\n\r\n    > p {\r\n      font-size: 12px;\r\n    }\r\n  }\r\n`;\r\n\r\nconst HeaderActions = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  flex-shrink: 0;\r\n`;"],"names":[],"mappings":"AAAA,kDAAkD;;;;;;AAClD;AACA;AACA;AAAA;AACA;AACA;AACA;;;;;;;;AAEA,SAAS,WAAW,EAClB,SAAS,EACT,cAAc,EACd,iBAAiB,EACjB,UAAU,EACV,iBAAiB,EACjB,WAAW,EACX,QAAQ,EACR,QAAQ,EACR,eAAe,EAChB;IACC,MAAM,iBAAiB;QACrB,IAAI,YAAY;YACd,OAAO,GAAG,eAAe,MAAM,CAAC;QAClC;QACA,uCAAuC;QACvC,IAAI,mBAAmB;YACrB,OAAO;QACT;QACA,OAAO;IACT;IAEA,MAAM,gBAAgB;QACpB,IAAI,YAAY;YACd,OAAO;QACT;QAEA,IAAI,WAAW,UAAU,QAAQ;YAC/B,qBACE;;oBAAE;kCACa,qKAAC,oIAAO;wBAAC,UAAU,UAAU,QAAQ,CAAC,MAAM;;;;;;;;QAG/D;QAEA,OAAO;IACT;IAEA,qBACE,qKAAC;QAAO,UAAU;;0BAChB,qKAAC;;oBACE,0BACC,qKAAC,6MAAU;wBAAC,SAAS;wBAAiB,OAAO;4BAAE,aAAa;wBAAO;kCACjE,cAAA,qKAAC,sJAAQ;4BAAC,OAAO;gCAAE,OAAO,WAAW,SAAS;4BAAU;;;;;;;;;;;oBAG3D,0BACC,qKAAC;wBAAW,KAAK,mBAAmB,MAAM,CAAC,EAAE,EAAE,QAAQ;;;;;6CAEvD,qKAAC;kCAAY,gBAAgB,CAAC,EAAE,EAAE;;;;;;kCAEpC,qKAAC;wBAAkB,UAAU;;0CAC3B,qKAAC;0CAAI;;;;;;0CACL,qKAAC;0CAAG;;;;;;;;;;;;;;;;;;0BAGR,qKAAC;0BACC,cAAA,qKAAC,6MAAU;oBAAC,SAAS;8BACnB,cAAA,qKAAC,0JAAY;wBAAC,OAAO;4BAAE,OAAO,WAAW,SAAS;wBAAU;;;;;;;;;;;;;;;;;;;;;;AAKtE;uCAEe;AAEf,uCAAuC;AACvC,MAAM,SAAS,4IAAM,CAAC,GAAG,CAAC;;oBAEN,EAAE,CAAC,QAAW,MAAM,QAAQ,GAAG,YAAY,QAAS;;;;;;;2BAO7C,EAAE,CAAC,QAAW,MAAM,QAAQ,GAAG,SAAS,aAAc;;AAEjF,CAAC;AAED,MAAM,aAAa,4IAAM,CAAC,GAAG,CAAC;;;;;AAK9B,CAAC;AAED,MAAM,aAAa,IAAA,4IAAM,EAAC,6LAAM,CAAC,CAAC;;;;AAIlC,CAAC;AAED,MAAM,oBAAoB,4IAAM,CAAC,GAAG,CAAC;;;;;;;;WAQ1B,EAAE,CAAC,QAAW,MAAM,QAAQ,GAAG,YAAY,OAAQ;;;;;;;;;;WAUnD,EAAE,CAAC,QAAW,MAAM,QAAQ,GAAG,SAAS,OAAQ;;;;;;;;;;;;;;;;;;AAkB3D,CAAC;AAED,MAAM,gBAAgB,4IAAM,CAAC,GAAG,CAAC;;;;AAIjC,CAAC","debugId":null}},
    {"offset": {"line": 4324, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/waels/OneDrive/Desktop/Expo%20projects/P3/components/Message.js"],"sourcesContent":["// components/Message.jsx\r\nimport { useAuthState } from \"react-firebase-hooks/auth\";\r\nimport { auth, db } from \"../firebase\";\r\nimport styled from \"styled-components\";\r\nimport moment from \"moment\";\r\nimport { IconButton, Menu, MenuItem, ListItemIcon, ListItemText } from \"@mui/material\";\r\nimport DownloadIcon from \"@mui/icons-material/Download\";\r\nimport InsertDriveFileIcon from \"@mui/icons-material/InsertDriveFile\";\r\nimport ImageIcon from \"@mui/icons-material/Image\";\r\nimport VideoLibraryIcon from \"@mui/icons-material/VideoLibrary\";\r\nimport AudiotrackIcon from \"@mui/icons-material/Audiotrack\";\r\nimport MoreVertIcon from \"@mui/icons-material/MoreVert\";\r\nimport DeleteIcon from \"@mui/icons-material/Delete\";\r\nimport ReplyIcon from \"@mui/icons-material/Reply\";\r\nimport LocationOnIcon from \"@mui/icons-material/LocationOn\";\r\nimport OpenInNewIcon from \"@mui/icons-material/OpenInNew\";\r\nimport PollIcon from \"@mui/icons-material/Poll\";\r\nimport CheckCircleIcon from \"@mui/icons-material/CheckCircle\";\r\nimport RadioButtonUncheckedIcon from \"@mui/icons-material/RadioButtonUnchecked\";\r\nimport CheckBoxOutlineBlankIcon from \"@mui/icons-material/CheckBoxOutlineBlank\";\r\nimport CheckBoxIcon from \"@mui/icons-material/CheckBox\";\r\nimport { useContext, useState } from \"react\";\r\nimport { useRouter } from \"next/router\";\r\nimport { doc, updateDoc, arrayUnion, arrayRemove } from \"firebase/firestore\";\r\nimport { DarkModeContext } from \"./DarkModeProvider\";\r\nimport MessageStatus from \"./ChatScreen/components/MessageStatus\";\r\nimport { MESSAGE_STATUS } from \"./ChatScreen/constants\";\r\n\r\nfunction Message({ user, message, messageId, onDelete, onReply }) {\r\n  const [userLoggedIn] = useAuthState(auth);\r\n  const router = useRouter();\r\n  const [imageLoaded, setImageLoaded] = useState(false);\r\n  const [imageError, setImageError] = useState(false);\r\n  const [anchorEl, setAnchorEl] = useState(null);\r\n  const [votingInProgress, setVotingInProgress] = useState(false);\r\n\r\n  // Get dark mode context\r\n  const darkModeContext = useContext(DarkModeContext);\r\n  const { darkMode } = darkModeContext || { darkMode: false };\r\n\r\n  const TypeOfMessage = user === userLoggedIn?.email ? Sender : Receiver;\r\n  const isOwnMessage = user === userLoggedIn?.email;\r\n\r\n  // Check if message is less than 1 hour old\r\n  const isRecentMessage = () => {\r\n    if (!message.timestamp) return false;\r\n    const messageTime = moment(message.timestamp);\r\n    const now = moment();\r\n    const hoursDiff = now.diff(messageTime, 'hours');\r\n    return hoursDiff < 1;\r\n  };\r\n\r\n  // Open menu\r\n  const handleMenuOpen = (event) => {\r\n    event.stopPropagation();\r\n    setAnchorEl(event.currentTarget);\r\n  };\r\n\r\n  // Close menu\r\n  const handleMenuClose = () => {\r\n    setAnchorEl(null);\r\n  };\r\n\r\n  // Handle delete\r\n  const handleDelete = () => {\r\n    handleMenuClose();\r\n    if (onDelete && messageId) {\r\n      onDelete(messageId);\r\n    }\r\n  };\r\n\r\n  // Handle reply\r\n  const handleReply = () => {\r\n    handleMenuClose();\r\n    if (onReply) {\r\n      onReply({\r\n        id: messageId,\r\n        user: user,\r\n        message: message.message || (message.poll ? `ðŸ“Š ${message.poll.question}` : ''),\r\n        timestamp: message.timestamp,\r\n        fileURL: message.fileURL,\r\n        fileName: message.fileName,\r\n        fileType: message.fileType,\r\n        voiceURL: message.voiceURL,\r\n        voiceDuration: message.voiceDuration,\r\n        location: message.location,\r\n        poll: message.poll,\r\n      });\r\n    }\r\n  };\r\n\r\n  // Handle poll vote\r\n  const handlePollVote = async (optionIndex) => {\r\n    if (!messageId || votingInProgress || !router.query.id) return;\r\n    \r\n    setVotingInProgress(true);\r\n    try {\r\n      const messageRef = doc(db, \"chats\", router.query.id, \"messages\", messageId);\r\n      const currentVotes = message.poll.options[optionIndex].votes || [];\r\n      const hasVoted = currentVotes.includes(userLoggedIn.email);\r\n      \r\n      // For single answer polls, remove votes from all options first\r\n      if (!message.poll.allowMultipleAnswers && !hasVoted) {\r\n        const updates = {};\r\n        message.poll.options.forEach((option, idx) => {\r\n          if (option.votes?.includes(userLoggedIn.email)) {\r\n            updates[`poll.options.${idx}.votes`] = arrayRemove(userLoggedIn.email);\r\n          }\r\n        });\r\n        \r\n        if (Object.keys(updates).length > 0) {\r\n          await updateDoc(messageRef, updates);\r\n        }\r\n      }\r\n      \r\n      // Toggle vote for the selected option\r\n      await updateDoc(messageRef, {\r\n        [`poll.options.${optionIndex}.votes`]: hasVoted \r\n          ? arrayRemove(userLoggedIn.email)\r\n          : arrayUnion(userLoggedIn.email)\r\n      });\r\n    } catch (error) {\r\n      console.error(\"Error voting on poll:\", error);\r\n    } finally {\r\n      setVotingInProgress(false);\r\n    }\r\n  };\r\n\r\n  // Optimize Cloudinary image URLs with transformations\r\n  const getOptimizedImageUrl = (url) => {\r\n    if (!url || !url.includes('cloudinary.com')) return url;\r\n    const transformation = '/w_600,h_600,c_limit,f_auto,q_auto';\r\n    return url.replace('/upload/', `/upload${transformation}/`);\r\n  };\r\n\r\n  // Get thumbnail for video\r\n  const getVideoThumbnail = (url) => {\r\n    if (!url || !url.includes('cloudinary.com')) return null;\r\n    const transformation = '/w_600,h_400,c_fill,f_jpg,q_auto';\r\n    return url.replace('/upload/', `/upload${transformation}/`).replace(/\\.[^.]+$/, '.jpg');\r\n  };\r\n\r\n  // Download file function with better Cloudinary support\r\n  const downloadFile = async (url, fileName) => {\r\n    try {\r\n      let downloadUrl = url;\r\n      if (url.includes('cloudinary.com')) {\r\n        downloadUrl = url.replace('/upload/', '/upload/fl_attachment/');\r\n      }\r\n\r\n      const response = await fetch(downloadUrl);\r\n      const blob = await response.blob();\r\n      const blobUrl = window.URL.createObjectURL(blob);\r\n      \r\n      const link = document.createElement(\"a\");\r\n      link.href = blobUrl;\r\n      link.download = fileName || \"download\";\r\n      document.body.appendChild(link);\r\n      link.click();\r\n      document.body.removeChild(link);\r\n      \r\n      setTimeout(() => window.URL.revokeObjectURL(blobUrl), 100);\r\n    } catch (error) {\r\n      console.error(\"Download failed:\", error);\r\n      window.open(url, '_blank');\r\n    }\r\n  };\r\n\r\n  // Format file size\r\n  const formatFileSize = (bytes) => {\r\n    if (!bytes || bytes === 0) return \"Unknown size\";\r\n    const k = 1024;\r\n    const sizes = [\"Bytes\", \"KB\", \"MB\", \"GB\"];\r\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\r\n    return Math.round((bytes / Math.pow(k, i)) * 100) / 100 + \" \" + sizes[i];\r\n  };\r\n\r\n  // Format voice duration\r\n  const formatDuration = (seconds) => {\r\n    if (!seconds) return \"0:00\";\r\n    const mins = Math.floor(seconds / 60);\r\n    const secs = seconds % 60;\r\n    return `${mins}:${secs.toString().padStart(2, \"0\")}`;\r\n  };\r\n\r\n  // Get file type icon and color\r\n  const getFileIcon = (fileType) => {\r\n    if (!fileType) return { icon: InsertDriveFileIcon, color: darkMode ? '#64b5f6' : '#1976d2' };\r\n    \r\n    if (fileType.includes('pdf')) return { icon: InsertDriveFileIcon, color: '#d32f2f' };\r\n    if (fileType.includes('word') || fileType.includes('document')) return { icon: InsertDriveFileIcon, color: '#2196f3' };\r\n    if (fileType.includes('sheet') || fileType.includes('excel')) return { icon: InsertDriveFileIcon, color: '#4caf50' };\r\n    if (fileType.includes('zip') || fileType.includes('rar')) return { icon: InsertDriveFileIcon, color: '#ff9800' };\r\n    \r\n    return { icon: InsertDriveFileIcon, color: darkMode ? '#64b5f6' : '#1976d2' };\r\n  };\r\n\r\n  const fileIconData = getFileIcon(message.fileType);\r\n  const FileIconComponent = fileIconData.icon;\r\n  const showDelete = isRecentMessage();\r\n\r\n  return (\r\n    <Container>\r\n      <TypeOfMessage darkMode={darkMode} isSender={isOwnMessage}>\r\n        <MessageContent>\r\n          {/* Reply Preview (if this message is a reply) */}\r\n          {message.replyTo && (\r\n            <ReplyPreview darkMode={darkMode}>\r\n              <ReplyBar isSender={isOwnMessage} />\r\n              <ReplyContent>\r\n                <ReplyUser darkMode={darkMode}>\r\n                  {message.replyTo.user === userLoggedIn?.email ? 'You' : message.replyTo.user}\r\n                </ReplyUser>\r\n                <ReplyText darkMode={darkMode}>\r\n                  {message.replyTo.location ? 'ðŸ“ Location' : \r\n                   message.replyTo.poll ? `ðŸ“Š ${message.replyTo.poll.question}` :\r\n                   message.replyTo.message || message.replyTo.fileName || 'ðŸŽ¤ Voice message'}\r\n                </ReplyText>\r\n              </ReplyContent>\r\n            </ReplyPreview>\r\n          )}\r\n\r\n          {/* Poll Message */}\r\n          {message.poll && (\r\n            <PollContainer darkMode={darkMode}>\r\n              <PollHeader darkMode={darkMode}>\r\n                <PollIcon style={{ fontSize: 20, marginRight: 8 }} />\r\n                <PollQuestion>{message.poll.question}</PollQuestion>\r\n              </PollHeader>\r\n\r\n              <PollOptions>\r\n                {message.poll.options.map((option, index) => {\r\n                  const totalVotes = message.poll.options.reduce(\r\n                    (sum, opt) => sum + (opt.votes?.length || 0),\r\n                    0\r\n                  );\r\n                  const optionVotes = option.votes?.length || 0;\r\n                  const percentage = totalVotes > 0 ? (optionVotes / totalVotes) * 100 : 0;\r\n                  const hasVoted = option.votes?.includes(userLoggedIn?.email);\r\n                  const hasVotedAnywhere = message.poll.options.some(opt => \r\n                    opt.votes?.includes(userLoggedIn?.email)\r\n                  );\r\n\r\n                  return (\r\n                    <PollOption\r\n                      key={index}\r\n                      onClick={() => handlePollVote(index)}\r\n                      darkMode={darkMode}\r\n                      hasVoted={hasVoted}\r\n                      disabled={votingInProgress}\r\n                    >\r\n                      <PollOptionContent>\r\n                        <PollOptionIcon>\r\n                          {message.poll.allowMultipleAnswers ? (\r\n                            hasVoted ? (\r\n                              <CheckBoxIcon \r\n                                style={{ \r\n                                  color: darkMode ? \"#00a884\" : \"#25d366\",\r\n                                  fontSize: 20 \r\n                                }} \r\n                              />\r\n                            ) : (\r\n                              <CheckBoxOutlineBlankIcon \r\n                                style={{ \r\n                                  color: darkMode ? \"#8696a0\" : \"#667781\",\r\n                                  fontSize: 20 \r\n                                }} \r\n                              />\r\n                            )\r\n                          ) : (\r\n                            hasVoted ? (\r\n                              <CheckCircleIcon \r\n                                style={{ \r\n                                  color: darkMode ? \"#00a884\" : \"#25d366\",\r\n                                  fontSize: 20 \r\n                                }} \r\n                              />\r\n                            ) : (\r\n                              <RadioButtonUncheckedIcon \r\n                                style={{ \r\n                                  color: darkMode ? \"#8696a0\" : \"#667781\",\r\n                                  fontSize: 20 \r\n                                }} \r\n                              />\r\n                            )\r\n                          )}\r\n                        </PollOptionIcon>\r\n                        \r\n                        <PollOptionText darkMode={darkMode} hasVoted={hasVoted}>\r\n                          {option.text}\r\n                        </PollOptionText>\r\n\r\n                        {hasVotedAnywhere && (\r\n                          <PollOptionVotes darkMode={darkMode}>\r\n                            {optionVotes} {optionVotes === 1 ? 'vote' : 'votes'}\r\n                          </PollOptionVotes>\r\n                        )}\r\n                      </PollOptionContent>\r\n\r\n                      {hasVotedAnywhere && (\r\n                        <PollProgressBar darkMode={darkMode}>\r\n                          <PollProgressFill \r\n                            percentage={percentage} \r\n                            darkMode={darkMode}\r\n                            hasVoted={hasVoted}\r\n                          />\r\n                        </PollProgressBar>\r\n                      )}\r\n                    </PollOption>\r\n                  );\r\n                })}\r\n              </PollOptions>\r\n\r\n              <PollFooter darkMode={darkMode}>\r\n                {message.poll.allowMultipleAnswers && (\r\n                  <PollInfo>Multiple answers allowed</PollInfo>\r\n                )}\r\n                <PollTotalVotes darkMode={darkMode}>\r\n                  {(() => {\r\n                    const totalVotes = message.poll.options.reduce(\r\n                      (sum, opt) => sum + (opt.votes?.length || 0),\r\n                      0\r\n                    );\r\n                    return `${totalVotes} ${totalVotes === 1 ? 'vote' : 'votes'}`;\r\n                  })()}\r\n                </PollTotalVotes>\r\n              </PollFooter>\r\n            </PollContainer>\r\n          )}\r\n\r\n          {/* Location Message */}\r\n          {message.location && (\r\n            <LocationContainer darkMode={darkMode}>\r\n              <MapPreview>\r\n                <MapFrame\r\n                  src={`https://www.openstreetmap.org/export/embed.html?bbox=${message.location.longitude - 0.005},${message.location.latitude - 0.005},${message.location.longitude + 0.005},${message.location.latitude + 0.005}&layer=mapnik&marker=${message.location.latitude},${message.location.longitude}`}\r\n                  title=\"Location\"\r\n                  loading=\"lazy\"\r\n                />\r\n              </MapPreview>\r\n              \r\n              <LocationInfo darkMode={darkMode}>\r\n                <LocationIcon>\r\n                  <LocationOnIcon style={{ fontSize: 20, color: \"#f44336\" }} />\r\n                </LocationIcon>\r\n                <Coordinates darkMode={darkMode}>\r\n                  {message.location.latitude.toFixed(6)}, {message.location.longitude.toFixed(6)}\r\n                </Coordinates>\r\n              </LocationInfo>\r\n\r\n              <ViewButton \r\n                href={message.location.url} \r\n                target=\"_blank\" \r\n                rel=\"noopener noreferrer\" \r\n                darkMode={darkMode}\r\n              >\r\n                <OpenInNewIcon style={{ fontSize: 16, marginRight: 4 }} />\r\n                View on Maps\r\n              </ViewButton>\r\n            </LocationContainer>\r\n          )}\r\n\r\n          {/* File Attachment */}\r\n          {message.fileURL && (\r\n            <FileAttachment>\r\n              {/* Image Preview */}\r\n              {message.fileType?.startsWith(\"image/\") ? (\r\n                <ImageContainer>\r\n                  {!imageLoaded && !imageError && (\r\n                    <ImagePlaceholder darkMode={darkMode}>\r\n                      <ImageIcon style={{ fontSize: 48, color: darkMode ? '#555' : '#ccc' }} />\r\n                    </ImagePlaceholder>\r\n                  )}\r\n                  {imageError ? (\r\n                    <ImageError darkMode={darkMode}>\r\n                      <ImageIcon style={{ fontSize: 48, color: darkMode ? '#666' : '#999' }} />\r\n                      <p>Failed to load image</p>\r\n                    </ImageError>\r\n                  ) : (\r\n                    <ImagePreview\r\n                      src={getOptimizedImageUrl(message.fileURL)}\r\n                      alt={message.fileName || \"Image\"}\r\n                      onClick={() => window.open(message.fileURL, \"_blank\")}\r\n                      onLoad={() => setImageLoaded(true)}\r\n                      onError={() => setImageError(true)}\r\n                      loading=\"lazy\"\r\n                      style={{ display: imageLoaded ? 'block' : 'none' }}\r\n                    />\r\n                  )}\r\n                  {message.fileName && (\r\n                    <ImageFileName darkMode={darkMode}>{message.fileName}</ImageFileName>\r\n                  )}\r\n                </ImageContainer>\r\n              ) : message.fileType?.startsWith(\"video/\") ? (\r\n                /* Video Preview */\r\n                <VideoContainer>\r\n                  <VideoPreview \r\n                    controls \r\n                    preload=\"metadata\"\r\n                    poster={getVideoThumbnail(message.fileURL)}\r\n                  >\r\n                    <source src={message.fileURL} type={message.fileType} />\r\n                    Your browser does not support the video tag.\r\n                  </VideoPreview>\r\n                  {message.fileName && (\r\n                    <VideoFileName darkMode={darkMode}>\r\n                      <VideoLibraryIcon style={{ fontSize: 16, marginRight: 4 }} />\r\n                      {message.fileName}\r\n                    </VideoFileName>\r\n                  )}\r\n                </VideoContainer>\r\n              ) : message.fileType?.startsWith(\"audio/\") && !message.voiceURL ? (\r\n                /* Audio File (not voice message) */\r\n                <AudioFileContainer darkMode={darkMode}>\r\n                  <AudioFileHeader>\r\n                    <AudiotrackIcon style={{ fontSize: 32, color: darkMode ? '#64b5f6' : '#1976d2' }} />\r\n                    <AudioFileInfo>\r\n                      <AudioFileName darkMode={darkMode}>\r\n                        {message.fileName || \"Audio File\"}\r\n                      </AudioFileName>\r\n                      <AudioFileSize darkMode={darkMode}>\r\n                        {formatFileSize(message.fileSize)}\r\n                      </AudioFileSize>\r\n                    </AudioFileInfo>\r\n                  </AudioFileHeader>\r\n                  <AudioPlayer controls src={message.fileURL} darkMode={darkMode}>\r\n                    Your browser does not support the audio element.\r\n                  </AudioPlayer>\r\n                </AudioFileContainer>\r\n              ) : (\r\n                /* Other Files (PDF, Documents, etc.) */\r\n                <FileInfo darkMode={darkMode}>\r\n                  <FileIconComponent style={{ fontSize: 40, color: fileIconData.color }} />\r\n                  <FileDetails>\r\n                    <FileName darkMode={darkMode}>{message.fileName || \"File\"}</FileName>\r\n                    <FileSize darkMode={darkMode}>\r\n                      {formatFileSize(message.fileSize)}\r\n                    </FileSize>\r\n                  </FileDetails>\r\n                </FileInfo>\r\n              )}\r\n\r\n              {/* Download Button */}\r\n              <DownloadButton\r\n                onClick={() => downloadFile(message.fileURL, message.fileName)}\r\n                size=\"small\"\r\n                darkMode={darkMode}\r\n              >\r\n                <DownloadIcon fontSize=\"small\" />\r\n                <span style={{ marginLeft: 5, fontSize: 12 }}>Download</span>\r\n              </DownloadButton>\r\n            </FileAttachment>\r\n          )}\r\n\r\n          {/* Voice Message */}\r\n          {message.voiceURL && (\r\n            <VoiceMessageContainer darkMode={darkMode}>\r\n              <VoiceLabel darkMode={darkMode}>ðŸŽ¤ Voice Message</VoiceLabel>\r\n              <AudioPlayer controls src={message.voiceURL} darkMode={darkMode}>\r\n                Your browser does not support the audio element.\r\n              </AudioPlayer>\r\n              {message.voiceDuration && (\r\n                <VoiceDuration darkMode={darkMode}>\r\n                  Duration: {formatDuration(message.voiceDuration)}\r\n                </VoiceDuration>\r\n              )}\r\n            </VoiceMessageContainer>\r\n          )}\r\n\r\n          {/* Text Message */}\r\n          {message.message && message.message.trim() && !message.location && !message.poll && (\r\n            <MessageText darkMode={darkMode}>{message.message}</MessageText>\r\n          )}\r\n\r\n          {/* Message Footer with Timestamp and Status */}\r\n          <MessageFooter>\r\n            <Timestamp darkMode={darkMode}>\r\n              {message.timestamp ? moment(message.timestamp).format(\"LT\") : \"...\"}\r\n            </Timestamp>\r\n            {isOwnMessage && (\r\n              <MessageStatus \r\n                status={message.status || MESSAGE_STATUS.SENT} \r\n                darkMode={darkMode} \r\n              />\r\n            )}\r\n          </MessageFooter>\r\n        </MessageContent>\r\n\r\n        {/* Three Dots Menu */}\r\n        <MessageActions>\r\n          <MessageMenuButton\r\n            onClick={handleMenuOpen}\r\n            size=\"small\"\r\n            darkMode={darkMode}\r\n            isSender={isOwnMessage}\r\n          >\r\n            <MoreVertIcon style={{ color: darkMode ? 'gray' : 'inherit' }} fontSize=\"small\" />\r\n          </MessageMenuButton>\r\n        </MessageActions>\r\n\r\n        {/* Menu */}\r\n        <Menu\r\n          anchorEl={anchorEl}\r\n          open={Boolean(anchorEl)}\r\n          onClose={handleMenuClose}\r\n          PaperProps={{\r\n            style: {\r\n              backgroundColor: darkMode ? '#2a2a2a' : 'white',\r\n              color: darkMode ? '#e0e0e0' : 'black',\r\n            },\r\n          }}\r\n        >\r\n          <MenuItem onClick={handleReply}>\r\n            <ListItemIcon>\r\n              <ReplyIcon fontSize=\"small\" style={{ color: darkMode ? '#64b5f6' : '#1976d2' }} />\r\n            </ListItemIcon>\r\n            <ListItemText style={{ color: darkMode ? '#e0e0e0' : 'black' }}>\r\n              Reply\r\n            </ListItemText>\r\n          </MenuItem>\r\n          \r\n          {showDelete && isOwnMessage && (\r\n            <MenuItem onClick={handleDelete}>\r\n              <ListItemIcon>\r\n                <DeleteIcon fontSize=\"small\" style={{ color: '#d32f2f' }} />\r\n              </ListItemIcon>\r\n              <ListItemText style={{ color: darkMode ? '#e0e0e0' : 'black' }}>\r\n                Delete\r\n              </ListItemText>\r\n            </MenuItem>\r\n          )}\r\n        </Menu>\r\n      </TypeOfMessage>\r\n    </Container>\r\n  );\r\n}\r\n\r\nexport default Message;\r\n\r\n// Styled Components\r\nconst Container = styled.div`\r\n  margin: 5px 0;\r\n  \r\n  &:hover {\r\n    ${props => `\r\n      ${MessageActions} {\r\n        opacity: 1;\r\n      }\r\n    `}\r\n  }\r\n`;\r\n\r\nconst MessageElement = styled.div`\r\n  display: flex;\r\n  align-items: flex-end;\r\n  gap: 8px;\r\n  width: fit-content;\r\n  max-width: 65%;\r\n  padding: 10px 15px;\r\n  padding-top: 15px;\r\n  border-radius: 8px;\r\n  margin: 10px;\r\n  min-width: 60px;\r\n  padding-bottom: 8px;\r\n  position: relative;\r\n  word-wrap: break-word;\r\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\r\n\r\n  @media (max-width: 768px) {\r\n    max-width: 80%;\r\n  }\r\n`;\r\n\r\nconst Sender = styled(MessageElement)`\r\n  margin-left: auto;\r\n  background-color: ${props => props.darkMode ? '#056162' : '#dcf8c6'};\r\n  color: ${props => props.darkMode ? '#e0e0e0' : 'black'};\r\n  border-radius: 8px 8px 0 8px;\r\n`;\r\n\r\nconst Receiver = styled(MessageElement)`\r\n  background-color: ${props => props.darkMode ? '#1f2c33' : 'whitesmoke'};\r\n  color: ${props => props.darkMode ? '#e0e0e0' : 'black'};\r\n  text-align: left;\r\n  border-radius: 8px 8px 8px 0;\r\n  margin-left: 10px;\r\n  margin-right: auto;\r\n`;\r\n\r\nconst MessageContent = styled.div`\r\n  flex: 1;\r\n  min-width: 0;\r\n`;\r\n\r\nconst MessageActions = styled.div`\r\n  opacity: 0;\r\n  transition: opacity 0.2s;\r\n  display: flex;\r\n  align-items: flex-start;\r\n`;\r\n\r\nconst MessageMenuButton = styled(IconButton)`\r\n  opacity: 0.6 !important;\r\n  padding: 4px !important;\r\n  color: ${props => props.darkMode ? '#e0e0e0' : '#666'} !important;\r\n  \r\n  &:hover {\r\n    opacity: 1 !important;\r\n    background-color: ${props => props.darkMode ? 'rgba(255,255,255,0.1)' : 'rgba(0,0,0,0.05)'} !important;\r\n  }\r\n`;\r\n\r\nconst MessageFooter = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: flex-end;\r\n  gap: 4px;\r\n  margin-top: 4px;\r\n  padding-top: 2px;\r\n`;\r\n\r\nconst ReplyPreview = styled.div`\r\n  display: flex;\r\n  margin-bottom: 8px;\r\n  padding: 8px;\r\n  background-color: ${props => props.darkMode ? 'rgba(0,0,0,0.2)' : 'rgba(0,0,0,0.05)'};\r\n  border-radius: 6px;\r\n`;\r\n\r\nconst ReplyBar = styled.div`\r\n  width: 4px;\r\n  background-color: ${props => props.isSender ? '#00a884' : '#1976d2'};\r\n  border-radius: 2px;\r\n  margin-right: 8px;\r\n  flex-shrink: 0;\r\n`;\r\n\r\nconst ReplyContent = styled.div`\r\n  flex: 1;\r\n  overflow: hidden;\r\n`;\r\n\r\nconst ReplyUser = styled.div`\r\n  font-size: 12px;\r\n  font-weight: 600;\r\n  color: ${props => props.darkMode ? '#64b5f6' : '#1976d2'};\r\n  margin-bottom: 2px;\r\n`;\r\n\r\nconst ReplyText = styled.div`\r\n  font-size: 13px;\r\n  color: ${props => props.darkMode ? '#aaa' : '#666'};\r\n  white-space: nowrap;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n`;\r\n\r\nconst MessageText = styled.p`\r\n  margin: 0;\r\n  margin-bottom: 5px;\r\n  font-size: 14px;\r\n  line-height: 1.4;\r\n  color: ${props => props.darkMode ? '#e0e0e0' : 'black'};\r\n  white-space: pre-wrap;\r\n`;\r\n\r\nconst Timestamp = styled.span`\r\n  color: ${props => props.darkMode ? '#8696a0' : 'gray'};\r\n  font-size: 11px;\r\n  margin-left: 8px;\r\n`;\r\n\r\nconst FileAttachment = styled.div`\r\n  margin-bottom: 8px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 8px;\r\n`;\r\n\r\n// Poll Message Styles\r\nconst PollContainer = styled.div`\r\n  background-color: ${(props) => (props.darkMode ? \"#2a3942\" : \"#f0f0f0\")};\r\n  border-radius: 8px;\r\n  padding: 16px;\r\n  margin-bottom: 8px;\r\n  min-width: 300px;\r\n  max-width: 400px;\r\n`;\r\n\r\nconst PollHeader = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  margin-bottom: 16px;\r\n  color: ${(props) => (props.darkMode ? \"#64b5f6\" : \"#1976d2\")};\r\n`;\r\n\r\nconst PollQuestion = styled.div`\r\n  font-size: 16px;\r\n  font-weight: 600;\r\n  color: ${(props) => (props.darkMode ? \"#e0e0e0\" : \"black\")};\r\n  line-height: 1.4;\r\n`;\r\n\r\nconst PollOptions = styled.div`\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 10px;\r\n  margin-bottom: 12px;\r\n`;\r\n\r\nconst PollOption = styled.div`\r\n  background-color: ${(props) => (props.darkMode ? \"#1f2c33\" : \"white\")};\r\n  border: 2px solid ${(props) => {\r\n    if (props.hasVoted) {\r\n      return props.darkMode ? \"#00a884\" : \"#25d366\";\r\n    }\r\n    return props.darkMode ? \"#3a4952\" : \"#e0e0e0\";\r\n  }};\r\n  border-radius: 8px;\r\n  padding: 12px;\r\n  cursor: ${(props) => (props.disabled ? \"not-allowed\" : \"pointer\")};\r\n  transition: all 0.2s;\r\n  opacity: ${(props) => (props.disabled ? 0.6 : 1)};\r\n\r\n  &:hover {\r\n    background-color: ${(props) => \r\n      props.disabled \r\n        ? (props.darkMode ? \"#1f2c33\" : \"white\")\r\n        : (props.darkMode ? \"#2a3942\" : \"#f5f5f5\")\r\n    };\r\n    transform: ${(props) => (props.disabled ? \"none\" : \"translateX(2px)\")};\r\n  }\r\n\r\n  &:active {\r\n    transform: ${(props) => (props.disabled ? \"none\" : \"scale(0.98)\")};\r\n  }\r\n`;\r\n\r\nconst PollOptionContent = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 10px;\r\n  margin-bottom: 6px;\r\n`;\r\n\r\nconst PollOptionIcon = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  flex-shrink: 0;\r\n`;\r\n\r\nconst PollOptionText = styled.div`\r\n  flex: 1;\r\n  font-size: 14px;\r\n  color: ${(props) => (props.darkMode ? \"#e0e0e0\" : \"black\")};\r\n  font-weight: ${(props) => (props.hasVoted ? \"600\" : \"400\")};\r\n  line-height: 1.4;\r\n`;\r\n\r\nconst PollOptionVotes = styled.div`\r\n  font-size: 12px;\r\n  color: ${(props) => (props.darkMode ? \"#8696a0\" : \"#667781\")};\r\n  font-weight: 500;\r\n  flex-shrink: 0;\r\n`;\r\n\r\nconst PollProgressBar = styled.div`\r\n  width: 100%;\r\n  height: 4px;\r\n  background-color: ${(props) => (props.darkMode ? \"#1a1a1a\" : \"#e0e0e0\")};\r\n  border-radius: 2px;\r\n  overflow: hidden;\r\n`;\r\n\r\nconst PollProgressFill = styled.div`\r\n  height: 100%;\r\n  width: ${(props) => props.percentage}%;\r\n  background-color: ${(props) => {\r\n    if (props.hasVoted) {\r\n      return props.darkMode ? \"#00a884\" : \"#25d366\";\r\n    }\r\n    return props.darkMode ? \"#3a4952\" : \"#ccc\";\r\n  }};\r\n  transition: width 0.3s ease;\r\n  border-radius: 2px;\r\n`;\r\n\r\nconst PollFooter = styled.div`\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-top: 12px;\r\n  padding-top: 12px;\r\n  border-top: 1px solid ${(props) => (props.darkMode ? \"#3a4952\" : \"#e0e0e0\")};\r\n`;\r\n\r\nconst PollInfo = styled.div`\r\n  font-size: 11px;\r\n  color: ${(props) => (props.darkMode ? \"#8696a0\" : \"#667781\")};\r\n  font-style: italic;\r\n`;\r\n\r\nconst PollTotalVotes = styled.div`\r\n  font-size: 12px;\r\n  color: ${(props) => (props.darkMode ? \"#8696a0\" : \"#667781\")};\r\n  font-weight: 500;\r\n`;\r\n\r\n// Location Message Styles\r\nconst LocationContainer = styled.div`\r\n  max-width: 280px;\r\n  border-radius: 8px;\r\n  overflow: hidden;\r\n  background-color: ${(props) => (props.darkMode ? \"#2a2a2a\" : \"#f5f5f5\")};\r\n  margin-bottom: 8px;\r\n`;\r\n\r\nconst MapPreview = styled.div`\r\n  width: 100%;\r\n  height: 200px;\r\n  background: #f0f0f0;\r\n  position: relative;\r\n`;\r\n\r\nconst MapFrame = styled.iframe`\r\n  width: 100%;\r\n  height: 100%;\r\n  border: none;\r\n  pointer-events: none;\r\n`;\r\n\r\nconst LocationInfo = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  padding: 12px;\r\n  gap: 8px;\r\n`;\r\n\r\nconst LocationIcon = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n`;\r\n\r\nconst Coordinates = styled.span`\r\n  font-size: 13px;\r\n  color: ${(props) => (props.darkMode ? \"#b0b0b0\" : \"#666\")};\r\n  font-family: monospace;\r\n`;\r\n\r\nconst ViewButton = styled.a`\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  padding: 10px;\r\n  background-color: ${(props) => (props.darkMode ? \"#128C7E\" : \"#25D366\")};\r\n  color: white;\r\n  text-decoration: none;\r\n  font-size: 14px;\r\n  font-weight: 500;\r\n  transition: background-color 0.2s;\r\n\r\n  &:hover {\r\n    background-color: ${(props) => (props.darkMode ? \"#0d6b5f\" : \"#1fa855\")};\r\n  }\r\n`;\r\n\r\n// Image Styles\r\nconst ImageContainer = styled.div`\r\n  position: relative;\r\n  border-radius: 8px;\r\n  overflow: hidden;\r\n  background-color: ${props => props.darkMode ? '#1a1a1a' : '#f5f5f5'};\r\n`;\r\n\r\nconst ImagePlaceholder = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  min-height: 200px;\r\n  background-color: ${props => props.darkMode ? '#2a2a2a' : '#e0e0e0'};\r\n`;\r\n\r\nconst ImageError = styled.div`\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  min-height: 200px;\r\n  background-color: ${props => props.darkMode ? '#2a2a2a' : '#f0f0f0'};\r\n  \r\n  p {\r\n    margin-top: 10px;\r\n    color: ${props => props.darkMode ? '#888' : '#666'};\r\n    font-size: 14px;\r\n  }\r\n`;\r\n\r\nconst ImagePreview = styled.img`\r\n  width: 100%;\r\n  max-width: 100%;\r\n  max-height: 400px;\r\n  object-fit: cover;\r\n  border-radius: 8px;\r\n  cursor: pointer;\r\n  transition: transform 0.2s, opacity 0.2s;\r\n\r\n  &:hover {\r\n    opacity: 0.95;\r\n    transform: scale(1.02);\r\n  }\r\n\r\n  &:active {\r\n    transform: scale(0.98);\r\n  }\r\n`;\r\n\r\nconst ImageFileName = styled.div`\r\n  padding: 8px;\r\n  font-size: 12px;\r\n  color: ${props => props.darkMode ? '#8696a0' : '#666'};\r\n  background-color: ${props => props.darkMode ? 'rgba(0,0,0,0.3)' : 'rgba(255,255,255,0.9)'};\r\n  position: absolute;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  white-space: nowrap;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n`;\r\n\r\n// Video Styles\r\nconst VideoContainer = styled.div`\r\n  position: relative;\r\n  border-radius: 8px;\r\n  overflow: hidden;\r\n`;\r\n\r\nconst VideoPreview = styled.video`\r\n  width: 100%;\r\n  max-width: 100%;\r\n  max-height: 400px;\r\n  border-radius: 8px;\r\n  background-color: #000;\r\n`;\r\n\r\nconst VideoFileName = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  padding: 6px 8px;\r\n  font-size: 12px;\r\n  color: ${props => props.darkMode ? '#8696a0' : '#666'};\r\n  background-color: ${props => props.darkMode ? '#2a3942' : '#f0f0f0'};\r\n  border-radius: 6px;\r\n  margin-top: 6px;\r\n`;\r\n\r\n// Audio File Styles\r\nconst AudioFileContainer = styled.div`\r\n  padding: 12px;\r\n  background-color: ${props => props.darkMode ? '#2a3942' : '#f0f0f0'};\r\n  border-radius: 8px;\r\n  min-width: 280px;\r\n`;\r\n\r\nconst AudioFileHeader = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 12px;\r\n  margin-bottom: 10px;\r\n`;\r\n\r\nconst AudioFileInfo = styled.div`\r\n  flex: 1;\r\n  overflow: hidden;\r\n`;\r\n\r\nconst AudioFileName = styled.div`\r\n  font-size: 14px;\r\n  font-weight: 500;\r\n  color: ${props => props.darkMode ? '#e0e0e0' : 'black'};\r\n  white-space: nowrap;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n`;\r\n\r\nconst AudioFileSize = styled.div`\r\n  font-size: 12px;\r\n  color: ${props => props.darkMode ? '#8696a0' : 'gray'};\r\n  margin-top: 2px;\r\n`;\r\n\r\n// General File Styles\r\nconst FileInfo = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 12px;\r\n  padding: 12px;\r\n  background-color: ${props => props.darkMode ? '#2a3942' : '#f0f0f0'};\r\n  border-radius: 8px;\r\n  min-width: 220px;\r\n  transition: background-color 0.2s;\r\n\r\n  &:hover {\r\n    background-color: ${props => props.darkMode ? '#3a4952' : '#e8e8e8'};\r\n  }\r\n`;\r\n\r\nconst FileDetails = styled.div`\r\n  flex: 1;\r\n  overflow: hidden;\r\n`;\r\n\r\nconst FileName = styled.p`\r\n  margin: 0;\r\n  font-size: 14px;\r\n  font-weight: 500;\r\n  color: ${props => props.darkMode ? '#e0e0e0' : 'black'};\r\n  white-space: nowrap;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n`;\r\n\r\nconst FileSize = styled.p`\r\n  margin: 0;\r\n  font-size: 12px;\r\n  color: ${props => props.darkMode ? '#8696a0' : 'gray'};\r\n  margin-top: 4px;\r\n`;\r\n\r\nconst DownloadButton = styled(IconButton)`\r\n  display: flex !important;\r\n  align-items: center !important;\r\n  padding: 8px 14px !important;\r\n  background-color: ${props => props.darkMode ? '#2a3942' : '#e3f2fd'} !important;\r\n  color: ${props => props.darkMode ? '#64b5f6' : '#1976d2'} !important;\r\n  border-radius: 6px !important;\r\n  font-size: 12px !important;\r\n  align-self: flex-start !important;\r\n  transition: all 0.2s !important;\r\n\r\n  &:hover {\r\n    background-color: ${props => props.darkMode ? '#3a4952' : '#bbdefb'} !important;\r\n    transform: translateY(-1px);\r\n  }\r\n\r\n  &:active {\r\n    transform: translateY(0);\r\n  }\r\n`;\r\n\r\n// Voice Message Styles\r\nconst VoiceMessageContainer = styled.div`\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 8px;\r\n  margin-bottom: 8px;\r\n  padding: 12px;\r\n  background-color: ${props => props.darkMode ? '#2a3942' : '#f0f0f0'};\r\n  border-radius: 8px;\r\n  min-width: 280px;\r\n`;\r\n\r\nconst VoiceLabel = styled.span`\r\n  font-size: 13px;\r\n  font-weight: 500;\r\n  color: ${props => props.darkMode ? '#64b5f6' : '#1976d2'};\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 6px;\r\n`;\r\n\r\nconst AudioPlayer = styled.audio`\r\n  width: 100%;\r\n  height: 40px;\r\n  outline: none;\r\n  border-radius: 6px;\r\n  \r\n  &::-webkit-media-controls-panel {\r\n    background-color: ${props => props.darkMode ? '#1f2c33' : 'white'};\r\n    border-radius: 6px;\r\n  }\r\n\r\n  &::-webkit-media-controls-play-button,\r\n  &::-webkit-media-controls-mute-button {\r\n    filter: ${props => props.darkMode ? 'invert(1)' : 'none'};\r\n  }\r\n`;\r\n\r\nconst VoiceDuration = styled.span`\r\n  font-size: 11px;\r\n  color: ${props => props.darkMode ? '#8696a0' : 'gray'};\r\n  text-align: right;\r\n`;"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 5827, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/waels/OneDrive/Desktop/Expo%20projects/P3/components/ChatScreen/ChatScreen.styles.js"],"sourcesContent":["// components/ChatScreen/ChatScreen.styles.js\r\nimport styled from \"styled-components\";\r\nimport { Tabs } from \"@mui/material\";\r\n\r\nexport const Container = styled.div`\r\n  display: flex;\r\n  flex-direction: column;\r\n  height: 100vh;\r\n  overflow: hidden;\r\n  background-color: ${props => props.darkMode ? '#1e1e1e' : 'white'};\r\n`;\r\n\r\nexport const Header = styled.div`\r\n  position: sticky;\r\n  background-color: ${props => props.darkMode ? '#2a2a2a' : 'white'};\r\n  color: ${props => props.darkMode ? '#e0e0e0' : 'black'};\r\n  z-index: 100;\r\n  top: 0;\r\n  display: flex;\r\n  padding: 11px;\r\n  height: 80px;\r\n  align-items: center;\r\n  border-bottom: 1px solid ${props => props.darkMode ? '#333' : 'whitesmoke'};\r\n  flex-shrink: 0;\r\n`;\r\n\r\nexport const HeaderInformation = styled.div`\r\n  margin-left: 15px;\r\n  flex: 1;\r\n  color: ${props => props.darkMode ? '#e0e0e0' : 'black'};\r\n\r\n  > h3 {\r\n    margin-bottom: 3px;\r\n    color: ${props => props.darkMode ? '#e0e0e0' : 'black'};\r\n  }\r\n  > p {\r\n    font-size: 14px;\r\n    color: ${props => props.darkMode ? '#aaa' : 'gray'};\r\n  }\r\n`;\r\n\r\nexport const HeaderIcons = styled.div``;\r\n\r\nexport const MessageContainer = styled.div`\r\n  padding: 30px;\r\n  background-color: ${props => props.darkMode ? '#0d1117' : '#e5ded8'};\r\n  flex: 1;\r\n  overflow-y: auto;\r\n  display: flex;\r\n  flex-direction: column;\r\n  min-height: 0;\r\n`;\r\n\r\nexport const InputContainer = styled.form`\r\n  display: flex;\r\n  align-items: center;\r\n  padding: 10px;\r\n  background-color: ${props => props.darkMode ? '#2a2a2a' : 'white'};\r\n  gap: 10px;\r\n  flex-shrink: 0;\r\n  border-top: 1px solid ${props => props.darkMode ? '#333' : 'whitesmoke'};\r\n`;\r\n\r\nexport const Input = styled.input`\r\n  flex: 1;\r\n  flex-shrink: 1;\r\n  outline: 0;\r\n  border: none;\r\n  border-radius: 10px;\r\n  background-color: ${props => props.darkMode ? '#1e1e1e' : 'whitesmoke'};\r\n  color: ${props => props.darkMode ? '#e0e0e0' : 'black'};\r\n  padding: 15px;\r\n  margin-left: 5px;\r\n  margin-right: 5px;\r\n  font-size: 16px;\r\n\r\n  ::placeholder {\r\n    color: ${props => props.darkMode ? '#888' : '#999'};\r\n  }\r\n`;\r\n\r\nexport const EndOfMessage = styled.div`\r\n  margin-bottom: 50px;\r\n`;\r\n\r\nexport const OfflineMessage = styled.div`\r\n  text-align: center;\r\n  padding: 20px;\r\n  color: ${props => props.darkMode ? '#f8d7da' : '#721c24'};\r\n  background-color: ${props => props.darkMode ? '#5a1f1f' : '#f8d7da'};\r\n  border: 1px solid ${props => props.darkMode ? '#721c24' : '#f5c6cb'};\r\n  border-radius: 4px;\r\n  margin: 20px;\r\n`;\r\n\r\nexport const ErrorMessage = styled.div`\r\n  text-align: center;\r\n  padding: 20px;\r\n  color: ${props => props.darkMode ? '#ffeeba' : '#856404'};\r\n  background-color: ${props => props.darkMode ? '#664d03' : '#fff3cd'};\r\n  border: 1px solid ${props => props.darkMode ? '#856404' : '#ffeeba'};\r\n  border-radius: 4px;\r\n  margin: 20px;\r\n`;\r\n\r\nexport const ErrorAlert = styled.div`\r\n  color: ${props => props.darkMode ? '#f8d7da' : '#721c24'};\r\n  background-color: ${props => props.darkMode ? '#5a1f1f' : '#f8d7da'};\r\n  border: 1px solid ${props => props.darkMode ? '#721c24' : '#f5c6cb'};\r\n  padding: 10px;\r\n  margin: 10px;\r\n  border-radius: 4px;\r\n  text-align: center;\r\n`;\r\n\r\nexport const SendButton = styled.button`\r\n  background-color: ${props => props.darkMode ? '#d32f2f' : '#f44336'} !important;\r\n  color: white !important;\r\n  padding: 10px 20px !important;\r\n  border: none !important;\r\n  border-radius: 8px !important;\r\n  cursor: pointer !important;\r\n  font-weight: 600 !important;\r\n  display: block !important;\r\n  width: auto !important;\r\n  height: auto !important;\r\n  visibility: visible !important;\r\n  opacity: ${props => props.disabled ? '0.5' : '1'} !important;\r\n  \r\n  &:hover {\r\n    background-color: ${props => props.darkMode ? '#b71c1c' : '#d32f2f'} !important;\r\n  }\r\n\r\n  &:disabled {\r\n    cursor: not-allowed !important;\r\n  }\r\n`;\r\n\r\nexport const FilePreview = styled.div`\r\n  text-align: center;\r\n  margin-bottom: 20px;\r\n`;\r\n\r\nexport const FileInfo = styled.div`\r\n  margin-bottom: 20px;\r\n  padding: 10px;\r\n  background-color: ${props => props.darkMode ? '#1e1e1e' : '#f5f5f5'};\r\n  border-radius: 8px;\r\n  color: ${props => props.darkMode ? '#e0e0e0' : 'black'};\r\n\r\n  p {\r\n    margin: 5px 0;\r\n  }\r\n`;\r\n\r\nexport const FileInput = styled.input`\r\n  width: 100%;\r\n  outline: 0;\r\n  border: 1px solid ${props => props.darkMode ? '#444' : '#ddd'};\r\n  border-radius: 8px;\r\n  background-color: ${props => props.darkMode ? '#1e1e1e' : 'white'};\r\n  color: ${props => props.darkMode ? '#e0e0e0' : 'black'};\r\n  padding: 12px;\r\n  font-size: 16px;\r\n  margin-bottom: 10px;\r\n\r\n  ::placeholder {\r\n    color: ${props => props.darkMode ? '#888' : '#999'};\r\n  }\r\n`;\r\n\r\nexport const UploadProgress = styled.div`\r\n  text-align: center;\r\n  margin-top: 20px;\r\n\r\n  p {\r\n    margin-top: 10px;\r\n    font-weight: bold;\r\n  }\r\n`;\r\n\r\nexport const ProfileContainer = styled.div`\r\n  text-align: center;\r\n  padding: 20px;\r\n`;\r\n\r\nexport const ProfileInfo = styled.div`\r\n  color: ${props => props.darkMode ? '#e0e0e0' : 'black'};\r\n\r\n  h2 {\r\n    margin-bottom: 15px;\r\n    color: ${props => props.darkMode ? '#e0e0e0' : 'black'};\r\n  }\r\n\r\n  p {\r\n    margin: 10px 0;\r\n    font-size: 16px;\r\n    color: ${props => props.darkMode ? '#aaa' : 'gray'};\r\n  }\r\n`;\r\n\r\nexport const RecordingIndicator = styled.div`\r\n  flex: 1;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 10px;\r\n  padding: 15px;\r\n  background-color: ${props => props.darkMode ? '#1e1e1e' : '#ffebee'};\r\n  border-radius: 10px;\r\n  color: ${props => props.darkMode ? '#e0e0e0' : '#c62828'};\r\n  font-weight: 500;\r\n`;\r\n\r\nexport const RecordingDot = styled.div`\r\n  width: 12px;\r\n  height: 12px;\r\n  background-color: #f44336;\r\n  border-radius: 50%;\r\n  animation: pulse 1.5s infinite;\r\n\r\n  @keyframes pulse {\r\n    0%, 100% {\r\n      opacity: 1;\r\n    }\r\n    50% {\r\n      opacity: 0.3;\r\n    }\r\n  }\r\n`;\r\n\r\nexport const VoicePreview = styled.div`\r\n  padding: 20px;\r\n  text-align: center;\r\n  color: ${props => props.darkMode ? '#e0e0e0' : 'black'};\r\n\r\n  p {\r\n    font-size: 18px;\r\n    font-weight: bold;\r\n    margin-bottom: 10px;\r\n  }\r\n`;\r\n\r\nexport const EmojiPickerContainer = styled.div`\r\n  width: 350px;\r\n  max-height: 450px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  background-color: ${props => props.darkMode ? '#2a2a2a' : 'white'};\r\n`;\r\n\r\nexport const EmojiPickerHeader = styled.div`\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  padding: 12px 16px;\r\n  border-bottom: 1px solid ${props => props.darkMode ? '#444' : '#e0e0e0'};\r\n\r\n  h3 {\r\n    margin: 0;\r\n    font-size: 18px;\r\n    color: ${props => props.darkMode ? '#e0e0e0' : 'black'};\r\n  }\r\n`;\r\n\r\nexport const EmojiSearchContainer = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  padding: 12px 16px;\r\n  gap: 8px;\r\n  border-bottom: 1px solid ${props => props.darkMode ? '#444' : '#e0e0e0'};\r\n`;\r\n\r\nexport const EmojiSearchInput = styled.input`\r\n  flex: 1;\r\n  border: none;\r\n  outline: none;\r\n  background-color: ${props => props.darkMode ? '#1e1e1e' : '#f5f5f5'};\r\n  color: ${props => props.darkMode ? '#e0e0e0' : 'black'};\r\n  padding: 8px 12px;\r\n  border-radius: 20px;\r\n  font-size: 14px;\r\n\r\n  ::placeholder {\r\n    color: ${props => props.darkMode ? '#888' : '#999'};\r\n  }\r\n`;\r\n\r\nexport const EmojiCategoryTabs = styled(Tabs)`\r\n  border-bottom: 1px solid ${props => props.darkMode ? '#444' : '#e0e0e0'};\r\n  min-height: 48px;\r\n\r\n  .MuiTabs-flexContainer {\r\n    justify-content: space-around;\r\n  }\r\n`;\r\n\r\nexport const EmojiGrid = styled.div`\r\n  display: grid;\r\n  grid-template-columns: repeat(8, 1fr);\r\n  gap: 4px;\r\n  padding: 12px;\r\n  overflow-y: auto;\r\n  max-height: 280px;\r\n\r\n  &::-webkit-scrollbar {\r\n    width: 8px;\r\n  }\r\n\r\n  &::-webkit-scrollbar-track {\r\n    background: ${props => props.darkMode ? '#1e1e1e' : '#f1f1f1'};\r\n  }\r\n\r\n  &::-webkit-scrollbar-thumb {\r\n    background: ${props => props.darkMode ? '#555' : '#888'};\r\n    border-radius: 4px;\r\n  }\r\n\r\n  &::-webkit-scrollbar-thumb:hover {\r\n    background: ${props => props.darkMode ? '#666' : '#555'};\r\n  }\r\n`;\r\n\r\nexport const EmojiButton = styled.button`\r\n  background: none;\r\n  border: none;\r\n  font-size: 24px;\r\n  cursor: pointer;\r\n  padding: 8px;\r\n  border-radius: 8px;\r\n  transition: all 0.2s;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n\r\n  &:hover {\r\n    background-color: ${props => props.darkMode ? '#3a3a3a' : '#f0f0f0'};\r\n    transform: scale(1.2);\r\n  }\r\n\r\n  &:active {\r\n    transform: scale(1.1);\r\n  }\r\n`;\r\n\r\nexport const NoEmojisMessage = styled.div`\r\n  grid-column: 1 / -1;\r\n  text-align: center;\r\n  padding: 40px 20px;\r\n  color: ${props => props.darkMode ? '#888' : '#999'};\r\n  font-size: 14px;\r\n`;\r\n\r\nexport const ReplyPreviewBar = styled.div`\r\n  display: flex;\r\n  padding: 12px 16px;\r\n  background-color: ${props => props.darkMode ? '#2a2a2a' : '#f5f5f5'};\r\n  border-top: 1px solid ${props => props.darkMode ? '#333' : '#e0e0e0'};\r\n  gap: 12px;\r\n  align-items: center;\r\n`;\r\n\r\nexport const ReplyBarIndicator = styled.div`\r\n  width: 4px;\r\n  height: 50px;\r\n  background-color: #00a884;\r\n  border-radius: 2px;\r\n  flex-shrink: 0;\r\n`;\r\n\r\nexport const ReplyPreviewContent = styled.div`\r\n  flex: 1;\r\n  overflow: hidden;\r\n`;\r\n\r\nexport const ReplyPreviewHeader = styled.div`\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 4px;\r\n  \r\n  span {\r\n    font-size: 13px;\r\n    font-weight: 600;\r\n    color: #00a884;\r\n  }\r\n`;\r\n\r\nexport const ReplyPreviewText = styled.div`\r\n  font-size: 14px;\r\n  color: ${props => props.darkMode ? '#aaa' : '#666'};\r\n  white-space: nowrap;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n`;"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 6265, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/waels/OneDrive/Desktop/Expo%20projects/P3/components/ChatScreen/components/MessageList.jsx"],"sourcesContent":["// components/ChatScreen/components/MessageList.jsx\r\nimport React, { forwardRef } from \"react\";\r\nimport Message from \"../../Message\";\r\nimport { MessageContainer, ErrorAlert, EndOfMessage } from \"../ChatScreen.styles\";\r\n\r\nconst MessageList = forwardRef(({ \r\n  messagesSnapshot, \r\n  messages, \r\n  sendingError, \r\n  onDelete, \r\n  onReply,\r\n  darkMode \r\n}, ref) => {\r\n  const showMessages = () => {\r\n    if (messagesSnapshot) {\r\n      return messagesSnapshot.docs.map((message) => (\r\n        <Message\r\n          key={message.id}\r\n          messageId={message.id}\r\n          user={message.data().user}\r\n          message={{\r\n            ...message.data(),\r\n            timestamp: message.data().timestamp?.toMillis(),\r\n          }}\r\n          onDelete={onDelete}\r\n          onReply={onReply}\r\n        />\r\n      ));\r\n    } else {\r\n      return messages ? JSON.parse(messages).map((message) => (\r\n        <Message \r\n          key={message.id} \r\n          messageId={message.id}\r\n          user={message.user} \r\n          message={message}\r\n          onDelete={onDelete}\r\n          onReply={onReply}\r\n        />\r\n      )) : null;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <MessageContainer darkMode={darkMode}>\r\n      {showMessages()}\r\n      {sendingError && <ErrorAlert darkMode={darkMode}>{sendingError}</ErrorAlert>}\r\n      <EndOfMessage ref={ref} />\r\n    </MessageContainer>\r\n  );\r\n});\r\n\r\nMessageList.displayName = 'MessageList';\r\n\r\nexport default MessageList;"],"names":[],"mappings":"AAAA,mDAAmD;;;;;;AACnD;AACA;AACA;;;;;;;;;AAEA,MAAM,4BAAc,IAAA,iHAAU,EAAC,CAAC,EAC9B,gBAAgB,EAChB,QAAQ,EACR,YAAY,EACZ,QAAQ,EACR,OAAO,EACP,QAAQ,EACT,EAAE;IACD,MAAM,eAAe;QACnB,IAAI,kBAAkB;YACpB,OAAO,iBAAiB,IAAI,CAAC,GAAG,CAAC,CAAC,wBAChC,qKAAC,yHAAO;oBAEN,WAAW,QAAQ,EAAE;oBACrB,MAAM,QAAQ,IAAI,GAAG,IAAI;oBACzB,SAAS;wBACP,GAAG,QAAQ,IAAI,EAAE;wBACjB,WAAW,QAAQ,IAAI,GAAG,SAAS,EAAE;oBACvC;oBACA,UAAU;oBACV,SAAS;mBARJ,QAAQ,EAAE;;;;;QAWrB,OAAO;YACL,OAAO,WAAW,KAAK,KAAK,CAAC,UAAU,GAAG,CAAC,CAAC,wBAC1C,qKAAC,yHAAO;oBAEN,WAAW,QAAQ,EAAE;oBACrB,MAAM,QAAQ,IAAI;oBAClB,SAAS;oBACT,UAAU;oBACV,SAAS;mBALJ,QAAQ,EAAE;;;;gEAOd;QACP;IACF;IAEA,qBACE,qKAAC,6JAAgB;QAAC,UAAU;;YACzB;YACA,8BAAgB,qKAAC,uJAAU;gBAAC,UAAU;0BAAW;;;;;;0BAClD,qKAAC,yJAAY;gBAAC,KAAK;;;;;;;;;;;;AAGzB;AAEA,YAAY,WAAW,GAAG;uCAEX","debugId":null}},
    {"offset": {"line": 6346, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/waels/OneDrive/Desktop/Expo%20projects/P3/components/ChatScreen/components/ChatInput.jsx"],"sourcesContent":["// components/ChatScreen/components/ChatInput.jsx\r\nimport React from \"react\";\r\nimport styled from \"styled-components\";\r\nimport { IconButton } from \"@mui/material\";\r\nimport InsertEmoticonIcon from \"@mui/icons-material/InsertEmoticon\";\r\nimport MicIcon from \"@mui/icons-material/Mic\";\r\nimport SendIcon from \"@mui/icons-material/Send\";\r\nimport StopIcon from \"@mui/icons-material/Stop\";\r\nimport AddIcon from \"@mui/icons-material/Add\";\r\n\r\nfunction ChatInput({\r\n  input,\r\n  setInput,\r\n  inputRef,\r\n  isRecording,\r\n  recordingTime,\r\n  onSubmit,\r\n  onEmojiClick,\r\n  onPlusClick,\r\n  onStartRecording,\r\n  onStopRecording,\r\n  darkMode,\r\n}) {\r\n  const formatTime = (seconds) => {\r\n    const mins = Math.floor(seconds / 60);\r\n    const secs = seconds % 60;\r\n    return `${mins}:${secs.toString().padStart(2, \"0\")}`;\r\n  };\r\n\r\n  return (\r\n    <InputContainer darkMode={darkMode}>\r\n      <Form onSubmit={onSubmit}>\r\n        <PlusButton onClick={onPlusClick} darkMode={darkMode}>\r\n          <AddIcon />\r\n        </PlusButton>\r\n\r\n        <EmojiButton onClick={onEmojiClick} darkMode={darkMode}>\r\n          <InsertEmoticonIcon />\r\n        </EmojiButton>\r\n\r\n        <Input\r\n          ref={inputRef}\r\n          value={input}\r\n          onChange={(e) => setInput(e.target.value)}\r\n          placeholder=\"Type a message\"\r\n          disabled={isRecording}\r\n          darkMode={darkMode}\r\n        />\r\n\r\n        {isRecording ? (\r\n          <RecordingContainer darkMode={darkMode}>\r\n            <RecordingIndicator>\r\n              <RecordingDot />\r\n              <RecordingTime>{formatTime(recordingTime)}</RecordingTime>\r\n            </RecordingIndicator>\r\n            <StopButton onClick={onStopRecording} darkMode={darkMode}>\r\n              <StopIcon />\r\n            </StopButton>\r\n          </RecordingContainer>\r\n        ) : (\r\n          <ButtonsContainer>\r\n            {input.trim() ? (\r\n              <SendButton type=\"submit\" darkMode={darkMode}>\r\n                <SendIcon />\r\n              </SendButton>\r\n            ) : (\r\n              <MicButton onClick={onStartRecording} darkMode={darkMode}>\r\n                <MicIcon />\r\n              </MicButton>\r\n            )}\r\n          </ButtonsContainer>\r\n        )}\r\n      </Form>\r\n    </InputContainer>\r\n  );\r\n}\r\n\r\nexport default ChatInput;\r\n\r\n// Styled Components\r\nconst InputContainer = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  padding: 10px;\r\n  position: sticky;\r\n  bottom: 0;\r\n  background-color: ${(props) => (props.darkMode ? \"#1e1e1e\" : \"white\")};\r\n  border-top: 1px solid ${(props) => (props.darkMode ? \"#333\" : \"whitesmoke\")};\r\n  z-index: 100;\r\n\r\n  @media (max-width: 768px) {\r\n    padding: 8px;\r\n  }\r\n`;\r\n\r\nconst Form = styled.form`\r\n  display: flex;\r\n  flex: 1;\r\n  align-items: center;\r\n  gap: 8px;\r\n  width: 100%;\r\n\r\n  @media (max-width: 768px) {\r\n    gap: 4px;\r\n  }\r\n`;\r\n\r\nconst PlusButton = styled(IconButton)`\r\n  && {\r\n    color: ${(props) => (props.darkMode ? \"#b0b0b0\" : \"#919191\")};\r\n    padding: 8px;\r\n    \r\n    @media (max-width: 768px) {\r\n      padding: 6px;\r\n    }\r\n\r\n    &:hover {\r\n      background-color: ${(props) =>\r\n        props.darkMode ? \"rgba(255,255,255,0.1)\" : \"rgba(0,0,0,0.05)\"};\r\n    }\r\n  }\r\n`;\r\n\r\nconst EmojiButton = styled(IconButton)`\r\n  && {\r\n    color: ${(props) => (props.darkMode ? \"#b0b0b0\" : \"#919191\")};\r\n    padding: 8px;\r\n    \r\n    @media (max-width: 768px) {\r\n      padding: 6px;\r\n    }\r\n\r\n    &:hover {\r\n      background-color: ${(props) =>\r\n        props.darkMode ? \"rgba(255,255,255,0.1)\" : \"rgba(0,0,0,0.05)\"};\r\n    }\r\n  }\r\n`;\r\n\r\nconst Input = styled.input`\r\n  flex: 1;\r\n  outline: 0;\r\n  border: none;\r\n  border-radius: 25px;\r\n  background-color: ${(props) => (props.darkMode ? \"#2a2a2a\" : \"whitesmoke\")};\r\n  color: ${(props) => (props.darkMode ? \"#e0e0e0\" : \"black\")};\r\n  padding: 12px 20px;\r\n  font-size: 15px;\r\n  min-width: 0;\r\n\r\n  &::placeholder {\r\n    color: ${(props) => (props.darkMode ? \"#888\" : \"#999\")};\r\n  }\r\n\r\n  &:disabled {\r\n    opacity: 0.5;\r\n    cursor: not-allowed;\r\n  }\r\n\r\n  @media (max-width: 768px) {\r\n    padding: 10px 15px;\r\n    font-size: 14px;\r\n  }\r\n`;\r\n\r\nconst ButtonsContainer = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  flex-shrink: 0;\r\n`;\r\n\r\nconst SendButton = styled(IconButton)`\r\n  && {\r\n    color: ${(props) => (props.darkMode ? \"#25D366\" : \"#128C7E\")};\r\n    padding: 8px;\r\n\r\n    @media (max-width: 768px) {\r\n      padding: 6px;\r\n    }\r\n\r\n    &:hover {\r\n      background-color: ${(props) =>\r\n        props.darkMode ? \"rgba(37, 211, 102, 0.1)\" : \"rgba(18, 140, 126, 0.1)\"};\r\n    }\r\n  }\r\n`;\r\n\r\nconst MicButton = styled(IconButton)`\r\n  && {\r\n    color: ${(props) => (props.darkMode ? \"#b0b0b0\" : \"#919191\")};\r\n    padding: 8px;\r\n\r\n    @media (max-width: 768px) {\r\n      padding: 6px;\r\n    }\r\n\r\n    &:hover {\r\n      background-color: ${(props) =>\r\n        props.darkMode ? \"rgba(255,255,255,0.1)\" : \"rgba(0,0,0,0.05)\"};\r\n    }\r\n  }\r\n`;\r\n\r\nconst RecordingContainer = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 12px;\r\n  background-color: ${(props) => (props.darkMode ? \"#2a2a2a\" : \"#f0f0f0\")};\r\n  border-radius: 25px;\r\n  padding: 8px 12px;\r\n  flex-shrink: 0;\r\n\r\n  @media (max-width: 768px) {\r\n    gap: 8px;\r\n    padding: 6px 10px;\r\n  }\r\n`;\r\n\r\nconst RecordingIndicator = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n\r\n  @media (max-width: 768px) {\r\n    gap: 6px;\r\n  }\r\n`;\r\n\r\nconst RecordingDot = styled.div`\r\n  width: 12px;\r\n  height: 12px;\r\n  border-radius: 50%;\r\n  background-color: #f44336;\r\n  animation: pulse 1.5s ease-in-out infinite;\r\n\r\n  @keyframes pulse {\r\n    0%, 100% {\r\n      opacity: 1;\r\n      transform: scale(1);\r\n    }\r\n    50% {\r\n      opacity: 0.5;\r\n      transform: scale(0.8);\r\n    }\r\n  }\r\n\r\n  @media (max-width: 768px) {\r\n    width: 10px;\r\n    height: 10px;\r\n  }\r\n`;\r\n\r\nconst RecordingTime = styled.span`\r\n  color: ${(props) => (props.darkMode ? \"#e0e0e0\" : \"#333\")};\r\n  font-size: 14px;\r\n  font-weight: 500;\r\n  min-width: 40px;\r\n\r\n  @media (max-width: 768px) {\r\n    font-size: 13px;\r\n    min-width: 35px;\r\n  }\r\n`;\r\n\r\nconst StopButton = styled(IconButton)`\r\n  && {\r\n    color: #f44336;\r\n    padding: 6px;\r\n\r\n    @media (max-width: 768px) {\r\n      padding: 4px;\r\n    }\r\n\r\n    &:hover {\r\n      background-color: rgba(244, 67, 54, 0.1);\r\n    }\r\n  }\r\n`;"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 6690, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/waels/OneDrive/Desktop/Expo%20projects/P3/components/ChatScreen/components/EmojiPicker.jsx"],"sourcesContent":["// components/ChatScreen/components/EmojiPicker.jsx\r\nimport React from \"react\";\r\nimport { Popover, IconButton, Tab } from \"@mui/material\";\r\nimport CloseIcon from \"@mui/icons-material/Close\";\r\nimport SearchIcon from \"@mui/icons-material/Search\";\r\nimport { EMOJI_CATEGORIES } from \"../constants\";\r\nimport {\r\n  EmojiPickerContainer,\r\n  EmojiPickerHeader,\r\n  EmojiSearchContainer,\r\n  EmojiSearchInput,\r\n  EmojiCategoryTabs,\r\n  EmojiGrid,\r\n  EmojiButton,\r\n  NoEmojisMessage,\r\n} from \"../ChatScreen.styles\";\r\n\r\nconst EmojiPicker = ({\r\n  open,\r\n  anchorEl,\r\n  onClose,\r\n  selectedCategory,\r\n  onCategoryChange,\r\n  searchTerm,\r\n  onSearchChange,\r\n  emojis,\r\n  onEmojiSelect,\r\n  darkMode,\r\n}) => {\r\n  return (\r\n    <Popover\r\n      open={open}\r\n      anchorEl={anchorEl}\r\n      onClose={onClose}\r\n      anchorOrigin={{\r\n        vertical: 'top',\r\n        horizontal: 'left',\r\n      }}\r\n      transformOrigin={{\r\n        vertical: 'bottom',\r\n        horizontal: 'left',\r\n      }}\r\n      PaperProps={{\r\n        style: {\r\n          backgroundColor: darkMode ? '#2a2a2a' : 'white',\r\n          color: darkMode ? '#e0e0e0' : 'black',\r\n          borderRadius: '12px',\r\n          boxShadow: '0 4px 20px rgba(0,0,0,0.3)',\r\n        },\r\n      }}\r\n    >\r\n      <EmojiPickerContainer darkMode={darkMode}>\r\n        <EmojiPickerHeader darkMode={darkMode}>\r\n          <h3>Emojis</h3>\r\n          <IconButton onClick={onClose} size=\"small\">\r\n            <CloseIcon style={{ color: darkMode ? '#e0e0e0' : 'inherit' }} />\r\n          </IconButton>\r\n        </EmojiPickerHeader>\r\n\r\n        <EmojiSearchContainer darkMode={darkMode}>\r\n          <SearchIcon style={{ color: darkMode ? '#888' : '#666' }} />\r\n          <EmojiSearchInput\r\n            darkMode={darkMode}\r\n            placeholder=\"Search emoji...\"\r\n            value={searchTerm}\r\n            onChange={(e) => onSearchChange(e.target.value)}\r\n          />\r\n        </EmojiSearchContainer>\r\n\r\n        <EmojiCategoryTabs\r\n          value={selectedCategory}\r\n          onChange={(e, newValue) => onCategoryChange(newValue)}\r\n          variant=\"scrollable\"\r\n          scrollButtons=\"auto\"\r\n          darkMode={darkMode}\r\n          TabIndicatorProps={{\r\n            style: {\r\n              backgroundColor: darkMode ? '#d32f2f' : '#f44336',\r\n            },\r\n          }}\r\n        >\r\n          {Object.entries(EMOJI_CATEGORIES).map(([key, { name, icon }]) => (\r\n            <Tab\r\n              key={key}\r\n              value={key}\r\n              label={icon}\r\n              title={name}\r\n              style={{\r\n                color: darkMode ? '#e0e0e0' : 'black',\r\n                minWidth: 50,\r\n              }}\r\n            />\r\n          ))}\r\n        </EmojiCategoryTabs>\r\n\r\n        <EmojiGrid darkMode={darkMode}>\r\n          {emojis.length > 0 ? (\r\n            emojis.map((emoji, index) => (\r\n              <EmojiButton\r\n                key={`${emoji}-${index}`}\r\n                onClick={() => onEmojiSelect(emoji)}\r\n                darkMode={darkMode}\r\n              >\r\n                {emoji}\r\n              </EmojiButton>\r\n            ))\r\n          ) : (\r\n            <NoEmojisMessage darkMode={darkMode}>\r\n              {selectedCategory === \"recent\"\r\n                ? \"No recent emojis. Start using emojis!\"\r\n                : \"No emojis found\"}\r\n            </NoEmojisMessage>\r\n          )}\r\n        </EmojiGrid>\r\n      </EmojiPickerContainer>\r\n    </Popover>\r\n  );\r\n};\r\n\r\nexport default EmojiPicker;"],"names":[],"mappings":"AAAA,mDAAmD;;;;;;AACnD;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;;;;;;;;AAWA,MAAM,cAAc,CAAC,EACnB,IAAI,EACJ,QAAQ,EACR,OAAO,EACP,gBAAgB,EAChB,gBAAgB,EAChB,UAAU,EACV,cAAc,EACd,MAAM,EACN,aAAa,EACb,QAAQ,EACT;IACC,qBACE,qKAAC,iMAAO;QACN,MAAM;QACN,UAAU;QACV,SAAS;QACT,cAAc;YACZ,UAAU;YACV,YAAY;QACd;QACA,iBAAiB;YACf,UAAU;YACV,YAAY;QACd;QACA,YAAY;YACV,OAAO;gBACL,iBAAiB,WAAW,YAAY;gBACxC,OAAO,WAAW,YAAY;gBAC9B,cAAc;gBACd,WAAW;YACb;QACF;kBAEA,cAAA,qKAAC,iKAAoB;YAAC,UAAU;;8BAC9B,qKAAC,8JAAiB;oBAAC,UAAU;;sCAC3B,qKAAC;sCAAG;;;;;;sCACJ,qKAAC,6MAAU;4BAAC,SAAS;4BAAS,MAAK;sCACjC,cAAA,qKAAC,uJAAS;gCAAC,OAAO;oCAAE,OAAO,WAAW,YAAY;gCAAU;;;;;;;;;;;;;;;;;8BAIhE,qKAAC,iKAAoB;oBAAC,UAAU;;sCAC9B,qKAAC,wJAAU;4BAAC,OAAO;gCAAE,OAAO,WAAW,SAAS;4BAAO;;;;;;sCACvD,qKAAC,6JAAgB;4BACf,UAAU;4BACV,aAAY;4BACZ,OAAO;4BACP,UAAU,CAAC,IAAM,eAAe,EAAE,MAAM,CAAC,KAAK;;;;;;;;;;;;8BAIlD,qKAAC,8JAAiB;oBAChB,OAAO;oBACP,UAAU,CAAC,GAAG,WAAa,iBAAiB;oBAC5C,SAAQ;oBACR,eAAc;oBACd,UAAU;oBACV,mBAAmB;wBACjB,OAAO;4BACL,iBAAiB,WAAW,YAAY;wBAC1C;oBACF;8BAEC,OAAO,OAAO,CAAC,kJAAgB,EAAE,GAAG,CAAC,CAAC,CAAC,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC,iBAC1D,qKAAC,iLAAG;4BAEF,OAAO;4BACP,OAAO;4BACP,OAAO;4BACP,OAAO;gCACL,OAAO,WAAW,YAAY;gCAC9B,UAAU;4BACZ;2BAPK;;;;;;;;;;8BAYX,qKAAC,sJAAS;oBAAC,UAAU;8BAClB,OAAO,MAAM,GAAG,IACf,OAAO,GAAG,CAAC,CAAC,OAAO,sBACjB,qKAAC,wJAAW;4BAEV,SAAS,IAAM,cAAc;4BAC7B,UAAU;sCAET;2BAJI,GAAG,MAAM,CAAC,EAAE,OAAO;;;;sFAQ5B,qKAAC,4JAAe;wBAAC,UAAU;kCACxB,qBAAqB,WAClB,0CACA;;;;;;;;;;;;;;;;;;;;;;AAOlB;uCAEe","debugId":null}},
    {"offset": {"line": 6865, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/waels/OneDrive/Desktop/Expo%20projects/P3/components/ChatScreen/components/AttachMenu.jsx"],"sourcesContent":["// components/ChatScreen/components/AttachMenu.jsx\r\nimport React from \"react\";\r\nimport styled from \"styled-components\";\r\nimport { Menu, MenuItem, ListItemIcon, ListItemText } from \"@mui/material\";\r\nimport AttachFileIcon from \"@mui/icons-material/AttachFile\";\r\nimport CameraAltIcon from \"@mui/icons-material/CameraAlt\";\r\nimport LocationOnIcon from \"@mui/icons-material/LocationOn\";\r\nimport PollIcon from \"@mui/icons-material/Poll\";\r\n\r\nfunction AttachMenu({ \r\n  anchorEl, \r\n  open, \r\n  onClose, \r\n  onAttachFile, \r\n  onTakePhoto, \r\n  onShareLocation, \r\n  onCreatePoll,\r\n  darkMode \r\n}) {\r\n  const handleMenuItemClick = (action) => {\r\n    action();\r\n    onClose();\r\n  };\r\n\r\n  return (\r\n    <StyledMenu\r\n      anchorEl={anchorEl}\r\n      open={open}\r\n      onClose={onClose}\r\n      darkMode={darkMode}\r\n      anchorOrigin={{\r\n        vertical: 'top',\r\n        horizontal: 'left',\r\n      }}\r\n      transformOrigin={{\r\n        vertical: 'bottom',\r\n        horizontal: 'left',\r\n      }}\r\n    >\r\n      <StyledMenuItem onClick={() => handleMenuItemClick(onAttachFile)} darkMode={darkMode}>\r\n        <ListItemIcon>\r\n          <AttachFileIcon fontSize=\"small\" style={{ color: darkMode ? '#64b5f6' : '#1976d2' }} />\r\n        </ListItemIcon>\r\n        <ListItemText primary=\"Attach File\" />\r\n      </StyledMenuItem>\r\n\r\n      <StyledMenuItem onClick={() => handleMenuItemClick(onTakePhoto)} darkMode={darkMode}>\r\n        <ListItemIcon>\r\n          <CameraAltIcon fontSize=\"small\" style={{ color: darkMode ? '#ec407a' : '#e91e63' }} />\r\n        </ListItemIcon>\r\n        <ListItemText primary=\"Take Photo\" />\r\n      </StyledMenuItem>\r\n\r\n      <StyledMenuItem onClick={() => handleMenuItemClick(onShareLocation)} darkMode={darkMode}>\r\n        <ListItemIcon>\r\n          <LocationOnIcon fontSize=\"small\" style={{ color: darkMode ? '#66bb6a' : '#4caf50' }} />\r\n        </ListItemIcon>\r\n        <ListItemText primary=\"Share Location\" />\r\n      </StyledMenuItem>\r\n\r\n      <StyledMenuItem onClick={() => handleMenuItemClick(onCreatePoll)} darkMode={darkMode}>\r\n        <ListItemIcon>\r\n          <PollIcon fontSize=\"small\" style={{ color: darkMode ? '#ffa726' : '#ff9800' }} />\r\n        </ListItemIcon>\r\n        <ListItemText primary=\"Create Poll\" />\r\n      </StyledMenuItem>\r\n    </StyledMenu>\r\n  );\r\n}\r\n\r\nexport default AttachMenu;\r\n\r\nconst StyledMenu = styled(Menu)`\r\n  && {\r\n    .MuiPaper-root {\r\n      background-color: ${(props) => (props.darkMode ? \"#2a2a2a\" : \"#fff\")};\r\n      color: ${(props) => (props.darkMode ? \"#e0e0e0\" : \"#000\")};\r\n      border-radius: 8px;\r\n      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\r\n      min-width: 200px;\r\n    }\r\n  }\r\n`;\r\n\r\nconst StyledMenuItem = styled(MenuItem)`\r\n  && {\r\n    padding: 12px 16px;\r\n    color: ${(props) => (props.darkMode ? \"#e0e0e0\" : \"#000\")};\r\n\r\n    &:hover {\r\n      background-color: ${(props) =>\r\n        props.darkMode ? \"rgba(255,255,255,0.1)\" : \"rgba(0,0,0,0.05)\"};\r\n    }\r\n\r\n    .MuiListItemText-primary {\r\n      font-size: 14px;\r\n    }\r\n  }\r\n`;"],"names":[],"mappings":"AAAA,kDAAkD;;;;;;AAClD;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;;;;;;;;;AAEA,SAAS,WAAW,EAClB,QAAQ,EACR,IAAI,EACJ,OAAO,EACP,YAAY,EACZ,WAAW,EACX,eAAe,EACf,YAAY,EACZ,QAAQ,EACT;IACC,MAAM,sBAAsB,CAAC;QAC3B;QACA;IACF;IAEA,qBACE,qKAAC;QACC,UAAU;QACV,MAAM;QACN,SAAS;QACT,UAAU;QACV,cAAc;YACZ,UAAU;YACV,YAAY;QACd;QACA,iBAAiB;YACf,UAAU;YACV,YAAY;QACd;;0BAEA,qKAAC;gBAAe,SAAS,IAAM,oBAAoB;gBAAe,UAAU;;kCAC1E,qKAAC,qNAAY;kCACX,cAAA,qKAAC,4JAAc;4BAAC,UAAS;4BAAQ,OAAO;gCAAE,OAAO,WAAW,YAAY;4BAAU;;;;;;;;;;;kCAEpF,qKAAC,qNAAY;wBAAC,SAAQ;;;;;;;;;;;;0BAGxB,qKAAC;gBAAe,SAAS,IAAM,oBAAoB;gBAAc,UAAU;;kCACzE,qKAAC,qNAAY;kCACX,cAAA,qKAAC,2JAAa;4BAAC,UAAS;4BAAQ,OAAO;gCAAE,OAAO,WAAW,YAAY;4BAAU;;;;;;;;;;;kCAEnF,qKAAC,qNAAY;wBAAC,SAAQ;;;;;;;;;;;;0BAGxB,qKAAC;gBAAe,SAAS,IAAM,oBAAoB;gBAAkB,UAAU;;kCAC7E,qKAAC,qNAAY;kCACX,cAAA,qKAAC,4JAAc;4BAAC,UAAS;4BAAQ,OAAO;gCAAE,OAAO,WAAW,YAAY;4BAAU;;;;;;;;;;;kCAEpF,qKAAC,qNAAY;wBAAC,SAAQ;;;;;;;;;;;;0BAGxB,qKAAC;gBAAe,SAAS,IAAM,oBAAoB;gBAAe,UAAU;;kCAC1E,qKAAC,qNAAY;kCACX,cAAA,qKAAC,sJAAQ;4BAAC,UAAS;4BAAQ,OAAO;gCAAE,OAAO,WAAW,YAAY;4BAAU;;;;;;;;;;;kCAE9E,qKAAC,qNAAY;wBAAC,SAAQ;;;;;;;;;;;;;;;;;;AAI9B;uCAEe;AAEf,MAAM,aAAa,IAAA,4IAAM,EAAC,qLAAI,CAAC,CAAC;;;wBAGR,EAAE,CAAC,QAAW,MAAM,QAAQ,GAAG,YAAY,OAAQ;aAC9D,EAAE,CAAC,QAAW,MAAM,QAAQ,GAAG,YAAY,OAAQ;;;;;;AAMhE,CAAC;AAED,MAAM,iBAAiB,IAAA,4IAAM,EAAC,qMAAQ,CAAC,CAAC;;;WAG7B,EAAE,CAAC,QAAW,MAAM,QAAQ,GAAG,YAAY,OAAQ;;;wBAGtC,EAAE,CAAC,QACnB,MAAM,QAAQ,GAAG,0BAA0B,mBAAmB;;;;;;;AAOtE,CAAC","debugId":null}},
    {"offset": {"line": 7079, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/waels/OneDrive/Desktop/Expo%20projects/P3/components/ChatScreen/components/FileUploadDialog.jsx"],"sourcesContent":["// components/ChatScreen/components/FileUploadDialog.jsx\r\nimport React from \"react\";\r\nimport {\r\n  Dialog,\r\n  DialogTitle,\r\n  DialogContent,\r\n  DialogActions,\r\n  Button,\r\n  IconButton,\r\n  CircularProgress,\r\n} from \"@mui/material\";\r\nimport CloseIcon from \"@mui/icons-material/Close\";\r\nimport SendIcon from \"@mui/icons-material/Send\";\r\nimport { FilePreview, FileInfo, FileInput, UploadProgress } from \"../ChatScreen.styles\";\r\nimport { formatFileSize } from \"../utils\";\r\n\r\nconst FileUploadDialog = ({\r\n  open,\r\n  onClose,\r\n  file,\r\n  filePreview,\r\n  input,\r\n  onInputChange,\r\n  uploadProgress,\r\n  isUploading,\r\n  onSend,\r\n  darkMode,\r\n}) => {\r\n  return (\r\n    <Dialog\r\n      open={open}\r\n      onClose={onClose}\r\n      maxWidth=\"sm\"\r\n      fullWidth\r\n      PaperProps={{\r\n        style: {\r\n          backgroundColor: darkMode ? '#2a2a2a' : 'white',\r\n          color: darkMode ? '#e0e0e0' : 'black',\r\n        },\r\n      }}\r\n    >\r\n      <DialogTitle style={{ color: darkMode ? '#e0e0e0' : 'black' }}>\r\n        Send File\r\n        <IconButton\r\n          onClick={onClose}\r\n          style={{ position: 'absolute', right: 8, top: 8, color: darkMode ? '#e0e0e0' : 'inherit' }}\r\n        >\r\n          <CloseIcon />\r\n        </IconButton>\r\n      </DialogTitle>\r\n      <DialogContent>\r\n        {filePreview && (\r\n          <FilePreview>\r\n            <img src={filePreview} alt=\"Preview\" style={{ maxWidth: '100%', maxHeight: '300px' }} />\r\n          </FilePreview>\r\n        )}\r\n        <FileInfo darkMode={darkMode}>\r\n          <p><strong>File:</strong> {file?.name}</p>\r\n          <p><strong>Size:</strong> {formatFileSize(file?.size)} MB</p>\r\n          <p><strong>Type:</strong> {file?.type || 'Unknown'}</p>\r\n        </FileInfo>\r\n        <FileInput\r\n          darkMode={darkMode}\r\n          value={input}\r\n          onChange={(e) => onInputChange(e.target.value)}\r\n          placeholder=\"Add a message (optional)\"\r\n          type=\"text\"\r\n        />\r\n        {isUploading && (\r\n          <UploadProgress>\r\n            <CircularProgress variant=\"determinate\" value={uploadProgress} />\r\n            <p>{Math.round(uploadProgress)}%</p>\r\n          </UploadProgress>\r\n        )}\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={onClose} style={{ color: darkMode ? '#e0e0e0' : 'inherit' }}>\r\n          Cancel\r\n        </Button>\r\n        <Button\r\n          onClick={onSend}\r\n          variant=\"contained\"\r\n          disabled={isUploading}\r\n          style={{ backgroundColor: darkMode ? '#d32f2f' : '#f44336', color: 'white' }}\r\n          startIcon={<SendIcon />}\r\n        >\r\n          {isUploading ? 'Sending...' : 'Send'}\r\n        </Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default FileUploadDialog;"],"names":[],"mappings":"AAAA,wDAAwD;;;;;;AACxD;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AASA;AACA;AACA;AACA;;;;;;;;;;;;AAEA,MAAM,mBAAmB,CAAC,EACxB,IAAI,EACJ,OAAO,EACP,IAAI,EACJ,WAAW,EACX,KAAK,EACL,aAAa,EACb,cAAc,EACd,WAAW,EACX,MAAM,EACN,QAAQ,EACT;IACC,qBACE,qKAAC,6LAAM;QACL,MAAM;QACN,SAAS;QACT,UAAS;QACT,SAAS;QACT,YAAY;YACV,OAAO;gBACL,iBAAiB,WAAW,YAAY;gBACxC,OAAO,WAAW,YAAY;YAChC;QACF;;0BAEA,qKAAC,iNAAW;gBAAC,OAAO;oBAAE,OAAO,WAAW,YAAY;gBAAQ;;oBAAG;kCAE7D,qKAAC,6MAAU;wBACT,SAAS;wBACT,OAAO;4BAAE,UAAU;4BAAY,OAAO;4BAAG,KAAK;4BAAG,OAAO,WAAW,YAAY;wBAAU;kCAEzF,cAAA,qKAAC,uJAAS;;;;;;;;;;;;;;;;0BAGd,qKAAC,yNAAa;;oBACX,6BACC,qKAAC,wJAAW;kCACV,cAAA,qKAAC;4BAAI,KAAK;4BAAa,KAAI;4BAAU,OAAO;gCAAE,UAAU;gCAAQ,WAAW;4BAAQ;;;;;;;;;;;kCAGvF,qKAAC,qJAAQ;wBAAC,UAAU;;0CAClB,qKAAC;;kDAAE,qKAAC;kDAAO;;;;;;oCAAc;oCAAE,MAAM;;;;;;;0CACjC,qKAAC;;kDAAE,qKAAC;kDAAO;;;;;;oCAAc;oCAAE,IAAA,4IAAc,EAAC,MAAM;oCAAM;;;;;;;0CACtD,qKAAC;;kDAAE,qKAAC;kDAAO;;;;;;oCAAc;oCAAE,MAAM,QAAQ;;;;;;;;;;;;;kCAE3C,qKAAC,sJAAS;wBACR,UAAU;wBACV,OAAO;wBACP,UAAU,CAAC,IAAM,cAAc,EAAE,MAAM,CAAC,KAAK;wBAC7C,aAAY;wBACZ,MAAK;;;;;;oBAEN,6BACC,qKAAC,2JAAc;;0CACb,qKAAC,qOAAgB;gCAAC,SAAQ;gCAAc,OAAO;;;;;;0CAC/C,qKAAC;;oCAAG,KAAK,KAAK,CAAC;oCAAgB;;;;;;;;;;;;;;;;;;;0BAIrC,qKAAC,yNAAa;;kCACZ,qKAAC,6LAAM;wBAAC,SAAS;wBAAS,OAAO;4BAAE,OAAO,WAAW,YAAY;wBAAU;kCAAG;;;;;;kCAG9E,qKAAC,6LAAM;wBACL,SAAS;wBACT,SAAQ;wBACR,UAAU;wBACV,OAAO;4BAAE,iBAAiB,WAAW,YAAY;4BAAW,OAAO;wBAAQ;wBAC3E,yBAAW,qKAAC,sJAAQ;;;;;kCAEnB,cAAc,eAAe;;;;;;;;;;;;;;;;;;AAKxC;uCAEe","debugId":null}},
    {"offset": {"line": 7326, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/waels/OneDrive/Desktop/Expo%20projects/P3/components/ChatScreen/components/CameraDialog.jsx"],"sourcesContent":["// components/ChatScreen/components/CameraDialog.jsx\r\nimport React from \"react\";\r\nimport styled from \"styled-components\";\r\nimport { Dialog, DialogContent, DialogActions, Button, CircularProgress, TextField } from \"@mui/material\";\r\nimport CameraAltIcon from \"@mui/icons-material/CameraAlt\";\r\nimport SendIcon from \"@mui/icons-material/Send\";\r\nimport CancelIcon from \"@mui/icons-material/Cancel\";\r\nimport RefreshIcon from \"@mui/icons-material/Refresh\";\r\n\r\nfunction CameraDialog({\r\n  open,\r\n  showCamera,\r\n  capturedImage,\r\n  videoRef,\r\n  input,\r\n  onInputChange,\r\n  uploadProgress,\r\n  isUploading,\r\n  onCapture,\r\n  onRetake,\r\n  onCancel,\r\n  onSend,\r\n  darkMode,\r\n}) {\r\n  return (\r\n    <StyledDialog \r\n      open={open} \r\n      onClose={!isUploading ? onCancel : undefined} \r\n      maxWidth=\"sm\" \r\n      fullWidth \r\n      darkMode={darkMode}\r\n    >\r\n      <DialogContent>\r\n        {showCamera && (\r\n          <VideoContainer>\r\n            <Video ref={videoRef} autoPlay playsInline muted />\r\n          </VideoContainer>\r\n        )}\r\n\r\n        {capturedImage && (\r\n          <PreviewContainer>\r\n            <PreviewImage src={capturedImage} alt=\"Captured photo\" />\r\n            <TextField\r\n              fullWidth\r\n              placeholder=\"Add a caption (optional)\"\r\n              value={input}\r\n              onChange={(e) => onInputChange(e.target.value)}\r\n              variant=\"outlined\"\r\n              margin=\"normal\"\r\n              disabled={isUploading}\r\n              InputProps={{\r\n                style: {\r\n                  color: darkMode ? \"#e0e0e0\" : \"#000\",\r\n                  backgroundColor: darkMode ? \"#2a2a2a\" : \"#fff\",\r\n                },\r\n              }}\r\n            />\r\n            {isUploading && (\r\n              <ProgressContainer>\r\n                <CircularProgress variant=\"determinate\" value={uploadProgress} />\r\n                <ProgressText darkMode={darkMode}>{uploadProgress}%</ProgressText>\r\n              </ProgressContainer>\r\n            )}\r\n          </PreviewContainer>\r\n        )}\r\n      </DialogContent>\r\n\r\n      <DialogActions>\r\n        {showCamera && (\r\n          <>\r\n            <Button onClick={onCancel} color=\"secondary\" startIcon={<CancelIcon />}>\r\n              Cancel\r\n            </Button>\r\n            <Button \r\n              onClick={onCapture} \r\n              color=\"primary\" \r\n              variant=\"contained\" \r\n              startIcon={<CameraAltIcon />}\r\n            >\r\n              Capture\r\n            </Button>\r\n          </>\r\n        )}\r\n\r\n        {capturedImage && !showCamera && (\r\n          <>\r\n            <Button \r\n              onClick={onRetake} \r\n              color=\"secondary\" \r\n              startIcon={<RefreshIcon />} \r\n              disabled={isUploading}\r\n            >\r\n              Retake\r\n            </Button>\r\n            <Button \r\n              onClick={onCancel} \r\n              color=\"secondary\" \r\n              startIcon={<CancelIcon />} \r\n              disabled={isUploading}\r\n            >\r\n              Cancel\r\n            </Button>\r\n            <Button\r\n              onClick={onSend}\r\n              color=\"primary\"\r\n              variant=\"contained\"\r\n              startIcon={<SendIcon />}\r\n              disabled={isUploading}\r\n            >\r\n              {isUploading ? \"Sending...\" : \"Send\"}\r\n            </Button>\r\n          </>\r\n        )}\r\n      </DialogActions>\r\n    </StyledDialog>\r\n  );\r\n}\r\n\r\nexport default CameraDialog;\r\n\r\nconst StyledDialog = styled(Dialog)`\r\n  .MuiDialog-paper {\r\n    background-color: ${(props) => (props.darkMode ? \"#1e1e1e\" : \"#fff\")};\r\n    color: ${(props) => (props.darkMode ? \"#e0e0e0\" : \"#000\")};\r\n  }\r\n`;\r\n\r\nconst VideoContainer = styled.div`\r\n  width: 100%;\r\n  aspect-ratio: 4/3;\r\n  background: #000;\r\n  border-radius: 8px;\r\n  overflow: hidden;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n`;\r\n\r\nconst Video = styled.video`\r\n  width: 100%;\r\n  height: 100%;\r\n  object-fit: cover;\r\n`;\r\n\r\nconst PreviewContainer = styled.div`\r\n  width: 100%;\r\n`;\r\n\r\nconst PreviewImage = styled.img`\r\n  width: 100%;\r\n  max-height: 500px;\r\n  object-fit: contain;\r\n  border-radius: 8px;\r\n  margin-bottom: 16px;\r\n  background-color: #000;\r\n`;\r\n\r\nconst ProgressContainer = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  gap: 16px;\r\n  margin-top: 16px;\r\n`;\r\n\r\nconst ProgressText = styled.span`\r\n  color: ${(props) => (props.darkMode ? \"#e0e0e0\" : \"#333\")};\r\n  font-weight: 500;\r\n`;"],"names":[],"mappings":"AAAA,oDAAoD;;;;;;AACpD;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;;;;;;;;;AAEA,SAAS,aAAa,EACpB,IAAI,EACJ,UAAU,EACV,aAAa,EACb,QAAQ,EACR,KAAK,EACL,aAAa,EACb,cAAc,EACd,WAAW,EACX,SAAS,EACT,QAAQ,EACR,QAAQ,EACR,MAAM,EACN,QAAQ,EACT;IACC,qBACE,qKAAC;QACC,MAAM;QACN,SAAS,CAAC,cAAc,WAAW;QACnC,UAAS;QACT,SAAS;QACT,UAAU;;0BAEV,qKAAC,yNAAa;;oBACX,4BACC,qKAAC;kCACC,cAAA,qKAAC;4BAAM,KAAK;4BAAU,QAAQ;4BAAC,WAAW;4BAAC,KAAK;;;;;;;;;;;oBAInD,+BACC,qKAAC;;0CACC,qKAAC;gCAAa,KAAK;gCAAe,KAAI;;;;;;0CACtC,qKAAC,yMAAS;gCACR,SAAS;gCACT,aAAY;gCACZ,OAAO;gCACP,UAAU,CAAC,IAAM,cAAc,EAAE,MAAM,CAAC,KAAK;gCAC7C,SAAQ;gCACR,QAAO;gCACP,UAAU;gCACV,YAAY;oCACV,OAAO;wCACL,OAAO,WAAW,YAAY;wCAC9B,iBAAiB,WAAW,YAAY;oCAC1C;gCACF;;;;;;4BAED,6BACC,qKAAC;;kDACC,qKAAC,qOAAgB;wCAAC,SAAQ;wCAAc,OAAO;;;;;;kDAC/C,qKAAC;wCAAa,UAAU;;4CAAW;4CAAe;;;;;;;;;;;;;;;;;;;;;;;;;0BAO5D,qKAAC,yNAAa;;oBACX,4BACC;;0CACE,qKAAC,6LAAM;gCAAC,SAAS;gCAAU,OAAM;gCAAY,yBAAW,qKAAC,wJAAU;;;;;0CAAK;;;;;;0CAGxE,qKAAC,6LAAM;gCACL,SAAS;gCACT,OAAM;gCACN,SAAQ;gCACR,yBAAW,qKAAC,2JAAa;;;;;0CAC1B;;;;;;;;oBAMJ,iBAAiB,CAAC,4BACjB;;0CACE,qKAAC,6LAAM;gCACL,SAAS;gCACT,OAAM;gCACN,yBAAW,qKAAC,yJAAW;;;;;gCACvB,UAAU;0CACX;;;;;;0CAGD,qKAAC,6LAAM;gCACL,SAAS;gCACT,OAAM;gCACN,yBAAW,qKAAC,wJAAU;;;;;gCACtB,UAAU;0CACX;;;;;;0CAGD,qKAAC,6LAAM;gCACL,SAAS;gCACT,OAAM;gCACN,SAAQ;gCACR,yBAAW,qKAAC,sJAAQ;;;;;gCACpB,UAAU;0CAET,cAAc,eAAe;;;;;;;;;;;;;;;;;;;;AAO5C;uCAEe;AAEf,MAAM,eAAe,IAAA,4IAAM,EAAC,6LAAM,CAAC,CAAC;;sBAEd,EAAE,CAAC,QAAW,MAAM,QAAQ,GAAG,YAAY,OAAQ;WAC9D,EAAE,CAAC,QAAW,MAAM,QAAQ,GAAG,YAAY,OAAQ;;AAE9D,CAAC;AAED,MAAM,iBAAiB,4IAAM,CAAC,GAAG,CAAC;;;;;;;;;AASlC,CAAC;AAED,MAAM,QAAQ,4IAAM,CAAC,KAAK,CAAC;;;;AAI3B,CAAC;AAED,MAAM,mBAAmB,4IAAM,CAAC,GAAG,CAAC;;AAEpC,CAAC;AAED,MAAM,eAAe,4IAAM,CAAC,GAAG,CAAC;;;;;;;AAOhC,CAAC;AAED,MAAM,oBAAoB,4IAAM,CAAC,GAAG,CAAC;;;;;;AAMrC,CAAC;AAED,MAAM,eAAe,4IAAM,CAAC,IAAI,CAAC;SACxB,EAAE,CAAC,QAAW,MAAM,QAAQ,GAAG,YAAY,OAAQ;;AAE5D,CAAC","debugId":null}},
    {"offset": {"line": 7592, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/waels/OneDrive/Desktop/Expo%20projects/P3/components/ChatScreen/components/LocationPreviewDialog.jsx"],"sourcesContent":["// components/ChatScreen/components/LocationPreviewDialog.jsx\r\nimport React from \"react\";\r\nimport styled from \"styled-components\";\r\nimport { Dialog, DialogTitle, DialogContent, DialogActions, Button, TextField, CircularProgress } from \"@mui/material\";\r\nimport SendIcon from \"@mui/icons-material/Send\";\r\nimport CancelIcon from \"@mui/icons-material/Cancel\";\r\nimport LocationOnIcon from \"@mui/icons-material/LocationOn\";\r\nimport OpenInNewIcon from \"@mui/icons-material/OpenInNew\";\r\n\r\nfunction LocationPreviewDialog({\r\n  open,\r\n  locationData,\r\n  input,\r\n  onInputChange,\r\n  onCancel,\r\n  onSend,\r\n  isGettingLocation,\r\n  darkMode,\r\n}) {\r\n  if (isGettingLocation) {\r\n    return (\r\n      <StyledDialog open={open} onClose={onCancel} maxWidth=\"sm\" fullWidth darkMode={darkMode}>\r\n        <DialogContent>\r\n          <LoadingContainer>\r\n            <CircularProgress />\r\n            <LoadingText darkMode={darkMode}>Getting your location...</LoadingText>\r\n          </LoadingContainer>\r\n        </DialogContent>\r\n      </StyledDialog>\r\n    );\r\n  }\r\n\r\n  if (!locationData) return null;\r\n\r\n  const mapUrl = `https://www.openstreetmap.org/?mlat=${locationData.latitude}&mlon=${locationData.longitude}#map=15/${locationData.latitude}/${locationData.longitude}`;\r\n\r\n  return (\r\n    <StyledDialog open={open} onClose={onCancel} maxWidth=\"sm\" fullWidth darkMode={darkMode}>\r\n      <DialogTitle>\r\n        <TitleContainer>\r\n          <LocationOnIcon style={{ color: \"#f44336\", marginRight: \"8px\" }} />\r\n          Share Location\r\n        </TitleContainer>\r\n      </DialogTitle>\r\n\r\n      <DialogContent>\r\n        <MapContainer>\r\n          <MapFrame\r\n            src={`https://www.openstreetmap.org/export/embed.html?bbox=${locationData.longitude - 0.01},${locationData.latitude - 0.01},${locationData.longitude + 0.01},${locationData.latitude + 0.01}&layer=mapnik&marker=${locationData.latitude},${locationData.longitude}`}\r\n            title=\"Location preview\"\r\n          />\r\n        </MapContainer>\r\n        \r\n        <LocationInfo darkMode={darkMode}>\r\n          <InfoRow>\r\n            <strong>Latitude:</strong> {locationData.latitude.toFixed(6)}\r\n          </InfoRow>\r\n          <InfoRow>\r\n            <strong>Longitude:</strong> {locationData.longitude.toFixed(6)}\r\n          </InfoRow>\r\n          <ViewMapLink href={mapUrl} target=\"_blank\" rel=\"noopener noreferrer\" darkMode={darkMode}>\r\n            <OpenInNewIcon style={{ fontSize: 16, marginRight: 4 }} />\r\n            View on OpenStreetMap\r\n          </ViewMapLink>\r\n        </LocationInfo>\r\n\r\n        <TextField\r\n          fullWidth\r\n          placeholder=\"Add a message (optional)\"\r\n          value={input}\r\n          onChange={(e) => onInputChange(e.target.value)}\r\n          variant=\"outlined\"\r\n          margin=\"normal\"\r\n          InputProps={{\r\n            style: {\r\n              color: darkMode ? \"#e0e0e0\" : \"#000\",\r\n              backgroundColor: darkMode ? \"#2a2a2a\" : \"#fff\",\r\n            },\r\n          }}\r\n        />\r\n      </DialogContent>\r\n\r\n      <DialogActions>\r\n        <Button onClick={onCancel} color=\"secondary\" startIcon={<CancelIcon />}>\r\n          Cancel\r\n        </Button>\r\n        <Button onClick={onSend} color=\"primary\" variant=\"contained\" startIcon={<SendIcon />}>\r\n          Send Location\r\n        </Button>\r\n      </DialogActions>\r\n    </StyledDialog>\r\n  );\r\n}\r\n\r\nexport default LocationPreviewDialog;\r\n\r\nconst StyledDialog = styled(Dialog)`\r\n  .MuiDialog-paper {\r\n    background-color: ${(props) => (props.darkMode ? \"#1e1e1e\" : \"#fff\")};\r\n    color: ${(props) => (props.darkMode ? \"#e0e0e0\" : \"#000\")};\r\n  }\r\n`;\r\n\r\nconst TitleContainer = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n`;\r\n\r\nconst LoadingContainer = styled.div`\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  padding: 40px 20px;\r\n  gap: 16px;\r\n`;\r\n\r\nconst LoadingText = styled.p`\r\n  color: ${(props) => (props.darkMode ? \"#e0e0e0\" : \"#333\")};\r\n  font-size: 16px;\r\n  margin: 0;\r\n`;\r\n\r\nconst MapContainer = styled.div`\r\n  width: 100%;\r\n  height: 300px;\r\n  border-radius: 8px;\r\n  overflow: hidden;\r\n  background: #f0f0f0;\r\n  margin-bottom: 16px;\r\n`;\r\n\r\nconst MapFrame = styled.iframe`\r\n  width: 100%;\r\n  height: 100%;\r\n  border: none;\r\n`;\r\n\r\nconst LocationInfo = styled.div`\r\n  padding: 16px;\r\n  background-color: ${(props) => (props.darkMode ? \"#2a2a2a\" : \"#f5f5f5\")};\r\n  border-radius: 8px;\r\n  font-size: 14px;\r\n  color: ${(props) => (props.darkMode ? \"#e0e0e0\" : \"#333\")};\r\n`;\r\n\r\nconst InfoRow = styled.div`\r\n  margin-bottom: 8px;\r\n  line-height: 1.6;\r\n\r\n  &:last-child {\r\n    margin-bottom: 0;\r\n  }\r\n`;\r\n\r\nconst ViewMapLink = styled.a`\r\n  display: inline-flex;\r\n  align-items: center;\r\n  margin-top: 12px;\r\n  color: ${(props) => (props.darkMode ? \"#4CAF50\" : \"#128C7E\")};\r\n  text-decoration: none;\r\n  font-weight: 500;\r\n  font-size: 13px;\r\n\r\n  &:hover {\r\n    text-decoration: underline;\r\n  }\r\n`;"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 7915, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/waels/OneDrive/Desktop/Expo%20projects/P3/components/ChatScreen/components/VoiceRecordingDialog.jsx"],"sourcesContent":["// components/ChatScreen/components/VoiceRecordingDialog.jsx\r\nimport React from \"react\";\r\nimport {\r\n  Dialog,\r\n  DialogTitle,\r\n  DialogContent,\r\n  DialogActions,\r\n  Button,\r\n  CircularProgress,\r\n} from \"@mui/material\";\r\nimport SendIcon from \"@mui/icons-material/Send\";\r\nimport { VoicePreview, UploadProgress } from \"../ChatScreen.styles\";\r\nimport { formatTime } from \"../utils\";\r\n\r\nconst VoiceRecordingDialog = ({\r\n  open,\r\n  audioBlob,\r\n  recordingTime,\r\n  uploadProgress,\r\n  isUploading,\r\n  onCancel,\r\n  onSend,\r\n  onError,\r\n  darkMode,\r\n}) => {\r\n  return (\r\n    <Dialog\r\n      open={open}\r\n      onClose={onCancel}\r\n      maxWidth=\"sm\"\r\n      fullWidth\r\n      PaperProps={{\r\n        style: {\r\n          backgroundColor: darkMode ? '#2a2a2a' : 'white',\r\n          color: darkMode ? '#e0e0e0' : 'black',\r\n        },\r\n      }}\r\n    >\r\n      <DialogTitle style={{ color: darkMode ? '#e0e0e0' : 'black' }}>\r\n        Voice Message Recorded\r\n      </DialogTitle>\r\n      <DialogContent>\r\n        <VoicePreview darkMode={darkMode}>\r\n          <p>Duration: {formatTime(recordingTime)}</p>\r\n          {audioBlob && (\r\n            <>\r\n              <p style={{ fontSize: '12px', color: darkMode ? '#888' : '#666' }}>\r\n                Size: {(audioBlob.size / 1024).toFixed(2)} KB\r\n              </p>\r\n              <p style={{ fontSize: '12px', color: darkMode ? '#888' : '#666' }}>\r\n                Type: {audioBlob.type}\r\n              </p>\r\n              <audio \r\n                controls \r\n                src={URL.createObjectURL(audioBlob)} \r\n                style={{ width: '100%', marginTop: 10 }}\r\n                onError={(e) => {\r\n                  console.error('Audio playback error:', e);\r\n                  onError('Failed to play audio. The recording might be corrupted.');\r\n                }}\r\n              />\r\n            </>\r\n          )}\r\n        </VoicePreview>\r\n        {isUploading && (\r\n          <UploadProgress>\r\n            <CircularProgress variant=\"determinate\" value={uploadProgress} />\r\n            <p>{Math.round(uploadProgress)}%</p>\r\n          </UploadProgress>\r\n        )}\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={onCancel} disabled={isUploading} style={{ color: darkMode ? '#e0e0e0' : 'inherit' }}>\r\n          Cancel\r\n        </Button>\r\n        <Button\r\n          onClick={onSend}\r\n          variant=\"contained\"\r\n          disabled={isUploading || !audioBlob || audioBlob.size === 0}\r\n          style={{ backgroundColor: darkMode ? '#d32f2f' : '#f44336', color: 'white' }}\r\n          startIcon={<SendIcon />}\r\n        >\r\n          {isUploading ? 'Sending...' : 'Send'}\r\n        </Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default VoiceRecordingDialog;"],"names":[],"mappings":"AAAA,4DAA4D;;;;;;AAC5D;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQA;AACA;AACA;;;;;;;;;;;AAEA,MAAM,uBAAuB,CAAC,EAC5B,IAAI,EACJ,SAAS,EACT,aAAa,EACb,cAAc,EACd,WAAW,EACX,QAAQ,EACR,MAAM,EACN,OAAO,EACP,QAAQ,EACT;IACC,qBACE,qKAAC,6LAAM;QACL,MAAM;QACN,SAAS;QACT,UAAS;QACT,SAAS;QACT,YAAY;YACV,OAAO;gBACL,iBAAiB,WAAW,YAAY;gBACxC,OAAO,WAAW,YAAY;YAChC;QACF;;0BAEA,qKAAC,iNAAW;gBAAC,OAAO;oBAAE,OAAO,WAAW,YAAY;gBAAQ;0BAAG;;;;;;0BAG/D,qKAAC,yNAAa;;kCACZ,qKAAC,yJAAY;wBAAC,UAAU;;0CACtB,qKAAC;;oCAAE;oCAAW,IAAA,wIAAU,EAAC;;;;;;;4BACxB,2BACC;;kDACE,qKAAC;wCAAE,OAAO;4CAAE,UAAU;4CAAQ,OAAO,WAAW,SAAS;wCAAO;;4CAAG;4CAC1D,CAAC,UAAU,IAAI,GAAG,IAAI,EAAE,OAAO,CAAC;4CAAG;;;;;;;kDAE5C,qKAAC;wCAAE,OAAO;4CAAE,UAAU;4CAAQ,OAAO,WAAW,SAAS;wCAAO;;4CAAG;4CAC1D,UAAU,IAAI;;;;;;;kDAEvB,qKAAC;wCACC,QAAQ;wCACR,KAAK,IAAI,eAAe,CAAC;wCACzB,OAAO;4CAAE,OAAO;4CAAQ,WAAW;wCAAG;wCACtC,SAAS,CAAC;4CACR,QAAQ,KAAK,CAAC,yBAAyB;4CACvC,QAAQ;wCACV;;;;;;;;;;;;;;oBAKP,6BACC,qKAAC,2JAAc;;0CACb,qKAAC,qOAAgB;gCAAC,SAAQ;gCAAc,OAAO;;;;;;0CAC/C,qKAAC;;oCAAG,KAAK,KAAK,CAAC;oCAAgB;;;;;;;;;;;;;;;;;;;0BAIrC,qKAAC,yNAAa;;kCACZ,qKAAC,6LAAM;wBAAC,SAAS;wBAAU,UAAU;wBAAa,OAAO;4BAAE,OAAO,WAAW,YAAY;wBAAU;kCAAG;;;;;;kCAGtG,qKAAC,6LAAM;wBACL,SAAS;wBACT,SAAQ;wBACR,UAAU,eAAe,CAAC,aAAa,UAAU,IAAI,KAAK;wBAC1D,OAAO;4BAAE,iBAAiB,WAAW,YAAY;4BAAW,OAAO;wBAAQ;wBAC3E,yBAAW,qKAAC,sJAAQ;;;;;kCAEnB,cAAc,eAAe;;;;;;;;;;;;;;;;;;AAKxC;uCAEe","debugId":null}},
    {"offset": {"line": 8118, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/waels/OneDrive/Desktop/Expo%20projects/P3/components/ChatScreen/components/ChatInfoDialog.jsx"],"sourcesContent":["// components/ChatScreen/components/ChatInfoDialog.jsx\r\nimport React, { useState, useEffect } from \"react\";\r\nimport styled from \"styled-components\";\r\nimport {\r\n  Dialog,\r\n  DialogTitle,\r\n  DialogContent,\r\n  IconButton,\r\n  Avatar,\r\n  TextField,\r\n  Button,\r\n  Tabs,\r\n  Tab,\r\n  Box,\r\n} from \"@mui/material\";\r\nimport CloseIcon from \"@mui/icons-material/Close\";\r\nimport EditIcon from \"@mui/icons-material/Edit\";\r\nimport CheckIcon from \"@mui/icons-material/Check\";\r\nimport CancelIcon from \"@mui/icons-material/Cancel\";\r\nimport LinkIcon from \"@mui/icons-material/Link\";\r\nimport ImageIcon from \"@mui/icons-material/Image\";\r\nimport DescriptionIcon from \"@mui/icons-material/Description\";\r\nimport DownloadIcon from \"@mui/icons-material/Download\";\r\nimport OpenInNewIcon from \"@mui/icons-material/OpenInNew\";\r\nimport moment from \"moment\";\r\n\r\nfunction TabPanel({ children, value, index, ...other }) {\r\n  return (\r\n    <div\r\n      role=\"tabpanel\"\r\n      hidden={value !== index}\r\n      id={`tabpanel-${index}`}\r\n      aria-labelledby={`tab-${index}`}\r\n      {...other}\r\n    >\r\n      {value === index && <Box sx={{ p: 2 }}>{children}</Box>}\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction ChatInfoDialog({\r\n  open,\r\n  onClose,\r\n  recipient,\r\n  recipientEmail,\r\n  isSelfChat,\r\n  messages,\r\n  onUpdateDisplayName,\r\n  darkMode,\r\n}) {\r\n  const [isEditingName, setIsEditingName] = useState(false);\r\n  const [displayName, setDisplayName] = useState(\"\");\r\n  const [tabValue, setTabValue] = useState(0);\r\n\r\n  useEffect(() => {\r\n    if (recipient?.displayName) {\r\n      setDisplayName(recipient.displayName);\r\n    } else {\r\n      setDisplayName(recipientEmail?.split(\"@\")[0] || \"\");\r\n    }\r\n  }, [recipient, recipientEmail]);\r\n\r\n  const handleTabChange = (event, newValue) => {\r\n    setTabValue(newValue);\r\n  };\r\n\r\n  const handleSaveDisplayName = () => {\r\n    if (displayName.trim() && onUpdateDisplayName) {\r\n      onUpdateDisplayName(displayName.trim());\r\n    }\r\n    setIsEditingName(false);\r\n  };\r\n\r\n  const handleCancelEdit = () => {\r\n    // Reset to original name\r\n    if (recipient?.displayName) {\r\n      setDisplayName(recipient.displayName);\r\n    } else {\r\n      setDisplayName(recipientEmail?.split(\"@\")[0] || \"\");\r\n    }\r\n    setIsEditingName(false);\r\n  };\r\n\r\n  // Extract links from messages\r\n  const extractLinks = () => {\r\n    if (!messages) return [];\r\n    const urlRegex = /(https?:\\/\\/[^\\s]+)/g;\r\n    const links = [];\r\n\r\n    messages.forEach((msg) => {\r\n      if (msg.message) {\r\n        const urls = msg.message.match(urlRegex);\r\n        if (urls) {\r\n          urls.forEach((url) => {\r\n            links.push({\r\n              id: msg.id,\r\n              url,\r\n              message: msg.message,\r\n              timestamp: msg.timestamp,\r\n              user: msg.user,\r\n            });\r\n          });\r\n        }\r\n      }\r\n    });\r\n\r\n    return links.reverse();\r\n  };\r\n\r\n  // Extract media (images, videos, audio)\r\n  const extractMedia = () => {\r\n    if (!messages) return [];\r\n    const media = [];\r\n\r\n    messages.forEach((msg) => {\r\n      if (msg.fileURL && msg.fileType) {\r\n        if (\r\n          msg.fileType.startsWith(\"image/\") ||\r\n          msg.fileType.startsWith(\"video/\") ||\r\n          msg.fileType.startsWith(\"audio/\")\r\n        ) {\r\n          media.push({\r\n            id: msg.id,\r\n            url: msg.fileURL,\r\n            fileName: msg.fileName,\r\n            fileType: msg.fileType,\r\n            fileSize: msg.fileSize,\r\n            timestamp: msg.timestamp,\r\n            user: msg.user,\r\n          });\r\n        }\r\n      }\r\n    });\r\n\r\n    return media.reverse();\r\n  };\r\n\r\n  // Extract documents\r\n  const extractDocuments = () => {\r\n    if (!messages) return [];\r\n    const docs = [];\r\n\r\n    messages.forEach((msg) => {\r\n      if (msg.fileURL && msg.fileType) {\r\n        if (\r\n          !msg.fileType.startsWith(\"image/\") &&\r\n          !msg.fileType.startsWith(\"video/\") &&\r\n          !msg.fileType.startsWith(\"audio/\")\r\n        ) {\r\n          docs.push({\r\n            id: msg.id,\r\n            url: msg.fileURL,\r\n            fileName: msg.fileName,\r\n            fileType: msg.fileType,\r\n            fileSize: msg.fileSize,\r\n            timestamp: msg.timestamp,\r\n            user: msg.user,\r\n          });\r\n        }\r\n      }\r\n    });\r\n\r\n    return docs.reverse();\r\n  };\r\n\r\n  const links = extractLinks();\r\n  const media = extractMedia();\r\n  const documents = extractDocuments();\r\n\r\n  const formatFileSize = (bytes) => {\r\n    if (!bytes) return \"Unknown size\";\r\n    const k = 1024;\r\n    const sizes = [\"Bytes\", \"KB\", \"MB\", \"GB\"];\r\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\r\n    return Math.round((bytes / Math.pow(k, i)) * 100) / 100 + \" \" + sizes[i];\r\n  };\r\n\r\n  const downloadFile = async (url, fileName) => {\r\n    try {\r\n      const response = await fetch(url);\r\n      const blob = await response.blob();\r\n      const blobUrl = window.URL.createObjectURL(blob);\r\n      const link = document.createElement(\"a\");\r\n      link.href = blobUrl;\r\n      link.download = fileName || \"download\";\r\n      document.body.appendChild(link);\r\n      link.click();\r\n      document.body.removeChild(link);\r\n      setTimeout(() => window.URL.revokeObjectURL(blobUrl), 100);\r\n    } catch (error) {\r\n      console.error(\"Download failed:\", error);\r\n      window.open(url, \"_blank\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    <StyledDialog open={open} onClose={onClose} maxWidth=\"sm\" fullWidth darkMode={darkMode}>\r\n      <DialogTitle>\r\n        <HeaderContainer>\r\n          <span>Chat Info</span>\r\n          <IconButton onClick={onClose} size=\"small\">\r\n            <CloseIcon style={{ color: darkMode ? \"#e0e0e0\" : \"#000\" }} />\r\n          </IconButton>\r\n        </HeaderContainer>\r\n      </DialogTitle>\r\n\r\n      <DialogContent>\r\n        {/* Profile Section */}\r\n        <ProfileSection darkMode={darkMode}>\r\n          <LargeAvatar src={recipient?.photoURL}>\r\n            {recipientEmail?.[0]?.toUpperCase()}\r\n          </LargeAvatar>\r\n\r\n          {/* Display Name Section */}\r\n          <NameSection>\r\n            {isEditingName ? (\r\n              <>\r\n                <NameEditContainer>\r\n                  <TextField\r\n                    fullWidth\r\n                    value={displayName}\r\n                    onChange={(e) => setDisplayName(e.target.value)}\r\n                    variant=\"outlined\"\r\n                    size=\"medium\"\r\n                    autoFocus\r\n                    placeholder=\"Enter display name\"\r\n                    InputProps={{\r\n                      style: {\r\n                        color: darkMode ? \"#e0e0e0\" : \"#000\",\r\n                        backgroundColor: darkMode ? \"#2a2a2a\" : \"#fff\",\r\n                      },\r\n                    }}\r\n                  />\r\n                </NameEditContainer>\r\n                <EditButtonsContainer>\r\n                  <Button\r\n                    onClick={handleCancelEdit}\r\n                    startIcon={<CancelIcon />}\r\n                    variant=\"outlined\"\r\n                    color=\"secondary\"\r\n                  >\r\n                    Cancel\r\n                  </Button>\r\n                  <Button\r\n                    onClick={handleSaveDisplayName}\r\n                    startIcon={<CheckIcon />}\r\n                    variant=\"contained\"\r\n                    color=\"primary\"\r\n                    disabled={!displayName.trim()}\r\n                  >\r\n                    Save\r\n                  </Button>\r\n                </EditButtonsContainer>\r\n              </>\r\n            ) : (\r\n              <>\r\n                <DisplayNameText darkMode={darkMode}>\r\n                  {displayName || recipientEmail}\r\n                </DisplayNameText>\r\n                <EmailText darkMode={darkMode}>{recipientEmail}</EmailText>\r\n                \r\n                {!isSelfChat && (\r\n                  <ChangeNameButton\r\n                    onClick={() => setIsEditingName(true)}\r\n                    startIcon={<EditIcon />}\r\n                    variant=\"outlined\"\r\n                    darkMode={darkMode}\r\n                  >\r\n                    Change Display Name\r\n                  </ChangeNameButton>\r\n                )}\r\n              </>\r\n            )}\r\n          </NameSection>\r\n        </ProfileSection>\r\n\r\n        {/* Tabs */}\r\n        <StyledTabs\r\n          value={tabValue}\r\n          onChange={handleTabChange}\r\n          darkMode={darkMode}\r\n          variant=\"fullWidth\"\r\n        >\r\n          <StyledTab\r\n            icon={<LinkIcon />}\r\n            label={`Links (${links.length})`}\r\n            darkMode={darkMode}\r\n          />\r\n          <StyledTab\r\n            icon={<ImageIcon />}\r\n            label={`Media (${media.length})`}\r\n            darkMode={darkMode}\r\n          />\r\n          <StyledTab\r\n            icon={<DescriptionIcon />}\r\n            label={`Docs (${documents.length})`}\r\n            darkMode={darkMode}\r\n          />\r\n        </StyledTabs>\r\n\r\n        {/* Links Tab */}\r\n        <TabPanel value={tabValue} index={0}>\r\n          <TabContent darkMode={darkMode}>\r\n            {links.length === 0 ? (\r\n              <EmptyState darkMode={darkMode}>\r\n                <LinkIcon style={{ fontSize: 48, opacity: 0.3 }} />\r\n                <p>No links shared yet</p>\r\n              </EmptyState>\r\n            ) : (\r\n              links.map((link, index) => (\r\n                <LinkItem key={`${link.id}-${index}`} darkMode={darkMode}>\r\n                  <LinkIcon style={{ color: darkMode ? \"#64b5f6\" : \"#1976d2\", fontSize: 20 }} />\r\n                  <LinkContent>\r\n                    <LinkUrl\r\n                      href={link.url}\r\n                      target=\"_blank\"\r\n                      rel=\"noopener noreferrer\"\r\n                      darkMode={darkMode}\r\n                    >\r\n                      {link.url}\r\n                      <OpenInNewIcon style={{ fontSize: 14, marginLeft: 4 }} />\r\n                    </LinkUrl>\r\n                    <LinkMeta darkMode={darkMode}>\r\n                      {link.user} â€¢ {moment(link.timestamp).format(\"MMM D, YYYY\")}\r\n                    </LinkMeta>\r\n                  </LinkContent>\r\n                </LinkItem>\r\n              ))\r\n            )}\r\n          </TabContent>\r\n        </TabPanel>\r\n\r\n        {/* Media Tab */}\r\n        <TabPanel value={tabValue} index={1}>\r\n          <TabContent darkMode={darkMode}>\r\n            {media.length === 0 ? (\r\n              <EmptyState darkMode={darkMode}>\r\n                <ImageIcon style={{ fontSize: 48, opacity: 0.3 }} />\r\n                <p>No media shared yet</p>\r\n              </EmptyState>\r\n            ) : (\r\n              <MediaGrid>\r\n                {media.map((item) => (\r\n                  <MediaItem key={item.id} darkMode={darkMode}>\r\n                    {item.fileType.startsWith(\"image/\") ? (\r\n                      <MediaImage\r\n                        src={item.url}\r\n                        alt={item.fileName}\r\n                        onClick={() => window.open(item.url, \"_blank\")}\r\n                      />\r\n                    ) : item.fileType.startsWith(\"video/\") ? (\r\n                      <MediaVideo controls>\r\n                        <source src={item.url} type={item.fileType} />\r\n                      </MediaVideo>\r\n                    ) : (\r\n                      <AudioContainer darkMode={darkMode}>\r\n                        <audio controls style={{ width: \"100%\" }}>\r\n                          <source src={item.url} type={item.fileType} />\r\n                        </audio>\r\n                      </AudioContainer>\r\n                    )}\r\n                    <MediaInfo darkMode={darkMode}>\r\n                      <MediaName>{item.fileName}</MediaName>\r\n                      <MediaMeta darkMode={darkMode}>\r\n                        {formatFileSize(item.fileSize)} â€¢{\" \"}\r\n                        {moment(item.timestamp).format(\"MMM D\")}\r\n                      </MediaMeta>\r\n                    </MediaInfo>\r\n                    <DownloadIconButton\r\n                      onClick={() => downloadFile(item.url, item.fileName)}\r\n                      size=\"small\"\r\n                    >\r\n                      <DownloadIcon fontSize=\"small\" />\r\n                    </DownloadIconButton>\r\n                  </MediaItem>\r\n                ))}\r\n              </MediaGrid>\r\n            )}\r\n          </TabContent>\r\n        </TabPanel>\r\n\r\n        {/* Documents Tab */}\r\n        <TabPanel value={tabValue} index={2}>\r\n          <TabContent darkMode={darkMode}>\r\n            {documents.length === 0 ? (\r\n              <EmptyState darkMode={darkMode}>\r\n                <DescriptionIcon style={{ fontSize: 48, opacity: 0.3 }} />\r\n                <p>No documents shared yet</p>\r\n              </EmptyState>\r\n            ) : (\r\n              documents.map((doc) => (\r\n                <DocumentItem key={doc.id} darkMode={darkMode}>\r\n                  <DescriptionIcon\r\n                    style={{ color: darkMode ? \"#64b5f6\" : \"#1976d2\", fontSize: 32 }}\r\n                  />\r\n                  <DocumentContent>\r\n                    <DocumentName darkMode={darkMode}>{doc.fileName}</DocumentName>\r\n                    <DocumentMeta darkMode={darkMode}>\r\n                      {formatFileSize(doc.fileSize)} â€¢ {doc.user} â€¢{\" \"}\r\n                      {moment(doc.timestamp).format(\"MMM D, YYYY\")}\r\n                    </DocumentMeta>\r\n                  </DocumentContent>\r\n                  <DownloadIconButton\r\n                    onClick={() => downloadFile(doc.url, doc.fileName)}\r\n                    size=\"small\"\r\n                  >\r\n                    <DownloadIcon fontSize=\"small\" />\r\n                  </DownloadIconButton>\r\n                </DocumentItem>\r\n              ))\r\n            )}\r\n          </TabContent>\r\n        </TabPanel>\r\n      </DialogContent>\r\n    </StyledDialog>\r\n  );\r\n}\r\n\r\nexport default ChatInfoDialog;\r\n\r\n// Styled Components\r\nconst StyledDialog = styled(Dialog)`\r\n  .MuiDialog-paper {\r\n    background-color: ${(props) => (props.darkMode ? \"#1e1e1e\" : \"#fff\")};\r\n    color: ${(props) => (props.darkMode ? \"#e0e0e0\" : \"#000\")};\r\n    min-height: 600px;\r\n  }\r\n`;\r\n\r\nconst HeaderContainer = styled.div`\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n`;\r\n\r\nconst ProfileSection = styled.div`\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  padding: 20px 0;\r\n  border-bottom: 1px solid ${(props) => (props.darkMode ? \"#333\" : \"#e0e0e0\")};\r\n`;\r\n\r\nconst LargeAvatar = styled(Avatar)`\r\n  && {\r\n    width: 100px;\r\n    height: 100px;\r\n    font-size: 48px;\r\n    margin-bottom: 16px;\r\n  }\r\n`;\r\n\r\nconst NameSection = styled.div`\r\n  width: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  gap: 12px;\r\n`;\r\n\r\nconst NameEditContainer = styled.div`\r\n  width: 100%;\r\n  max-width: 400px;\r\n`;\r\n\r\nconst EditButtonsContainer = styled.div`\r\n  display: flex;\r\n  gap: 12px;\r\n  margin-top: 8px;\r\n`;\r\n\r\nconst DisplayNameText = styled.h2`\r\n  margin: 0;\r\n  font-size: 24px;\r\n  font-weight: 500;\r\n  color: ${(props) => (props.darkMode ? \"#e0e0e0\" : \"#000\")};\r\n  text-align: center;\r\n`;\r\n\r\nconst EmailText = styled.p`\r\n  margin: 0;\r\n  color: ${(props) => (props.darkMode ? \"#888\" : \"#666\")};\r\n  font-size: 14px;\r\n`;\r\n\r\nconst ChangeNameButton = styled(Button)`\r\n  && {\r\n    margin-top: 12px;\r\n    color: ${(props) => (props.darkMode ? \"#25D366\" : \"#128C7E\")};\r\n    border-color: ${(props) => (props.darkMode ? \"#25D366\" : \"#128C7E\")};\r\n    text-transform: none;\r\n    \r\n    &:hover {\r\n      border-color: ${(props) => (props.darkMode ? \"#1fa855\" : \"#0d6b5f\")};\r\n      background-color: ${(props) => (props.darkMode ? \"rgba(37, 211, 102, 0.1)\" : \"rgba(18, 140, 126, 0.1)\")};\r\n    }\r\n  }\r\n`;\r\n\r\nconst StyledTabs = styled(Tabs)`\r\n  && {\r\n    margin-top: 16px;\r\n    border-bottom: 1px solid ${(props) => (props.darkMode ? \"#333\" : \"#e0e0e0\")};\r\n\r\n    .MuiTabs-indicator {\r\n      background-color: ${(props) => (props.darkMode ? \"#25D366\" : \"#128C7E\")};\r\n    }\r\n  }\r\n`;\r\n\r\nconst StyledTab = styled(Tab)`\r\n  && {\r\n    color: ${(props) => (props.darkMode ? \"#888\" : \"#666\")};\r\n    text-transform: none;\r\n    font-size: 13px;\r\n\r\n    &.Mui-selected {\r\n      color: ${(props) => (props.darkMode ? \"#25D366\" : \"#128C7E\")};\r\n    }\r\n  }\r\n`;\r\n\r\nconst TabContent = styled.div`\r\n  max-height: 400px;\r\n  overflow-y: auto;\r\n\r\n  &::-webkit-scrollbar {\r\n    width: 8px;\r\n  }\r\n\r\n  &::-webkit-scrollbar-track {\r\n    background: ${(props) => (props.darkMode ? \"#2a2a2a\" : \"#f1f1f1\")};\r\n  }\r\n\r\n  &::-webkit-scrollbar-thumb {\r\n    background: ${(props) => (props.darkMode ? \"#555\" : \"#888\")};\r\n    border-radius: 4px;\r\n  }\r\n`;\r\n\r\nconst EmptyState = styled.div`\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  padding: 60px 20px;\r\n  color: ${(props) => (props.darkMode ? \"#666\" : \"#999\")};\r\n\r\n  p {\r\n    margin-top: 16px;\r\n    font-size: 16px;\r\n  }\r\n`;\r\n\r\nconst LinkItem = styled.div`\r\n  display: flex;\r\n  gap: 12px;\r\n  padding: 12px;\r\n  border-radius: 8px;\r\n  margin-bottom: 8px;\r\n  background-color: ${(props) => (props.darkMode ? \"#2a2a2a\" : \"#f5f5f5\")};\r\n  transition: background-color 0.2s;\r\n\r\n  &:hover {\r\n    background-color: ${(props) => (props.darkMode ? \"#333\" : \"#e8e8e8\")};\r\n  }\r\n`;\r\n\r\nconst LinkContent = styled.div`\r\n  flex: 1;\r\n  min-width: 0;\r\n`;\r\n\r\nconst LinkUrl = styled.a`\r\n  display: flex;\r\n  align-items: center;\r\n  color: ${(props) => (props.darkMode ? \"#64b5f6\" : \"#1976d2\")};\r\n  text-decoration: none;\r\n  font-size: 14px;\r\n  word-break: break-all;\r\n  margin-bottom: 4px;\r\n\r\n  &:hover {\r\n    text-decoration: underline;\r\n  }\r\n`;\r\n\r\nconst LinkMeta = styled.div`\r\n  font-size: 12px;\r\n  color: ${(props) => (props.darkMode ? \"#888\" : \"#666\")};\r\n`;\r\n\r\nconst MediaGrid = styled.div`\r\n  display: grid;\r\n  grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));\r\n  gap: 12px;\r\n`;\r\n\r\nconst MediaItem = styled.div`\r\n  position: relative;\r\n  border-radius: 8px;\r\n  overflow: hidden;\r\n  background-color: ${(props) => (props.darkMode ? \"#2a2a2a\" : \"#f5f5f5\")};\r\n\r\n  &:hover {\r\n    .download-btn {\r\n      opacity: 1;\r\n    }\r\n  }\r\n`;\r\n\r\nconst MediaImage = styled.img`\r\n  width: 100%;\r\n  height: 150px;\r\n  object-fit: cover;\r\n  cursor: pointer;\r\n  transition: transform 0.2s;\r\n\r\n  &:hover {\r\n    transform: scale(1.05);\r\n  }\r\n`;\r\n\r\nconst MediaVideo = styled.video`\r\n  width: 100%;\r\n  height: 150px;\r\n  object-fit: cover;\r\n`;\r\n\r\nconst AudioContainer = styled.div`\r\n  padding: 12px;\r\n  background-color: ${(props) => (props.darkMode ? \"#2a2a2a\" : \"#f0f0f0\")};\r\n`;\r\n\r\nconst MediaInfo = styled.div`\r\n  padding: 8px;\r\n`;\r\n\r\nconst MediaName = styled.div`\r\n  font-size: 12px;\r\n  font-weight: 500;\r\n  white-space: nowrap;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n`;\r\n\r\nconst MediaMeta = styled.div`\r\n  font-size: 11px;\r\n  color: ${(props) => (props.darkMode ? \"#888\" : \"#666\")};\r\n  margin-top: 4px;\r\n`;\r\n\r\nconst DocumentItem = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 12px;\r\n  padding: 12px;\r\n  border-radius: 8px;\r\n  margin-bottom: 8px;\r\n  background-color: ${(props) => (props.darkMode ? \"#2a2a2a\" : \"#f5f5f5\")};\r\n  transition: background-color 0.2s;\r\n\r\n  &:hover {\r\n    background-color: ${(props) => (props.darkMode ? \"#333\" : \"#e8e8e8\")};\r\n  }\r\n`;\r\n\r\nconst DocumentContent = styled.div`\r\n  flex: 1;\r\n  min-width: 0;\r\n`;\r\n\r\nconst DocumentName = styled.div`\r\n  font-size: 14px;\r\n  font-weight: 500;\r\n  color: ${(props) => (props.darkMode ? \"#e0e0e0\" : \"#000\")};\r\n  white-space: nowrap;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  margin-bottom: 4px;\r\n`;\r\n\r\nconst DocumentMeta = styled.div`\r\n  font-size: 12px;\r\n  color: ${(props) => (props.darkMode ? \"#888\" : \"#666\")};\r\n`;\r\n\r\nconst DownloadIconButton = styled(IconButton)`\r\n  && {\r\n    opacity: 0.7;\r\n    transition: opacity 0.2s;\r\n\r\n    &:hover {\r\n      opacity: 1;\r\n    }\r\n  }\r\n`;"],"names":[],"mappings":"AAAA,sDAAsD;;;;;;AACtD;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;AAEA,SAAS,SAAS,EAAE,QAAQ,EAAE,KAAK,EAAE,KAAK,EAAE,GAAG,OAAO;IACpD,qBACE,qKAAC;QACC,MAAK;QACL,QAAQ,UAAU;QAClB,IAAI,CAAC,SAAS,EAAE,OAAO;QACvB,mBAAiB,CAAC,IAAI,EAAE,OAAO;QAC9B,GAAG,KAAK;kBAER,UAAU,uBAAS,qKAAC,iLAAG;YAAC,IAAI;gBAAE,GAAG;YAAE;sBAAI;;;;;;;;;;;AAG9C;AAEA,SAAS,eAAe,EACtB,IAAI,EACJ,OAAO,EACP,SAAS,EACT,cAAc,EACd,UAAU,EACV,QAAQ,EACR,mBAAmB,EACnB,QAAQ,EACT;IACC,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,+GAAQ,EAAC;IACnD,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,+GAAQ,EAAC;IAC/C,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,+GAAQ,EAAC;IAEzC,IAAA,gHAAS,EAAC;QACR,IAAI,WAAW,aAAa;YAC1B,eAAe,UAAU,WAAW;QACtC,OAAO;YACL,eAAe,gBAAgB,MAAM,IAAI,CAAC,EAAE,IAAI;QAClD;IACF,GAAG;QAAC;QAAW;KAAe;IAE9B,MAAM,kBAAkB,CAAC,OAAO;QAC9B,YAAY;IACd;IAEA,MAAM,wBAAwB;QAC5B,IAAI,YAAY,IAAI,MAAM,qBAAqB;YAC7C,oBAAoB,YAAY,IAAI;QACtC;QACA,iBAAiB;IACnB;IAEA,MAAM,mBAAmB;QACvB,yBAAyB;QACzB,IAAI,WAAW,aAAa;YAC1B,eAAe,UAAU,WAAW;QACtC,OAAO;YACL,eAAe,gBAAgB,MAAM,IAAI,CAAC,EAAE,IAAI;QAClD;QACA,iBAAiB;IACnB;IAEA,8BAA8B;IAC9B,MAAM,eAAe;QACnB,IAAI,CAAC,UAAU,OAAO,EAAE;QACxB,MAAM,WAAW;QACjB,MAAM,QAAQ,EAAE;QAEhB,SAAS,OAAO,CAAC,CAAC;YAChB,IAAI,IAAI,OAAO,EAAE;gBACf,MAAM,OAAO,IAAI,OAAO,CAAC,KAAK,CAAC;gBAC/B,IAAI,MAAM;oBACR,KAAK,OAAO,CAAC,CAAC;wBACZ,MAAM,IAAI,CAAC;4BACT,IAAI,IAAI,EAAE;4BACV;4BACA,SAAS,IAAI,OAAO;4BACpB,WAAW,IAAI,SAAS;4BACxB,MAAM,IAAI,IAAI;wBAChB;oBACF;gBACF;YACF;QACF;QAEA,OAAO,MAAM,OAAO;IACtB;IAEA,wCAAwC;IACxC,MAAM,eAAe;QACnB,IAAI,CAAC,UAAU,OAAO,EAAE;QACxB,MAAM,QAAQ,EAAE;QAEhB,SAAS,OAAO,CAAC,CAAC;YAChB,IAAI,IAAI,OAAO,IAAI,IAAI,QAAQ,EAAE;gBAC/B,IACE,IAAI,QAAQ,CAAC,UAAU,CAAC,aACxB,IAAI,QAAQ,CAAC,UAAU,CAAC,aACxB,IAAI,QAAQ,CAAC,UAAU,CAAC,WACxB;oBACA,MAAM,IAAI,CAAC;wBACT,IAAI,IAAI,EAAE;wBACV,KAAK,IAAI,OAAO;wBAChB,UAAU,IAAI,QAAQ;wBACtB,UAAU,IAAI,QAAQ;wBACtB,UAAU,IAAI,QAAQ;wBACtB,WAAW,IAAI,SAAS;wBACxB,MAAM,IAAI,IAAI;oBAChB;gBACF;YACF;QACF;QAEA,OAAO,MAAM,OAAO;IACtB;IAEA,oBAAoB;IACpB,MAAM,mBAAmB;QACvB,IAAI,CAAC,UAAU,OAAO,EAAE;QACxB,MAAM,OAAO,EAAE;QAEf,SAAS,OAAO,CAAC,CAAC;YAChB,IAAI,IAAI,OAAO,IAAI,IAAI,QAAQ,EAAE;gBAC/B,IACE,CAAC,IAAI,QAAQ,CAAC,UAAU,CAAC,aACzB,CAAC,IAAI,QAAQ,CAAC,UAAU,CAAC,aACzB,CAAC,IAAI,QAAQ,CAAC,UAAU,CAAC,WACzB;oBACA,KAAK,IAAI,CAAC;wBACR,IAAI,IAAI,EAAE;wBACV,KAAK,IAAI,OAAO;wBAChB,UAAU,IAAI,QAAQ;wBACtB,UAAU,IAAI,QAAQ;wBACtB,UAAU,IAAI,QAAQ;wBACtB,WAAW,IAAI,SAAS;wBACxB,MAAM,IAAI,IAAI;oBAChB;gBACF;YACF;QACF;QAEA,OAAO,KAAK,OAAO;IACrB;IAEA,MAAM,QAAQ;IACd,MAAM,QAAQ;IACd,MAAM,YAAY;IAElB,MAAM,iBAAiB,CAAC;QACtB,IAAI,CAAC,OAAO,OAAO;QACnB,MAAM,IAAI;QACV,MAAM,QAAQ;YAAC;YAAS;YAAM;YAAM;SAAK;QACzC,MAAM,IAAI,KAAK,KAAK,CAAC,KAAK,GAAG,CAAC,SAAS,KAAK,GAAG,CAAC;QAChD,OAAO,KAAK,KAAK,CAAC,AAAC,QAAQ,KAAK,GAAG,CAAC,GAAG,KAAM,OAAO,MAAM,MAAM,KAAK,CAAC,EAAE;IAC1E;IAEA,MAAM,eAAe,OAAO,KAAK;QAC/B,IAAI;YACF,MAAM,WAAW,MAAM,MAAM;YAC7B,MAAM,OAAO,MAAM,SAAS,IAAI;YAChC,MAAM,UAAU,OAAO,GAAG,CAAC,eAAe,CAAC;YAC3C,MAAM,OAAO,SAAS,aAAa,CAAC;YACpC,KAAK,IAAI,GAAG;YACZ,KAAK,QAAQ,GAAG,YAAY;YAC5B,SAAS,IAAI,CAAC,WAAW,CAAC;YAC1B,KAAK,KAAK;YACV,SAAS,IAAI,CAAC,WAAW,CAAC;YAC1B,WAAW,IAAM,OAAO,GAAG,CAAC,eAAe,CAAC,UAAU;QACxD,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,oBAAoB;YAClC,OAAO,IAAI,CAAC,KAAK;QACnB;IACF;IAEA,qBACE,qKAAC;QAAa,MAAM;QAAM,SAAS;QAAS,UAAS;QAAK,SAAS;QAAC,UAAU;;0BAC5E,qKAAC,iNAAW;0BACV,cAAA,qKAAC;;sCACC,qKAAC;sCAAK;;;;;;sCACN,qKAAC,6MAAU;4BAAC,SAAS;4BAAS,MAAK;sCACjC,cAAA,qKAAC,uJAAS;gCAAC,OAAO;oCAAE,OAAO,WAAW,YAAY;gCAAO;;;;;;;;;;;;;;;;;;;;;;0BAK/D,qKAAC,yNAAa;;kCAEZ,qKAAC;wBAAe,UAAU;;0CACxB,qKAAC;gCAAY,KAAK,WAAW;0CAC1B,gBAAgB,CAAC,EAAE,EAAE;;;;;;0CAIxB,qKAAC;0CACE,8BACC;;sDACE,qKAAC;sDACC,cAAA,qKAAC,yMAAS;gDACR,SAAS;gDACT,OAAO;gDACP,UAAU,CAAC,IAAM,eAAe,EAAE,MAAM,CAAC,KAAK;gDAC9C,SAAQ;gDACR,MAAK;gDACL,SAAS;gDACT,aAAY;gDACZ,YAAY;oDACV,OAAO;wDACL,OAAO,WAAW,YAAY;wDAC9B,iBAAiB,WAAW,YAAY;oDAC1C;gDACF;;;;;;;;;;;sDAGJ,qKAAC;;8DACC,qKAAC,6LAAM;oDACL,SAAS;oDACT,yBAAW,qKAAC,wJAAU;;;;;oDACtB,SAAQ;oDACR,OAAM;8DACP;;;;;;8DAGD,qKAAC,6LAAM;oDACL,SAAS;oDACT,yBAAW,qKAAC,uJAAS;;;;;oDACrB,SAAQ;oDACR,OAAM;oDACN,UAAU,CAAC,YAAY,IAAI;8DAC5B;;;;;;;;;;;;;iEAML;;sDACE,qKAAC;4CAAgB,UAAU;sDACxB,eAAe;;;;;;sDAElB,qKAAC;4CAAU,UAAU;sDAAW;;;;;;wCAE/B,CAAC,4BACA,qKAAC;4CACC,SAAS,IAAM,iBAAiB;4CAChC,yBAAW,qKAAC,sJAAQ;;;;;4CACpB,SAAQ;4CACR,UAAU;sDACX;;;;;;;;;;;;;;;;;;;kCAUX,qKAAC;wBACC,OAAO;wBACP,UAAU;wBACV,UAAU;wBACV,SAAQ;;0CAER,qKAAC;gCACC,oBAAM,qKAAC,sJAAQ;;;;;gCACf,OAAO,CAAC,OAAO,EAAE,MAAM,MAAM,CAAC,CAAC,CAAC;gCAChC,UAAU;;;;;;0CAEZ,qKAAC;gCACC,oBAAM,qKAAC,uJAAS;;;;;gCAChB,OAAO,CAAC,OAAO,EAAE,MAAM,MAAM,CAAC,CAAC,CAAC;gCAChC,UAAU;;;;;;0CAEZ,qKAAC;gCACC,oBAAM,qKAAC,6JAAe;;;;;gCACtB,OAAO,CAAC,MAAM,EAAE,UAAU,MAAM,CAAC,CAAC,CAAC;gCACnC,UAAU;;;;;;;;;;;;kCAKd,qKAAC;wBAAS,OAAO;wBAAU,OAAO;kCAChC,cAAA,qKAAC;4BAAW,UAAU;sCACnB,MAAM,MAAM,KAAK,kBAChB,qKAAC;gCAAW,UAAU;;kDACpB,qKAAC,sJAAQ;wCAAC,OAAO;4CAAE,UAAU;4CAAI,SAAS;wCAAI;;;;;;kDAC9C,qKAAC;kDAAE;;;;;;;;;;;uCAGL,MAAM,GAAG,CAAC,CAAC,MAAM,sBACf,qKAAC;oCAAqC,UAAU;;sDAC9C,qKAAC,sJAAQ;4CAAC,OAAO;gDAAE,OAAO,WAAW,YAAY;gDAAW,UAAU;4CAAG;;;;;;sDACzE,qKAAC;;8DACC,qKAAC;oDACC,MAAM,KAAK,GAAG;oDACd,QAAO;oDACP,KAAI;oDACJ,UAAU;;wDAET,KAAK,GAAG;sEACT,qKAAC,2JAAa;4DAAC,OAAO;gEAAE,UAAU;gEAAI,YAAY;4DAAE;;;;;;;;;;;;8DAEtD,qKAAC;oDAAS,UAAU;;wDACjB,KAAK,IAAI;wDAAC;wDAAI,sHAAO,KAAK,SAAS,EAAE,MAAM,CAAC;;;;;;;;;;;;;;mCAbpC,GAAG,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO;;;;;;;;;;;;;;;kCAuB5C,qKAAC;wBAAS,OAAO;wBAAU,OAAO;kCAChC,cAAA,qKAAC;4BAAW,UAAU;sCACnB,MAAM,MAAM,KAAK,kBAChB,qKAAC;gCAAW,UAAU;;kDACpB,qKAAC,uJAAS;wCAAC,OAAO;4CAAE,UAAU;4CAAI,SAAS;wCAAI;;;;;;kDAC/C,qKAAC;kDAAE;;;;;;;;;;;qDAGL,qKAAC;0CACE,MAAM,GAAG,CAAC,CAAC,qBACV,qKAAC;wCAAwB,UAAU;;4CAChC,KAAK,QAAQ,CAAC,UAAU,CAAC,0BACxB,qKAAC;gDACC,KAAK,KAAK,GAAG;gDACb,KAAK,KAAK,QAAQ;gDAClB,SAAS,IAAM,OAAO,IAAI,CAAC,KAAK,GAAG,EAAE;;;;;uDAErC,KAAK,QAAQ,CAAC,UAAU,CAAC,0BAC3B,qKAAC;gDAAW,QAAQ;0DAClB,cAAA,qKAAC;oDAAO,KAAK,KAAK,GAAG;oDAAE,MAAM,KAAK,QAAQ;;;;;;;;;;qEAG5C,qKAAC;gDAAe,UAAU;0DACxB,cAAA,qKAAC;oDAAM,QAAQ;oDAAC,OAAO;wDAAE,OAAO;oDAAO;8DACrC,cAAA,qKAAC;wDAAO,KAAK,KAAK,GAAG;wDAAE,MAAM,KAAK,QAAQ;;;;;;;;;;;;;;;;0DAIhD,qKAAC;gDAAU,UAAU;;kEACnB,qKAAC;kEAAW,KAAK,QAAQ;;;;;;kEACzB,qKAAC;wDAAU,UAAU;;4DAClB,eAAe,KAAK,QAAQ;4DAAE;4DAAG;4DACjC,sHAAO,KAAK,SAAS,EAAE,MAAM,CAAC;;;;;;;;;;;;;0DAGnC,qKAAC;gDACC,SAAS,IAAM,aAAa,KAAK,GAAG,EAAE,KAAK,QAAQ;gDACnD,MAAK;0DAEL,cAAA,qKAAC,0JAAY;oDAAC,UAAS;;;;;;;;;;;;uCA7BX,KAAK,EAAE;;;;;;;;;;;;;;;;;;;;kCAuCjC,qKAAC;wBAAS,OAAO;wBAAU,OAAO;kCAChC,cAAA,qKAAC;4BAAW,UAAU;sCACnB,UAAU,MAAM,KAAK,kBACpB,qKAAC;gCAAW,UAAU;;kDACpB,qKAAC,6JAAe;wCAAC,OAAO;4CAAE,UAAU;4CAAI,SAAS;wCAAI;;;;;;kDACrD,qKAAC;kDAAE;;;;;;;;;;;uCAGL,UAAU,GAAG,CAAC,CAAC,oBACb,qKAAC;oCAA0B,UAAU;;sDACnC,qKAAC,6JAAe;4CACd,OAAO;gDAAE,OAAO,WAAW,YAAY;gDAAW,UAAU;4CAAG;;;;;;sDAEjE,qKAAC;;8DACC,qKAAC;oDAAa,UAAU;8DAAW,IAAI,QAAQ;;;;;;8DAC/C,qKAAC;oDAAa,UAAU;;wDACrB,eAAe,IAAI,QAAQ;wDAAE;wDAAI,IAAI,IAAI;wDAAC;wDAAG;wDAC7C,sHAAO,IAAI,SAAS,EAAE,MAAM,CAAC;;;;;;;;;;;;;sDAGlC,qKAAC;4CACC,SAAS,IAAM,aAAa,IAAI,GAAG,EAAE,IAAI,QAAQ;4CACjD,MAAK;sDAEL,cAAA,qKAAC,0JAAY;gDAAC,UAAS;;;;;;;;;;;;mCAfR,IAAI,EAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyBzC;uCAEe;AAEf,oBAAoB;AACpB,MAAM,eAAe,IAAA,4IAAM,EAAC,6LAAM,CAAC,CAAC;;sBAEd,EAAE,CAAC,QAAW,MAAM,QAAQ,GAAG,YAAY,OAAQ;WAC9D,EAAE,CAAC,QAAW,MAAM,QAAQ,GAAG,YAAY,OAAQ;;;AAG9D,CAAC;AAED,MAAM,kBAAkB,4IAAM,CAAC,GAAG,CAAC;;;;AAInC,CAAC;AAED,MAAM,iBAAiB,4IAAM,CAAC,GAAG,CAAC;;;;;2BAKP,EAAE,CAAC,QAAW,MAAM,QAAQ,GAAG,SAAS,UAAW;AAC9E,CAAC;AAED,MAAM,cAAc,IAAA,4IAAM,EAAC,6LAAM,CAAC,CAAC;;;;;;;AAOnC,CAAC;AAED,MAAM,cAAc,4IAAM,CAAC,GAAG,CAAC;;;;;;AAM/B,CAAC;AAED,MAAM,oBAAoB,4IAAM,CAAC,GAAG,CAAC;;;AAGrC,CAAC;AAED,MAAM,uBAAuB,4IAAM,CAAC,GAAG,CAAC;;;;AAIxC,CAAC;AAED,MAAM,kBAAkB,4IAAM,CAAC,EAAE,CAAC;;;;SAIzB,EAAE,CAAC,QAAW,MAAM,QAAQ,GAAG,YAAY,OAAQ;;AAE5D,CAAC;AAED,MAAM,YAAY,4IAAM,CAAC,CAAC,CAAC;;SAElB,EAAE,CAAC,QAAW,MAAM,QAAQ,GAAG,SAAS,OAAQ;;AAEzD,CAAC;AAED,MAAM,mBAAmB,IAAA,4IAAM,EAAC,6LAAM,CAAC,CAAC;;;WAG7B,EAAE,CAAC,QAAW,MAAM,QAAQ,GAAG,YAAY,UAAW;kBAC/C,EAAE,CAAC,QAAW,MAAM,QAAQ,GAAG,YAAY,UAAW;;;;oBAIpD,EAAE,CAAC,QAAW,MAAM,QAAQ,GAAG,YAAY,UAAW;wBAClD,EAAE,CAAC,QAAW,MAAM,QAAQ,GAAG,4BAA4B,0BAA2B;;;AAG9G,CAAC;AAED,MAAM,aAAa,IAAA,4IAAM,EAAC,qLAAI,CAAC,CAAC;;;6BAGH,EAAE,CAAC,QAAW,MAAM,QAAQ,GAAG,SAAS,UAAW;;;wBAGxD,EAAE,CAAC,QAAW,MAAM,QAAQ,GAAG,YAAY,UAAW;;;AAG9E,CAAC;AAED,MAAM,YAAY,IAAA,4IAAM,EAAC,iLAAG,CAAC,CAAC;;WAEnB,EAAE,CAAC,QAAW,MAAM,QAAQ,GAAG,SAAS,OAAQ;;;;;aAK9C,EAAE,CAAC,QAAW,MAAM,QAAQ,GAAG,YAAY,UAAW;;;AAGnE,CAAC;AAED,MAAM,aAAa,4IAAM,CAAC,GAAG,CAAC;;;;;;;;;gBASd,EAAE,CAAC,QAAW,MAAM,QAAQ,GAAG,YAAY,UAAW;;;;gBAItD,EAAE,CAAC,QAAW,MAAM,QAAQ,GAAG,SAAS,OAAQ;;;AAGhE,CAAC;AAED,MAAM,aAAa,4IAAM,CAAC,GAAG,CAAC;;;;;;SAMrB,EAAE,CAAC,QAAW,MAAM,QAAQ,GAAG,SAAS,OAAQ;;;;;;AAMzD,CAAC;AAED,MAAM,WAAW,4IAAM,CAAC,GAAG,CAAC;;;;;;oBAMR,EAAE,CAAC,QAAW,MAAM,QAAQ,GAAG,YAAY,UAAW;;;;sBAIpD,EAAE,CAAC,QAAW,MAAM,QAAQ,GAAG,SAAS,UAAW;;AAEzE,CAAC;AAED,MAAM,cAAc,4IAAM,CAAC,GAAG,CAAC;;;AAG/B,CAAC;AAED,MAAM,UAAU,4IAAM,CAAC,CAAC,CAAC;;;SAGhB,EAAE,CAAC,QAAW,MAAM,QAAQ,GAAG,YAAY,UAAW;;;;;;;;;AAS/D,CAAC;AAED,MAAM,WAAW,4IAAM,CAAC,GAAG,CAAC;;SAEnB,EAAE,CAAC,QAAW,MAAM,QAAQ,GAAG,SAAS,OAAQ;AACzD,CAAC;AAED,MAAM,YAAY,4IAAM,CAAC,GAAG,CAAC;;;;AAI7B,CAAC;AAED,MAAM,YAAY,4IAAM,CAAC,GAAG,CAAC;;;;oBAIT,EAAE,CAAC,QAAW,MAAM,QAAQ,GAAG,YAAY,UAAW;;;;;;;AAO1E,CAAC;AAED,MAAM,aAAa,4IAAM,CAAC,GAAG,CAAC;;;;;;;;;;AAU9B,CAAC;AAED,MAAM,aAAa,4IAAM,CAAC,KAAK,CAAC;;;;AAIhC,CAAC;AAED,MAAM,iBAAiB,4IAAM,CAAC,GAAG,CAAC;;oBAEd,EAAE,CAAC,QAAW,MAAM,QAAQ,GAAG,YAAY,UAAW;AAC1E,CAAC;AAED,MAAM,YAAY,4IAAM,CAAC,GAAG,CAAC;;AAE7B,CAAC;AAED,MAAM,YAAY,4IAAM,CAAC,GAAG,CAAC;;;;;;AAM7B,CAAC;AAED,MAAM,YAAY,4IAAM,CAAC,GAAG,CAAC;;SAEpB,EAAE,CAAC,QAAW,MAAM,QAAQ,GAAG,SAAS,OAAQ;;AAEzD,CAAC;AAED,MAAM,eAAe,4IAAM,CAAC,GAAG,CAAC;;;;;;;oBAOZ,EAAE,CAAC,QAAW,MAAM,QAAQ,GAAG,YAAY,UAAW;;;;sBAIpD,EAAE,CAAC,QAAW,MAAM,QAAQ,GAAG,SAAS,UAAW;;AAEzE,CAAC;AAED,MAAM,kBAAkB,4IAAM,CAAC,GAAG,CAAC;;;AAGnC,CAAC;AAED,MAAM,eAAe,4IAAM,CAAC,GAAG,CAAC;;;SAGvB,EAAE,CAAC,QAAW,MAAM,QAAQ,GAAG,YAAY,OAAQ;;;;;AAK5D,CAAC;AAED,MAAM,eAAe,4IAAM,CAAC,GAAG,CAAC;;SAEvB,EAAE,CAAC,QAAW,MAAM,QAAQ,GAAG,SAAS,OAAQ;AACzD,CAAC;AAED,MAAM,qBAAqB,IAAA,4IAAM,EAAC,6MAAU,CAAC,CAAC;;;;;;;;;AAS9C,CAAC","debugId":null}},
    {"offset": {"line": 9153, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/waels/OneDrive/Desktop/Expo%20projects/P3/components/ChatScreen/components/ReplyPreview.jsx"],"sourcesContent":["// components/ChatScreen/components/ReplyPreview.jsx\r\nimport React from \"react\";\r\nimport { IconButton } from \"@mui/material\";\r\nimport CloseIcon from \"@mui/icons-material/Close\";\r\nimport {\r\n  ReplyPreviewBar,\r\n  ReplyBarIndicator,\r\n  ReplyPreviewContent,\r\n  ReplyPreviewHeader,\r\n  ReplyPreviewText,\r\n} from \"../ChatScreen.styles\";\r\n\r\nconst ReplyPreview = ({ replyingTo, userEmail, onCancel, darkMode }) => {\r\n  if (!replyingTo) return null;\r\n\r\n  return (\r\n    <ReplyPreviewBar darkMode={darkMode}>\r\n      <ReplyBarIndicator />\r\n      <ReplyPreviewContent>\r\n        <ReplyPreviewHeader>\r\n          <span>\r\n            Replying to {replyingTo.user === userEmail ? 'yourself' : replyingTo.user}\r\n          </span>\r\n          <IconButton onClick={onCancel} size=\"small\">\r\n            <CloseIcon fontSize=\"small\" style={{ color: darkMode ? '#e0e0e0' : 'inherit' }} />\r\n          </IconButton>\r\n        </ReplyPreviewHeader>\r\n        <ReplyPreviewText darkMode={darkMode}>\r\n          {replyingTo.message || replyingTo.fileName || 'ðŸŽ¤ Voice message'}\r\n        </ReplyPreviewText>\r\n      </ReplyPreviewContent>\r\n    </ReplyPreviewBar>\r\n  );\r\n};\r\n\r\nexport default ReplyPreview;"],"names":[],"mappings":"AAAA,oDAAoD;;;;;;AACpD;AACA;AACA;AACA;;;;;;AAQA,MAAM,eAAe,CAAC,EAAE,UAAU,EAAE,SAAS,EAAE,QAAQ,EAAE,QAAQ,EAAE;IACjE,IAAI,CAAC,YAAY,OAAO;IAExB,qBACE,qKAAC,4JAAe;QAAC,UAAU;;0BACzB,qKAAC,8JAAiB;;;;;0BAClB,qKAAC,gKAAmB;;kCAClB,qKAAC,+JAAkB;;0CACjB,qKAAC;;oCAAK;oCACS,WAAW,IAAI,KAAK,YAAY,aAAa,WAAW,IAAI;;;;;;;0CAE3E,qKAAC,6MAAU;gCAAC,SAAS;gCAAU,MAAK;0CAClC,cAAA,qKAAC,uJAAS;oCAAC,UAAS;oCAAQ,OAAO;wCAAE,OAAO,WAAW,YAAY;oCAAU;;;;;;;;;;;;;;;;;kCAGjF,qKAAC,6JAAgB;wBAAC,UAAU;kCACzB,WAAW,OAAO,IAAI,WAAW,QAAQ,IAAI;;;;;;;;;;;;;;;;;;AAKxD;uCAEe","debugId":null}},
    {"offset": {"line": 9242, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/waels/OneDrive/Desktop/Expo%20projects/P3/components/ChatScreen/components/PollCreationDialog.jsx"],"sourcesContent":["// components/ChatScreen/components/PollCreationDialog.jsx\r\nimport React from \"react\";\r\nimport styled from \"styled-components\";\r\nimport {\r\n  Dialog,\r\n  DialogTitle,\r\n  DialogContent,\r\n  DialogActions,\r\n  Button,\r\n  TextField,\r\n  IconButton,\r\n  Switch,\r\n  FormControlLabel,\r\n} from \"@mui/material\";\r\nimport CloseIcon from \"@mui/icons-material/Close\";\r\nimport DeleteIcon from \"@mui/icons-material/Delete\";\r\nimport PollIcon from \"@mui/icons-material/Poll\";\r\n\r\nfunction PollCreationDialog({\r\n  open,\r\n  onClose,\r\n  question,\r\n  onQuestionChange,\r\n  options,\r\n  onOptionChange,\r\n  onRemoveOption,\r\n  allowMultipleAnswers,\r\n  onAllowMultipleChange,\r\n  onSend,\r\n  isSending,\r\n  darkMode,\r\n}) {\r\n  const validOptions = options.filter((opt) => opt.trim());\r\n  const canSend = question.trim() && validOptions.length >= 2 && !isSending;\r\n\r\n  return (\r\n    <StyledDialog\r\n      open={open}\r\n      onClose={onClose}\r\n      maxWidth=\"sm\"\r\n      fullWidth\r\n      darkMode={darkMode}\r\n    >\r\n      <DialogTitle darkMode={darkMode}>\r\n        <TitleContainer>\r\n          <TitleWithIcon>\r\n            <PollIcon style={{ marginRight: 8, color: darkMode ? \"#64b5f6\" : \"#1976d2\" }} />\r\n            Create Poll\r\n          </TitleWithIcon>\r\n          <IconButton onClick={onClose} size=\"small\">\r\n            <CloseIcon style={{ color: darkMode ? \"#e0e0e0\" : \"inherit\" }} />\r\n          </IconButton>\r\n        </TitleContainer>\r\n      </DialogTitle>\r\n\r\n      <StyledDialogContent darkMode={darkMode}>\r\n        <Section>\r\n          <SectionLabel darkMode={darkMode}>Question</SectionLabel>\r\n          <StyledTextField\r\n            fullWidth\r\n            placeholder=\"Ask a question...\"\r\n            value={question}\r\n            onChange={(e) => onQuestionChange(e.target.value)}\r\n            autoFocus\r\n            darkMode={darkMode}\r\n            multiline\r\n            maxRows={3}\r\n          />\r\n        </Section>\r\n\r\n        <Section>\r\n          <SectionLabel darkMode={darkMode}>Options</SectionLabel>\r\n          <OptionsContainer>\r\n            {options.map((option, index) => (\r\n              <OptionRow key={index}>\r\n                <OptionNumber darkMode={darkMode}>{index + 1}</OptionNumber>\r\n                <StyledTextField\r\n                  fullWidth\r\n                  placeholder={`Option ${index + 1}`}\r\n                  value={option}\r\n                  onChange={(e) => onOptionChange(index, e.target.value)}\r\n                  darkMode={darkMode}\r\n                />\r\n                {options.length > 2 && (\r\n                  <IconButton\r\n                    onClick={() => onRemoveOption(index)}\r\n                    size=\"small\"\r\n                    disabled={option.trim() === \"\" && index === options.length - 1}\r\n                  >\r\n                    <DeleteIcon \r\n                      fontSize=\"small\" \r\n                      style={{ color: darkMode ? \"#d32f2f\" : \"#f44336\" }} \r\n                    />\r\n                  </IconButton>\r\n                )}\r\n              </OptionRow>\r\n            ))}\r\n          </OptionsContainer>\r\n          <HelperText darkMode={darkMode}>\r\n            {validOptions.length < 2 \r\n              ? \"Add at least 2 options\" \r\n              : `${validOptions.length} options added`}\r\n          </HelperText>\r\n        </Section>\r\n\r\n        <Section>\r\n          <FormControlLabel\r\n            control={\r\n              <Switch\r\n                checked={allowMultipleAnswers}\r\n                onChange={(e) => onAllowMultipleChange(e.target.checked)}\r\n                color=\"primary\"\r\n              />\r\n            }\r\n            label={\r\n              <SwitchLabel darkMode={darkMode}>\r\n                Allow multiple answers\r\n              </SwitchLabel>\r\n            }\r\n          />\r\n        </Section>\r\n      </StyledDialogContent>\r\n\r\n      <StyledDialogActions darkMode={darkMode}>\r\n        <Button onClick={onClose} disabled={isSending} style={{ color: darkMode ? '#e0e0e0' : 'inherit' }}>\r\n          Cancel\r\n        </Button>\r\n        <SendButton\r\n          onClick={onSend}\r\n          disabled={!canSend}\r\n          variant=\"contained\"\r\n          darkMode={darkMode}\r\n        >\r\n          {isSending ? \"Sending...\" : \"Send Poll\"}\r\n        </SendButton>\r\n      </StyledDialogActions>\r\n    </StyledDialog>\r\n  );\r\n}\r\n\r\nexport default PollCreationDialog;\r\n\r\n// Styled Components\r\nconst StyledDialog = styled(Dialog)`\r\n  .MuiDialog-paper {\r\n    background-color: ${(props) => (props.darkMode ? \"#1e1e1e\" : \"white\")};\r\n    color: ${(props) => (props.darkMode ? \"#e0e0e0\" : \"black\")};\r\n  }\r\n`;\r\n\r\nconst TitleContainer = styled.div`\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  padding: 0;\r\n`;\r\n\r\nconst TitleWithIcon = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  font-size: 20px;\r\n  font-weight: 600;\r\n  color: ${(props) => (props.darkMode ? \"#e0e0e0\" : \"black\")};\r\n`;\r\n\r\nconst StyledDialogContent = styled(DialogContent)`\r\n  padding: 20px 24px !important;\r\n  background-color: ${(props) => (props.darkMode ? \"#1e1e1e\" : \"white\")};\r\n`;\r\n\r\nconst StyledDialogActions = styled(DialogActions)`\r\n  padding: 16px 24px !important;\r\n  background-color: ${(props) => (props.darkMode ? \"#1e1e1e\" : \"white\")};\r\n  border-top: 1px solid ${(props) => (props.darkMode ? \"#333\" : \"#e0e0e0\")};\r\n`;\r\n\r\nconst Section = styled.div`\r\n  margin-bottom: 24px;\r\n\r\n  &:last-child {\r\n    margin-bottom: 0;\r\n  }\r\n`;\r\n\r\nconst SectionLabel = styled.div`\r\n  font-size: 14px;\r\n  font-weight: 600;\r\n  margin-bottom: 12px;\r\n  color: ${(props) => (props.darkMode ? \"#b0b0b0\" : \"#666\")};\r\n`;\r\n\r\nconst StyledTextField = styled(TextField)`\r\n  .MuiOutlinedInput-root {\r\n    background-color: ${(props) => (props.darkMode ? \"#2a2a2a\" : \"#f5f5f5\")};\r\n    color: ${(props) => (props.darkMode ? \"#e0e0e0\" : \"black\")};\r\n\r\n    & fieldset {\r\n      border-color: ${(props) => (props.darkMode ? \"#444\" : \"#e0e0e0\")};\r\n    }\r\n\r\n    &:hover fieldset {\r\n      border-color: ${(props) => (props.darkMode ? \"#555\" : \"#ccc\")};\r\n    }\r\n\r\n    &.Mui-focused fieldset {\r\n      border-color: ${(props) => (props.darkMode ? \"#64b5f6\" : \"#1976d2\")};\r\n    }\r\n  }\r\n\r\n  .MuiOutlinedInput-input {\r\n    color: ${(props) => (props.darkMode ? \"#e0e0e0\" : \"black\")};\r\n\r\n    &::placeholder {\r\n      color: ${(props) => (props.darkMode ? \"#777\" : \"#999\")};\r\n      opacity: 1;\r\n    }\r\n  }\r\n`;\r\n\r\nconst OptionsContainer = styled.div`\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 12px;\r\n`;\r\n\r\nconst OptionRow = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 12px;\r\n`;\r\n\r\nconst OptionNumber = styled.div`\r\n  width: 28px;\r\n  height: 28px;\r\n  border-radius: 50%;\r\n  background-color: ${(props) => (props.darkMode ? \"#2a2a2a\" : \"#e3f2fd\")};\r\n  color: ${(props) => (props.darkMode ? \"#64b5f6\" : \"#1976d2\")};\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  font-size: 14px;\r\n  font-weight: 600;\r\n  flex-shrink: 0;\r\n`;\r\n\r\nconst HelperText = styled.div`\r\n  font-size: 12px;\r\n  color: ${(props) => (props.darkMode ? \"#888\" : \"#666\")};\r\n  margin-top: 8px;\r\n`;\r\n\r\nconst SwitchLabel = styled.span`\r\n  font-size: 14px;\r\n  color: ${(props) => (props.darkMode ? \"#e0e0e0\" : \"black\")};\r\n`;\r\n\r\nconst SendButton = styled(Button)`\r\n  && {\r\n    background-color: ${(props) => (props.darkMode ? \"#00a884\" : \"#25d366\")};\r\n    color: white;\r\n\r\n    &:hover {\r\n      background-color: ${(props) => (props.darkMode ? \"#008c6e\" : \"#1fa855\")};\r\n    }\r\n\r\n    &:disabled {\r\n      background-color: ${(props) => (props.darkMode ? \"#2a2a2a\" : \"#e0e0e0\")};\r\n      color: ${(props) => (props.darkMode ? \"#666\" : \"#999\")};\r\n    }\r\n  }\r\n`;"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 9636, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/waels/OneDrive/Desktop/Expo%20projects/P3/components/ChatScreen/index.jsx"],"sourcesContent":["// components/ChatScreen/index.jsx\r\nimport React, { useRef, useState, useEffect, useContext } from \"react\";\r\nimport { useRouter } from \"next/router\";\r\nimport { useAuthState } from \"react-firebase-hooks/auth\";\r\nimport { auth, db } from \"../../firebase\";\r\nimport { \r\n  addDoc, \r\n  collection, \r\n  doc, \r\n  setDoc, \r\n  deleteDoc, \r\n  serverTimestamp, \r\n  enableNetwork, \r\n  disableNetwork,\r\n} from \"firebase/firestore\";\r\nimport { DarkModeContext } from \"../DarkModeProvider\";\r\n\r\n// Hooks\r\nimport { useEmojiPicker } from \"./hooks/useEmojiPicker\";\r\nimport { useFileUpload } from \"./hooks/useFileUpload\";\r\nimport { useVoiceRecording } from \"./hooks/useVoiceRecording\";\r\nimport { useCamera } from \"./hooks/useCamera\";\r\nimport { useLocation } from \"./hooks/useLocation\";\r\nimport { usePolls } from \"./hooks/usePolls\";\r\nimport { useRecipientData } from \"./hooks/useRecipientData\";\r\nimport { useMessages } from \"./hooks/useMessages\";\r\nimport { useMessageStatus } from \"./hooks/useMessageStatus\";\r\nimport { useDisplayName } from \"./hooks/useDisplayName\";\r\n\r\n// Components\r\nimport ChatHeader from \"./components/ChatHeader\";\r\nimport MessageList from \"./components/MessageList\";\r\nimport ChatInput from \"./components/ChatInput\";\r\nimport EmojiPicker from \"./components/EmojiPicker\";\r\nimport AttachMenu from \"./components/AttachMenu\";\r\nimport FileUploadDialog from \"./components/FileUploadDialog\";\r\nimport CameraDialog from \"./components/CameraDialog\";\r\nimport LocationPreviewDialog from \"./components/LocationPreviewDialog\";\r\nimport VoiceRecordingDialog from \"./components/VoiceRecordingDialog\";\r\nimport ChatInfoDialog from \"./components/ChatInfoDialog\";\r\nimport ReplyPreview from \"./components/ReplyPreview\";\r\nimport PollCreationDialog from \"./components/PollCreationDialog\";\r\n\r\n// Styled Components\r\nimport { Container, OfflineMessage, ErrorMessage } from \"./ChatScreen.styles\";\r\n\r\n// Utils\r\nimport { checkIfBlocked, buildReplyData } from \"./utils\";\r\nimport { MESSAGE_STATUS } from \"./constants\";\r\n\r\nfunction ChatScreen({ \r\n  chat, \r\n  messages, \r\n  isMobile = false, \r\n  onToggleSidebar = () => {} \r\n}) {\r\n  const [user] = useAuthState(auth);\r\n  const router = useRouter();\r\n  const endOfMessagesRef = useRef(null);\r\n  const inputRef = useRef(null);\r\n  \r\n  const [input, setInput] = useState(\"\");\r\n  const [isOnline, setIsOnline] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [sendingError, setSendingError] = useState(null);\r\n  const [showProfile, setShowProfile] = useState(false);\r\n  const [replyingTo, setReplyingTo] = useState(null);\r\n  const [attachMenuAnchor, setAttachMenuAnchor] = useState(null);\r\n\r\n  // Get dark mode context\r\n  const darkModeContext = useContext(DarkModeContext);\r\n  const { darkMode } = darkModeContext || { darkMode: false };\r\n  \r\n  const chatId = router?.query?.id || null;\r\n\r\n  // Custom Hooks\r\n  const { recipientEmail, recipient, recipientSnapshot, isSelfChat, isLoading } = useRecipientData(user, chat);\r\n  const { messagesSnapshot } = useMessages(chatId);\r\n  \r\n  // Fetch custom display name\r\n  const { displayName: customDisplayName, loading: displayNameLoading } = useDisplayName(\r\n    user?.uid,\r\n    recipientEmail\r\n  );\r\n  \r\n  useMessageStatus(\r\n    chatId, \r\n    isLoading ? null : recipientEmail,\r\n    user?.email,\r\n    isSelfChat\r\n  );\r\n  \r\n  const emojiPicker = useEmojiPicker();\r\n  const fileUpload = useFileUpload(chatId, user, recipientEmail);\r\n  const voiceRecording = useVoiceRecording(chatId, user, recipientEmail);\r\n  const camera = useCamera(chatId, user, recipientEmail);\r\n  const location = useLocation(chatId, user, recipientEmail);\r\n  const polls = usePolls(chatId, user, recipientEmail);\r\n\r\n  // Debug logging\r\n  useEffect(() => {\r\n    if (user) {\r\n      console.log(\"ðŸ” Current authenticated user:\", {\r\n        uid: user.uid,\r\n        email: user.email,\r\n      });\r\n    }\r\n  }, [user]);\r\n\r\n  useEffect(() => {\r\n    console.log(\"ðŸ“› Custom display name:\", customDisplayName);\r\n  }, [customDisplayName]);\r\n\r\n  // Monitor online status\r\n  useEffect(() => {\r\n    const handleOnline = () => {\r\n      setIsOnline(true);\r\n      enableNetwork(db);\r\n    };\r\n\r\n    const handleOffline = () => {\r\n      setIsOnline(false);\r\n      disableNetwork(db);\r\n    };\r\n\r\n    window.addEventListener(\"online\", handleOnline);\r\n    window.addEventListener(\"offline\", handleOffline);\r\n\r\n    return () => {\r\n      window.removeEventListener(\"online\", handleOnline);\r\n      window.removeEventListener(\"offline\", handleOffline);\r\n    };\r\n  }, []);\r\n\r\n  // Scroll to bottom\r\n  const scrollToBottom = () => {\r\n    if (endOfMessagesRef?.current) {\r\n      endOfMessagesRef.current.scrollIntoView({\r\n        behavior: \"smooth\",\r\n        block: \"start\",\r\n      });\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    scrollToBottom();\r\n  }, [messagesSnapshot]);\r\n\r\n  // Handle attach menu\r\n  const handlePlusClick = (event) => {\r\n    setAttachMenuAnchor(event.currentTarget);\r\n  };\r\n\r\n  const handleAttachMenuClose = () => {\r\n    setAttachMenuAnchor(null);\r\n  };\r\n\r\n  // Handle display name update\r\n  const handleUpdateDisplayName = async (newDisplayName) => {\r\n    if (!recipientEmail || isSelfChat || !user) {\r\n      console.error(\"âŒ Cannot update display name:\", { recipientEmail, isSelfChat, hasUser: !!user });\r\n      return;\r\n    }\r\n\r\n    try {\r\n      console.log(`ðŸ“ Updating display name for ${recipientEmail} to \"${newDisplayName}\"`);\r\n      console.log(`ðŸ‘¤ Current user:`, { uid: user.uid, email: user.email });\r\n      \r\n      const contactRef = doc(db, \"users\", user.uid, \"contacts\", recipientEmail);\r\n      \r\n      console.log(`ðŸ“ Document path: users/${user.uid}/contacts/${recipientEmail}`);\r\n      \r\n      await setDoc(contactRef, {\r\n        email: recipientEmail,\r\n        displayName: newDisplayName,\r\n        updatedAt: serverTimestamp(),\r\n      }, { merge: true });\r\n\r\n      console.log(\"âœ… Display name updated successfully\");\r\n      \r\n      // Show success message\r\n      setSendingError(null);\r\n    } catch (error) {\r\n      console.error(\"âŒ Error updating display name:\", error);\r\n      console.error(\"Error code:\", error.code);\r\n      console.error(\"Error message:\", error.message);\r\n      setSendingError(`Failed to update display name: ${error.message}`);\r\n    }\r\n  };\r\n\r\n  // Handle emoji selection\r\n  const handleEmojiClick = (emoji) => {\r\n    const cursorPosition = inputRef.current?.selectionStart || input.length;\r\n    const textBeforeCursor = input.slice(0, cursorPosition);\r\n    const textAfterCursor = input.slice(cursorPosition);\r\n    \r\n    setInput(textBeforeCursor + emoji + textAfterCursor);\r\n    emojiPicker.saveRecentEmoji(emoji);\r\n    \r\n    setTimeout(() => {\r\n      if (inputRef.current) {\r\n        inputRef.current.focus();\r\n        const newPosition = cursorPosition + emoji.length;\r\n        inputRef.current.setSelectionRange(newPosition, newPosition);\r\n      }\r\n    }, 0);\r\n  };\r\n\r\n  // Delete message\r\n  const deleteMessage = async (messageId) => {\r\n    if (!chatId || !messageId) return;\r\n    \r\n    try {\r\n      console.log(`ðŸ—‘ï¸ [Chat: ${chatId}] Deleting message ${messageId}`);\r\n      await deleteDoc(doc(db, \"chats\", chatId, \"messages\", messageId));\r\n      console.log(`âœ… [Chat: ${chatId}] Message deleted successfully`);\r\n    } catch (error) {\r\n      console.error(`âŒ [Chat: ${chatId}] Error deleting message:`, error);\r\n      setSendingError(\"Failed to delete message. Please try again.\");\r\n    }\r\n  };\r\n\r\n  // Set reply\r\n  const handleReply = (messageData) => {\r\n    setReplyingTo(messageData);\r\n    inputRef.current?.focus();\r\n  };\r\n\r\n  // Cancel reply\r\n  const cancelReply = () => {\r\n    setReplyingTo(null);\r\n  };\r\n\r\n  // Send text message\r\n  const sendMessage = async (e) => {\r\n    e.preventDefault();\r\n    setSendingError(null);\r\n\r\n    if (!input?.trim() || !chatId || !user || !recipientEmail) {\r\n      console.warn(\"âš ï¸ Cannot send message - missing required data\");\r\n      return;\r\n    }\r\n    \r\n    try {\r\n      console.log(`ðŸ“¤ [Chat: ${chatId}] Preparing to send message to ${recipientEmail}`);\r\n      \r\n      if (!isSelfChat) {\r\n        const isBlocked = await checkIfBlocked(user.email, recipientEmail);\r\n        if (isBlocked) {\r\n          setSendingError(\"You cannot send messages to this user. You have been blocked.\");\r\n          return;\r\n        }\r\n      }\r\n\r\n      const userRef = doc(db, \"users\", user.uid);\r\n      await setDoc(\r\n        userRef,\r\n        {\r\n          lastSeen: serverTimestamp(),\r\n          email: user.email,\r\n        },\r\n        { merge: true }\r\n      );\r\n\r\n      const messageData = {\r\n        timestamp: serverTimestamp(),\r\n        message: input,\r\n        user: user.email,\r\n        photoURL: user.photoURL,\r\n        status: MESSAGE_STATUS.SENT,\r\n      };\r\n\r\n      const replyData = buildReplyData(replyingTo);\r\n      if (replyData) {\r\n        messageData.replyTo = replyData;\r\n      }\r\n\r\n      await addDoc(collection(db, \"chats\", chatId, \"messages\"), messageData);\r\n\r\n      setInput(\"\");\r\n      setReplyingTo(null);\r\n      scrollToBottom();\r\n    } catch (error) {\r\n      console.error(`âŒ [Chat: ${chatId}] Error sending message:`, error);\r\n      setSendingError(\"Failed to send message. Please try again.\");\r\n    }\r\n  };\r\n\r\n  if (!isOnline) {\r\n    return (\r\n      <Container darkMode={darkMode}>\r\n        <OfflineMessage darkMode={darkMode}>\r\n          You are currently offline. Please check your internet connection.\r\n        </OfflineMessage>\r\n      </Container>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <Container darkMode={darkMode}>\r\n        <ErrorMessage darkMode={darkMode}>{error}</ErrorMessage>\r\n      </Container>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Container darkMode={darkMode}>\r\n      <ChatHeader\r\n        recipient={recipient}\r\n        recipientEmail={recipientEmail}\r\n        recipientSnapshot={recipientSnapshot}\r\n        isSelfChat={isSelfChat}\r\n        customDisplayName={customDisplayName}\r\n        onMoreClick={() => setShowProfile(true)}\r\n        darkMode={darkMode}\r\n        isMobile={isMobile}\r\n        onToggleSidebar={onToggleSidebar}\r\n      />\r\n\r\n      <input\r\n        ref={fileUpload.fileInputRef}\r\n        type=\"file\"\r\n        hidden\r\n        onChange={fileUpload.handleFileSelect}\r\n        accept=\"*/*\"\r\n      />\r\n\r\n      <MessageList\r\n        ref={endOfMessagesRef}\r\n        messagesSnapshot={messagesSnapshot}\r\n        messages={messages}\r\n        sendingError={sendingError}\r\n        onDelete={deleteMessage}\r\n        onReply={handleReply}\r\n        darkMode={darkMode}\r\n      />\r\n\r\n      <AttachMenu\r\n        anchorEl={attachMenuAnchor}\r\n        open={Boolean(attachMenuAnchor)}\r\n        onClose={handleAttachMenuClose}\r\n        onAttachFile={fileUpload.handleAttachClick}\r\n        onTakePhoto={camera.startCamera}\r\n        onShareLocation={location.getLocation}\r\n        onCreatePoll={polls.openPollDialog}\r\n        darkMode={darkMode}\r\n      />\r\n\r\n      <EmojiPicker\r\n        open={emojiPicker.openEmojiPicker}\r\n        anchorEl={emojiPicker.emojiAnchorEl}\r\n        onClose={emojiPicker.handleEmojiPickerClose}\r\n        selectedCategory={emojiPicker.selectedEmojiCategory}\r\n        onCategoryChange={emojiPicker.setSelectedEmojiCategory}\r\n        searchTerm={emojiPicker.emojiSearchTerm}\r\n        onSearchChange={emojiPicker.setEmojiSearchTerm}\r\n        emojis={emojiPicker.getFilteredEmojis()}\r\n        onEmojiSelect={handleEmojiClick}\r\n        darkMode={darkMode}\r\n      />\r\n\r\n      <FileUploadDialog\r\n        open={fileUpload.showFileConfirmation}\r\n        onClose={fileUpload.cancelFileSelection}\r\n        file={fileUpload.selectedFile}\r\n        filePreview={fileUpload.filePreview}\r\n        input={input}\r\n        onInputChange={setInput}\r\n        uploadProgress={fileUpload.uploadProgress}\r\n        isUploading={fileUpload.isUploading}\r\n        onSend={() => fileUpload.sendFileMessage(\r\n          input,\r\n          replyingTo,\r\n          setSendingError,\r\n          setInput,\r\n          setReplyingTo,\r\n          scrollToBottom,\r\n          isSelfChat,\r\n        )}\r\n        darkMode={darkMode}\r\n      />\r\n\r\n      <CameraDialog\r\n        open={camera.showCamera || camera.capturedImage !== null}\r\n        showCamera={camera.showCamera}\r\n        capturedImage={camera.capturedImage}\r\n        videoRef={camera.videoRef}\r\n        input={input}\r\n        onInputChange={setInput}\r\n        uploadProgress={camera.uploadProgress}\r\n        isUploading={camera.isUploading}\r\n        onCapture={camera.capturePhoto}\r\n        onRetake={camera.retakePhoto}\r\n        onCancel={camera.cancelPhoto}\r\n        onSend={() => camera.sendPhoto(\r\n          input,\r\n          replyingTo,\r\n          setSendingError,\r\n          setInput,\r\n          setReplyingTo,\r\n          scrollToBottom,\r\n          isSelfChat,\r\n        )}\r\n        darkMode={darkMode}\r\n      />\r\n\r\n      <LocationPreviewDialog\r\n        open={location.showLocationPreview}\r\n        locationData={location.locationData}\r\n        input={input}\r\n        onInputChange={setInput}\r\n        onCancel={location.cancelLocation}\r\n        onSend={() => location.sendLocation(\r\n          input,\r\n          replyingTo,\r\n          setSendingError,\r\n          setInput,\r\n          setReplyingTo,\r\n          scrollToBottom,\r\n          isSelfChat,\r\n        )}\r\n        isGettingLocation={location.isGettingLocation}\r\n        darkMode={darkMode}\r\n      />\r\n\r\n      <VoiceRecordingDialog\r\n        open={voiceRecording.audioBlob !== null}\r\n        audioBlob={voiceRecording.audioBlob}\r\n        recordingTime={voiceRecording.recordingTime}\r\n        uploadProgress={voiceRecording.uploadProgress}\r\n        isUploading={voiceRecording.isUploading}\r\n        onCancel={voiceRecording.cancelRecording}\r\n        onSend={() => voiceRecording.sendVoiceMessage(\r\n          replyingTo,\r\n          setSendingError,\r\n          setReplyingTo,\r\n          scrollToBottom,\r\n          isSelfChat,\r\n        )}\r\n        onError={setSendingError}\r\n        darkMode={darkMode}\r\n      />\r\n\r\n      <PollCreationDialog\r\n        open={polls.showPollDialog}\r\n        onClose={polls.closePollDialog}\r\n        question={polls.pollQuestion}\r\n        onQuestionChange={polls.setPollQuestion}\r\n        options={polls.pollOptions}\r\n        onOptionChange={polls.handleOptionChange}\r\n        onRemoveOption={polls.removeOption}\r\n        allowMultipleAnswers={polls.allowMultipleAnswers}\r\n        onAllowMultipleChange={polls.setAllowMultipleAnswers}\r\n        onSend={() => polls.sendPoll(\r\n          replyingTo,\r\n          setSendingError,\r\n          setReplyingTo,\r\n          scrollToBottom,\r\n          isSelfChat,\r\n        )}\r\n        isSending={polls.isSendingPoll}\r\n        darkMode={darkMode}\r\n      />\r\n\r\n      <ChatInfoDialog\r\n        open={showProfile}\r\n        onClose={() => setShowProfile(false)}\r\n        recipient={{ ...recipient, displayName: customDisplayName }}\r\n        recipientEmail={recipientEmail}\r\n        isSelfChat={isSelfChat}\r\n        messages={messagesSnapshot?.docs.map(doc => ({ \r\n          id: doc.id, \r\n          ...doc.data(),\r\n          timestamp: doc.data().timestamp?.toDate?.() || doc.data().timestamp\r\n        })) || []}\r\n        onUpdateDisplayName={handleUpdateDisplayName}\r\n        darkMode={darkMode}\r\n      />\r\n\r\n      <ReplyPreview\r\n        replyingTo={replyingTo}\r\n        userEmail={user?.email}\r\n        onCancel={cancelReply}\r\n        darkMode={darkMode}\r\n      />\r\n\r\n      <ChatInput\r\n        input={input}\r\n        setInput={setInput}\r\n        inputRef={inputRef}\r\n        isRecording={voiceRecording.isRecording}\r\n        recordingTime={voiceRecording.recordingTime}\r\n        onSubmit={sendMessage}\r\n        onEmojiClick={emojiPicker.handleEmojiPickerOpen}\r\n        onPlusClick={handlePlusClick}\r\n        onStartRecording={() => voiceRecording.startRecording(setSendingError)}\r\n        onStopRecording={voiceRecording.stopRecording}\r\n        darkMode={darkMode}\r\n      />\r\n    </Container>\r\n  );\r\n}\r\n\r\nexport default ChatScreen;"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 10177, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/waels/OneDrive/Desktop/Expo%20projects/P3/pages/index.js"],"sourcesContent":["// pages/index.jsx\r\nimport Head from \"next/head\";\r\nimport styled from \"styled-components\";\r\nimport { useState, useEffect, useContext } from \"react\";\r\nimport { useRouter } from \"next/router\";\r\nimport Sidebar from \"../components/Sidebar\";\r\nimport ChatScreen from \"../components/ChatScreen\";\r\nimport { DarkModeContext } from \"../components/DarkModeProvider\";\r\nimport ChatBubbleOutlineIcon from \"@mui/icons-material/ChatBubbleOutline\";\r\n\r\nexport default function Home() {\r\n  const router = useRouter();\r\n  const [sidebarOpen, setSidebarOpen] = useState(true); // âœ… Changed to true by default\r\n  const [isMobile, setIsMobile] = useState(false);\r\n\r\n  const darkModeContext = useContext(DarkModeContext);\r\n  const { darkMode } = darkModeContext || { darkMode: false };\r\n\r\n  // Detect mobile/tablet screen size\r\n  useEffect(() => {\r\n    const checkScreenSize = () => {\r\n      const mobile = window.innerWidth <= 1024;\r\n      setIsMobile(mobile);\r\n      // On mobile, open sidebar by default when no chat selected\r\n      if (mobile && !router.query.id) {\r\n        setSidebarOpen(true);\r\n      }\r\n    };\r\n\r\n    checkScreenSize();\r\n    window.addEventListener('resize', checkScreenSize);\r\n    return () => window.removeEventListener('resize', checkScreenSize);\r\n  }, [router.query.id]);\r\n\r\n  // Close sidebar when chat selected on mobile\r\n  useEffect(() => {\r\n    if (isMobile && router.query.id) {\r\n      setSidebarOpen(false);\r\n    }\r\n  }, [router.query.id, isMobile]);\r\n\r\n  const chatId = router.query.id;\r\n\r\n  return (\r\n    <Container darkMode={darkMode}>\r\n      <Head>\r\n        <title>{chatId ? 'Chat' : 'Your Chats'}</title>\r\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no\" />\r\n      </Head>\r\n\r\n      <AppContainer>\r\n        {/* Overlay for mobile - only show when sidebar is open and chat is selected */}\r\n        {isMobile && sidebarOpen && chatId && (\r\n          <Overlay onClick={() => setSidebarOpen(false)} />\r\n        )}\r\n\r\n        <Sidebar \r\n          isMobile={isMobile} \r\n          sidebarOpen={sidebarOpen} \r\n          setSidebarOpen={setSidebarOpen}\r\n        />\r\n\r\n        {chatId ? (\r\n          <ChatScreen \r\n            isMobile={isMobile}\r\n            onToggleSidebar={() => setSidebarOpen(true)}\r\n          />\r\n        ) : (\r\n          // On desktop, show welcome screen. On mobile, don't show anything (sidebar takes full screen)\r\n          !isMobile && (\r\n            <WelcomeScreen darkMode={darkMode}>\r\n              <WelcomeContent>\r\n                <ChatBubbleOutlineIcon style={{ fontSize: 100, opacity: 0.3, marginBottom: 20 }} />\r\n                <WelcomeTitle darkMode={darkMode}>Welcome to Chat App</WelcomeTitle>\r\n                <WelcomeText darkMode={darkMode}>\r\n                  Select a chat from the sidebar to start messaging\r\n                </WelcomeText>\r\n                <WelcomeSubText darkMode={darkMode}>\r\n                  or create a new chat to connect with someone\r\n                </WelcomeSubText>\r\n              </WelcomeContent>\r\n            </WelcomeScreen>\r\n          )\r\n        )}\r\n      </AppContainer>\r\n    </Container>\r\n  );\r\n}\r\n\r\nconst Container = styled.div`\r\n  background-color: ${props => props.darkMode ? '#1e1e1e' : 'white'};\r\n  min-height: 100vh;\r\n  overflow: hidden;\r\n`;\r\n\r\nconst AppContainer = styled.div`\r\n  display: flex;\r\n  height: 100vh;\r\n  overflow: hidden;\r\n  position: relative;\r\n`;\r\n\r\nconst WelcomeScreen = styled.div`\r\n  flex: 1;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  background-color: ${props => props.darkMode ? '#121212' : '#f0f2f5'};\r\n  border-left: 1px solid ${props => props.darkMode ? '#333' : '#e0e0e0'};\r\n\r\n  @media (max-width: 1024px) {\r\n    display: none;\r\n  }\r\n`;\r\n\r\nconst WelcomeContent = styled.div`\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  text-align: center;\r\n  padding: 40px;\r\n  max-width: 500px;\r\n`;\r\n\r\nconst WelcomeTitle = styled.h1`\r\n  font-size: 28px;\r\n  font-weight: 400;\r\n  color: ${props => props.darkMode ? '#e0e0e0' : '#333'};\r\n  margin: 0 0 20px 0;\r\n`;\r\n\r\nconst WelcomeText = styled.p`\r\n  font-size: 16px;\r\n  color: ${props => props.darkMode ? '#888' : '#666'};\r\n  margin: 0 0 10px 0;\r\n  line-height: 1.5;\r\n`;\r\n\r\nconst WelcomeSubText = styled.p`\r\n  font-size: 14px;\r\n  color: ${props => props.darkMode ? '#666' : '#999'};\r\n  margin: 0;\r\n  font-style: italic;\r\n`;"],"names":[],"mappings":"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","debugId":null}}]
}