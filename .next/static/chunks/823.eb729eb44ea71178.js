"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[823],{4900:function(n,t,e){var r=e(4836);t.Z=void 0;var o=r(e(4938)),i=e(5893);t.Z=(0,o.default)((0,i.jsx)("path",{d:"M16.5 6v11.5c0 2.21-1.79 4-4 4s-4-1.79-4-4V5c0-1.38 1.12-2.5 2.5-2.5s2.5 1.12 2.5 2.5v10.5c0 .55-.45 1-1 1s-1-.45-1-1V6H10v9.5c0 1.38 1.12 2.5 2.5 2.5s2.5-1.12 2.5-2.5V5c0-2.21-1.79-4-4-4S7 2.79 7 5v12.5c0 3.04 2.46 5.5 5.5 5.5s5.5-2.46 5.5-5.5V6z"}),"AttachFile")},3358:function(n,t,e){var r=e(4836);t.Z=void 0;var o=r(e(4938)),i=e(5893);t.Z=(0,o.default)((0,i.jsx)("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2M12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8m3.5-9c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5m-7 0c.83 0 1.5-.67 1.5-1.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11m3.5 6.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5"}),"InsertEmoticon")},642:function(n,t,e){var r=e(4836);t.Z=void 0;var o=r(e(4938)),i=e(5893);t.Z=(0,o.default)((0,i.jsx)("path",{d:"M12 14c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3m5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.48 6-3.3 6-6.72z"}),"Mic")},9823:function(n,t,e){e.r(t),e.d(t,{default:function(){return vn}});var r=e(7568),o=e(1799);function i(n,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):function(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),e.push.apply(e,r)}return e}(Object(t)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))})),n}var u=e(603),a=e(7297),c=e(7582),s=e(5893),l=e(7294),d=e(66),f=e(1163),p=e(3349),v=e(6677),m=e(3653),h=e(7896),x=e(381),g=e.n(x);function b(){var n=(0,a.Z)([""]);return b=function(){return n},n}function y(){var n=(0,a.Z)(["\n  width: fit-content;\n  padding: 15px;\n  border-radius: 8px;\n  margin: 10px;\n  min-width: 60px;\n  padding-bottom: 26px;\n  position: relative;\n  text-align: right;\n"]);return y=function(){return n},n}function j(){var n=(0,a.Z)(["\n  margin-left: auto;\n  background-color: #dcf8c6;\n"]);return j=function(){return n},n}function Z(){var n=(0,a.Z)(["\n  background-color: whitesmoke;\n  text-align: left;\n"]);return Z=function(){return n},n}function w(){var n=(0,a.Z)(["\n  color: gray;\n  padding: 10px;\n  font-size: 9px;\n  position: absolute;\n  bottom: 0;\n  text-align: right;\n  right: 0;\n"]);return w=function(){return n},n}var O=function(n){var t=n.user,e=n.message,r=(0,u.Z)((0,p.F_)(m.I8),1)[0],o=t===(null===r||void 0===r?void 0:r.email)?k:_;return(0,s.jsx)(P,{children:(0,s.jsxs)(o,{children:[e.message,(0,s.jsx)(D,{children:e.timestamp?g()(e.timestamp).format("LT"):"..."})]})})},P=d.ZP.div(b()),S=d.ZP.p(y()),k=(0,d.ZP)(S)(j()),_=(0,d.ZP)(S)(Z()),D=d.ZP.span(w()),E=e(6100),M=e(9800),L=e(3946),T=e(4900),I=e(3358),U=e(7976),A=e(642),C=["second","minute","hour","day","week","month","year"];var z=["\u79d2","\u5206\u949f","\u5c0f\u65f6","\u5929","\u5468","\u4e2a\u6708","\u5e74"];var N={},V=function(n,t){N[n]=t},R=function(n){return N[n]||N.en_US},$=[60,60,24,7,365/7/12,12];function F(n){return n instanceof Date?n:!isNaN(n)||/^\d+$/.test(n)?new Date(parseInt(n)):(n=(n||"").trim().replace(/\.\d+/,"").replace(/-/,"/").replace(/-/,"/").replace(/(\d)T(\d)/,"$1 $2").replace(/Z/," UTC").replace(/([+-]\d\d):?(\d\d)/," $1$2"),new Date(n))}function J(n,t){for(var e=n<0?1:0,r=n=Math.abs(n),o=0;n>=$[o]&&o<$.length;o++)n/=$[o];return(n=Math.floor(n))>(0===(o*=2)?9:1)&&(o+=1),t(n,o,r)[e].replace("%s",n.toString())}function H(n,t){return(+(t?F(t):new Date)-+F(n))/1e3}var B="timeago-id";function K(n){return parseInt(n.getAttribute(B))}var q={},W=function(n){clearTimeout(n),delete q[n]};function X(n,t,e,r){W(K(n));var o=r.relativeDate,i=r.minInterval,u=H(t,o);n.innerText=J(u,e);var a=setTimeout((function(){X(n,t,e,r)}),Math.min(1e3*Math.max(function(n){for(var t=1,e=0,r=Math.abs(n);n>=$[e]&&e<$.length;e++)n/=$[e],t*=$[e];return r=(r%=t)?t-r:t,Math.ceil(r)}(u),i||1),2147483647));q[a]=0,function(n,t){n.setAttribute(B,t)}(n,a)}function Y(n){n?W(K(n)):Object.keys(q).forEach(W)}V("en_US",(function(n,t){if(0===t)return["just now","right now"];var e=C[Math.floor(t/2)];return n>1&&(e+="s"),[n+" "+e+" ago","in "+n+" "+e]})),V("zh_CN",(function(n,t){if(0===t)return["\u521a\u521a","\u7247\u523b\u540e"];var e=z[~~(t/2)];return[n+" "+e+"\u524d",n+" "+e+"\u540e"]}));var G=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e])},n(t,e)};return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Q=function(){return Q=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var o in t=arguments[e])Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o]);return n},Q.apply(this,arguments)},nn=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(null!=n&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(n);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(n,r[o])&&(e[r[o]]=n[r[o]])}return e},tn=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.dom=null,t}return G(t,n),t.prototype.componentDidMount=function(){this.renderTimeAgo()},t.prototype.componentDidUpdate=function(){this.renderTimeAgo()},t.prototype.renderTimeAgo=function(){var n,t=this.props,e=t.live,r=t.datetime,o=t.locale,i=t.opts;Y(this.dom),!1!==e&&(this.dom.setAttribute("datetime",""+((n=r)instanceof Date?n.getTime():n)),function(n,t,e){var r=n.length?n:[n];r.forEach((function(n){X(n,function(n){return n.getAttribute("datetime")}(n),R(t),e||{})}))}(this.dom,o,i))},t.prototype.componentWillUnmount=function(){Y(this.dom)},t.prototype.render=function(){var n=this,t=this.props,e=t.datetime,r=(t.live,t.locale),o=t.opts,i=nn(t,["datetime","live","locale","opts"]);return l.createElement("time",Q({ref:function(t){n.dom=t}},i),function(n,t,e){return J(H(n,e&&e.relativeDate),R(t))}(e,r,o))},t.defaultProps={live:!0,className:""},t}(l.PureComponent),en=tn;function rn(){var n=(0,a.Z)(["\n  display: flex;\n  flex-direction: column;\n"]);return rn=function(){return n},n}function on(){var n=(0,a.Z)(["\n  position: sticky;\n  background-color: white;\n  z-index: 100;\n  top: 0;\n  display: flex;\n  padding: 11px;\n  height: 80px;\n  align-items: center;\n  border-bottom: 1px solid whitesmoke;\n"]);return on=function(){return n},n}function un(){var n=(0,a.Z)(["\n  margin-left: 15px;\n  flex: 1;\n\n  > h3 {\n    margin-bottom: 3px;\n  }\n  > p {\n    font-size: 14px;\n    color: gray;\n  }\n"]);return un=function(){return n},n}function an(){var n=(0,a.Z)([""]);return an=function(){return n},n}function cn(){var n=(0,a.Z)(["\n  padding: 30px;\n  background-color: #e5ded8;\n  min-height: 90vh;\n"]);return cn=function(){return n},n}function sn(){var n=(0,a.Z)(["\n  display: flex;\n  align-items: center;\n  padding: 10px;\n  position: sticky;\n  bottom: 0;\n  background-color: white;\n  z-index: 100;\n"]);return sn=function(){return n},n}function ln(){var n=(0,a.Z)(["\n  flex: 1;\n  outline: 0;\n  border: none;\n  border-radius: 10px;\n  background-color: whitesmoke;\n  padding: 20px;\n  margin-left: 15px;\n  margin-right: 15px;\n"]);return ln=function(){return n},n}function dn(){var n=(0,a.Z)(["\n  margin-bottom: 50px;\n"]);return dn=function(){return n},n}function fn(){var n=(0,a.Z)(["\n  text-align: center;\n  padding: 20px;\n  color: #721c24;\n  background-color: #f8d7da;\n  border: 1px solid #f5c6cb;\n  border-radius: 4px;\n  margin: 20px;\n"]);return fn=function(){return n},n}function pn(){var n=(0,a.Z)(["\n  text-align: center;\n  padding: 20px;\n  color: #856404;\n  background-color: #fff3cd;\n  border: 1px solid #ffeeba;\n  border-radius: 4px;\n  margin: 20px;\n"]);return pn=function(){return n},n}var vn=function(n){var t,e,a,d,x=n.chat,g=n.messages,b=(0,u.Z)((0,p.F_)(m.I8),1)[0],y=(0,f.useRouter)(),j=(0,l.useRef)(null),Z=(0,l.useState)(""),w=Z[0],P=Z[1],S=(0,l.useState)(!0),k=S[0],_=S[1],D=(0,l.useState)(null),C=D[0];D[1],(0,l.useEffect)((function(){var n=function(){_(!0),(0,E.Ix)(m.db)},t=function(){_(!1),(0,E.TF)(m.db)};return window.addEventListener("online",n),window.addEventListener("offline",t),function(){window.removeEventListener("online",n),window.removeEventListener("offline",t)}}),[]);var z=(null===y||void 0===y||null===(t=y.query)||void 0===t?void 0:t.id)||null,N=z&&k?(0,E.hJ)(m.db,"chats",z,"messages"):null,V=N?(0,E.IO)(N,(0,E.Xo)("timestamp","asc")):null,R=(0,u.Z)((0,v.Kx)(V||null),1)[0],$=(0,E.hJ)(m.db,"users"),F=b&&x?(0,h.Z)(x.users,b):null,J=F?(0,E.IO)($,(0,E.ar)("email","==",F)):null,H=(0,u.Z)((0,v.Kx)(J||null),1)[0],B=function(){(null===j||void 0===j?void 0:j.current)&&j.current.scrollIntoView({behavior:"smooth",block:"start"})};(0,l.useEffect)((function(){B()}),[R]);var K=function(){var n=(0,r.Z)((function(n){var t;return(0,c.__generator)(this,(function(e){switch(e.label){case 0:return n.preventDefault(),(null===w||void 0===w?void 0:w.trim())?z&&b?(t=(0,E.JU)(m.db,"users",b.uid),[4,(0,E.pl)(t,{lastSeen:(0,E.Bt)()},{merge:!0})]):[2]:[2];case 1:return e.sent(),[4,(0,E.ET)(N,{timestamp:(0,E.Bt)(),message:w,user:b.email,photoURL:b.photoURL})];case 2:return e.sent(),P(""),B(),[2]}}))}));return function(t){return n.apply(this,arguments)}}(),q=null===H||void 0===H||null===(e=H.docs)||void 0===e||null===(a=e[0])||void 0===a?void 0:a.data();return k?C?(0,s.jsx)(mn,{children:(0,s.jsx)(On,{children:C})}):(0,s.jsxs)(mn,{children:[(0,s.jsxs)(hn,{children:[q?(0,s.jsx)(M.Z,{src:q.photoURL}):(0,s.jsx)(M.Z,{children:F?F[0]:"?"}),(0,s.jsxs)(xn,{children:[(0,s.jsx)("h3",{children:null!==F&&void 0!==F?F:"Loading..."}),(0,s.jsxs)("p",{children:["Last active:"," ",H?(null===q||void 0===q||null===(d=q.lastSeen)||void 0===d?void 0:d.toDate)?(0,s.jsx)(en,{datetime:q.lastSeen.toDate()}):"Unavailable":"Loading Last active..."]})]}),(0,s.jsxs)(gn,{children:[(0,s.jsx)(L.Z,{children:(0,s.jsx)(T.Z,{})}),(0,s.jsx)(L.Z,{children:(0,s.jsx)(U.Z,{})})]})]}),(0,s.jsxs)(bn,{children:[R?R.docs.map((function(n){var t;return(0,s.jsx)(O,{user:n.data().user,message:i((0,o.Z)({},n.data()),{timestamp:null===(t=n.data().timestamp)||void 0===t?void 0:t.toMillis()})},n.id)})):g?JSON.parse(g).map((function(n){return(0,s.jsx)(O,{user:n.user,message:n},n.id)})):null,(0,s.jsx)(Zn,{ref:j})]}),(0,s.jsxs)(yn,{onSubmit:K,children:[(0,s.jsx)(I.Z,{}),(0,s.jsx)(jn,{value:w,onChange:function(n){return P(n.target.value)},type:"text"}),(0,s.jsx)("button",{hidden:!0,disabled:!w,type:"submit",children:"Send"}),(0,s.jsx)(A.Z,{})]})]}):(0,s.jsx)(mn,{children:(0,s.jsx)(wn,{children:"You are currently offline. Please check your internet connection."})})},mn=d.ZP.div(rn()),hn=d.ZP.div(on()),xn=d.ZP.div(un()),gn=d.ZP.div(an()),bn=d.ZP.div(cn()),yn=d.ZP.form(sn()),jn=d.ZP.input(ln()),Zn=d.ZP.div(dn()),wn=d.ZP.div(fn()),On=d.ZP.div(pn())},7896:function(n,t){t.Z=function(n,t){return null===n||void 0===n?void 0:n.filter((function(n){return n!==(null===t||void 0===t?void 0:t.email)}))[0]}}}]);