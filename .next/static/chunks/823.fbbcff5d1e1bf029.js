"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[823],{4900:function(n,e,t){var r=t(4836);e.Z=void 0;var o=r(t(4938)),i=t(5893);e.Z=(0,o.default)((0,i.jsx)("path",{d:"M16.5 6v11.5c0 2.21-1.79 4-4 4s-4-1.79-4-4V5c0-1.38 1.12-2.5 2.5-2.5s2.5 1.12 2.5 2.5v10.5c0 .55-.45 1-1 1s-1-.45-1-1V6H10v9.5c0 1.38 1.12 2.5 2.5 2.5s2.5-1.12 2.5-2.5V5c0-2.21-1.79-4-4-4S7 2.79 7 5v12.5c0 3.04 2.46 5.5 5.5 5.5s5.5-2.46 5.5-5.5V6z"}),"AttachFile")},3358:function(n,e,t){var r=t(4836);e.Z=void 0;var o=r(t(4938)),i=t(5893);e.Z=(0,o.default)((0,i.jsx)("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2M12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8m3.5-9c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5m-7 0c.83 0 1.5-.67 1.5-1.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11m3.5 6.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5"}),"InsertEmoticon")},642:function(n,e,t){var r=t(4836);e.Z=void 0;var o=r(t(4938)),i=t(5893);e.Z=(0,o.default)((0,i.jsx)("path",{d:"M12 14c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3m5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.48 6-3.3 6-6.72z"}),"Mic")},9823:function(n,e,t){t.r(e),t.d(e,{default:function(){return xn}});var r=t(7568),o=t(1799);function i(n,e){return e=null!=e?e:{},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):function(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),t.push.apply(t,r)}return t}(Object(e)).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))})),n}var a=t(603),u=t(7297),c=t(7582),d=t(5893),l=t(7294),s=t(66),f=t(1163),p=t(3349),v=t(6677),m=t(3653),h=t(7896),x=t(381),g=t.n(x);function b(){var n=(0,u.Z)([""]);return b=function(){return n},n}function k(){var n=(0,u.Z)(["\n  width: fit-content;\n  padding: 15px;\n  border-radius: 8px;\n  margin: 10px;\n  min-width: 60px;\n  padding-bottom: 26px;\n  position: relative;\n  text-align: right;\n"]);return k=function(){return n},n}function y(){var n=(0,u.Z)(["\n  margin-left: auto;\n  background-color: #dcf8c6;\n"]);return y=function(){return n},n}function Z(){var n=(0,u.Z)(["\n  background-color: whitesmoke;\n  text-align: left;\n"]);return Z=function(){return n},n}function j(){var n=(0,u.Z)(["\n  color: gray;\n  padding: 10px;\n  font-size: 9px;\n  position: absolute;\n  bottom: 0;\n  text-align: right;\n  right: 0;\n"]);return j=function(){return n},n}var M=function(n){var e=n.user,t=n.message,r=(0,a.Z)((0,p.F_)(m.I8),1)[0],o=e===(null===r||void 0===r?void 0:r.email)?P:S;return(0,d.jsx)(w,{children:(0,d.jsxs)(o,{children:[t.message,(0,d.jsx)(_,{children:t.timestamp?g()(t.timestamp).format("LT"):"..."})]})})},w=s.ZP.div(b()),O=s.ZP.p(k()),P=(0,s.ZP)(O)(y()),S=(0,s.ZP)(O)(Z()),_=s.ZP.span(j()),E=t(5931),D=t(6100),T=t(2485),L=t(3946),I=t(4900),C=t(3358),A=t(7976),U=t(642),z=["second","minute","hour","day","week","month","year"];var N=["\u79d2","\u5206\u949f","\u5c0f\u65f6","\u5929","\u5468","\u4e2a\u6708","\u5e74"];var V={},F=function(n,e){V[n]=e},J=function(n){return V[n]||V.en_US},R=[60,60,24,7,365/7/12,12];function $(n){return n instanceof Date?n:!isNaN(n)||/^\d+$/.test(n)?new Date(parseInt(n)):(n=(n||"").trim().replace(/\.\d+/,"").replace(/-/,"/").replace(/-/,"/").replace(/(\d)T(\d)/,"$1 $2").replace(/Z/," UTC").replace(/([+-]\d\d):?(\d\d)/," $1$2"),new Date(n))}function H(n,e){for(var t=n<0?1:0,r=n=Math.abs(n),o=0;n>=R[o]&&o<R.length;o++)n/=R[o];return(n=Math.floor(n))>(0===(o*=2)?9:1)&&(o+=1),e(n,o,r)[t].replace("%s",n.toString())}function B(n,e){return(+(e?$(e):new Date)-+$(n))/1e3}var K="timeago-id";function q(n){return parseInt(n.getAttribute(K))}var W={},X=function(n){clearTimeout(n),delete W[n]};function Y(n,e,t,r){X(q(n));var o=r.relativeDate,i=r.minInterval,a=B(e,o);n.innerText=H(a,t);var u=setTimeout((function(){Y(n,e,t,r)}),Math.min(1e3*Math.max(function(n){for(var e=1,t=0,r=Math.abs(n);n>=R[t]&&t<R.length;t++)n/=R[t],e*=R[t];return r=(r%=e)?e-r:e,Math.ceil(r)}(a),i||1),2147483647));W[u]=0,function(n,e){n.setAttribute(K,e)}(n,u)}function G(n){n?X(q(n)):Object.keys(W).forEach(X)}F("en_US",(function(n,e){if(0===e)return["just now","right now"];var t=z[Math.floor(e/2)];return n>1&&(t+="s"),[n+" "+t+" ago","in "+n+" "+t]})),F("zh_CN",(function(n,e){if(0===e)return["\u521a\u521a","\u7247\u523b\u540e"];var t=N[~~(e/2)];return[n+" "+t+"\u524d",n+" "+t+"\u540e"]}));var Q=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,e){n.__proto__=e}||function(n,e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t])},n(e,t)};return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),nn=function(){return nn=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++)for(var o in e=arguments[t])Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n},nn.apply(this,arguments)},en=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(null!=n&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(n);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(n,r[o])&&(t[r[o]]=n[r[o]])}return t},tn=function(n){function e(){var e=null!==n&&n.apply(this,arguments)||this;return e.dom=null,e}return Q(e,n),e.prototype.componentDidMount=function(){this.renderTimeAgo()},e.prototype.componentDidUpdate=function(){this.renderTimeAgo()},e.prototype.renderTimeAgo=function(){var n,e=this.props,t=e.live,r=e.datetime,o=e.locale,i=e.opts;G(this.dom),!1!==t&&(this.dom.setAttribute("datetime",""+((n=r)instanceof Date?n.getTime():n)),function(n,e,t){var r=n.length?n:[n];r.forEach((function(n){Y(n,function(n){return n.getAttribute("datetime")}(n),J(e),t||{})}))}(this.dom,o,i))},e.prototype.componentWillUnmount=function(){G(this.dom)},e.prototype.render=function(){var n=this,e=this.props,t=e.datetime,r=(e.live,e.locale),o=e.opts,i=en(e,["datetime","live","locale","opts"]);return l.createElement("time",nn({ref:function(e){n.dom=e}},i),function(n,e,t){return H(B(n,t&&t.relativeDate),J(e))}(t,r,o))},e.defaultProps={live:!0,className:""},e}(l.PureComponent),rn=tn;function on(){var n=(0,u.Z)(["\n  display: flex;\n  flex-direction: column;\n  height: 100vh;\n  overflow: hidden;\n  background-color: ",";\n"]);return on=function(){return n},n}function an(){var n=(0,u.Z)(["\n  position: sticky;\n  background-color: ",";\n  color: ",";\n  z-index: 100;\n  top: 0;\n  display: flex;\n  padding: 11px;\n  height: 80px;\n  align-items: center;\n  border-bottom: 1px solid ",";\n  flex-shrink: 0;\n"]);return an=function(){return n},n}function un(){var n=(0,u.Z)(["\n  margin-left: 15px;\n  flex: 1;\n  color: ",";\n\n  > h3 {\n    margin-bottom: 3px;\n    color: ",";\n  }\n  > p {\n    font-size: 14px;\n    color: ",";\n  }\n"]);return un=function(){return n},n}function cn(){var n=(0,u.Z)([""]);return cn=function(){return n},n}function dn(){var n=(0,u.Z)(["\n  padding: 30px;\n  background-color: ",";\n  flex: 1;\n  overflow-y: auto;\n  display: flex;\n  flex-direction: column;\n  min-height: 0;\n"]);return dn=function(){return n},n}function ln(){var n=(0,u.Z)(["\n  display: flex;\n  align-items: center;\n  padding: 10px;\n  background-color: ",";\n  gap: 10px;\n  flex-shrink: 0;\n  border-top: 1px solid ",";\n"]);return ln=function(){return n},n}function sn(){var n=(0,u.Z)(["\n  flex: 1;\n  flex-shrink: 1;\n  outline: 0;\n  border: none;\n  border-radius: 10px;\n  background-color: ",";\n  color: ",";\n  padding: 15px;\n  margin-left: 5px;\n  margin-right: 5px;\n  font-size: 16px;\n\n  ::placeholder {\n    color: ",";\n  }\n"]);return sn=function(){return n},n}function fn(){var n=(0,u.Z)(["\n  margin-bottom: 50px;\n"]);return fn=function(){return n},n}function pn(){var n=(0,u.Z)(["\n  text-align: center;\n  padding: 20px;\n  color: ",";\n  background-color: ",";\n  border: 1px solid ",";\n  border-radius: 4px;\n  margin: 20px;\n"]);return pn=function(){return n},n}function vn(){var n=(0,u.Z)(["\n  text-align: center;\n  padding: 20px;\n  color: ",";\n  background-color: ",";\n  border: 1px solid ",";\n  border-radius: 4px;\n  margin: 20px;\n"]);return vn=function(){return n},n}function mn(){var n=(0,u.Z)(["\n  color: ",";\n  background-color: ",";\n  border: 1px solid ",";\n  padding: 10px;\n  margin: 10px;\n  border-radius: 4px;\n  text-align: center;\n"]);return mn=function(){return n},n}function hn(){var n=(0,u.Z)(["\n  background-color: "," !important;\n  color: white !important;\n  padding: 10px 20px !important;\n  border: none !important;\n  border-radius: 8px !important;\n  cursor: pointer !important;\n  font-weight: 600 !important;\n  display: block !important;\n  width: auto !important;\n  height: auto !important;\n  visibility: visible !important;\n  opacity: "," !important;\n  \n  &:hover {\n    background-color: "," !important;\n  }\n\n  &:disabled {\n    cursor: not-allowed !important;\n  }\n"]);return hn=function(){return n},n}var xn=function(n){var e,t,u,s,x=n.chat,g=n.messages,b=(0,a.Z)((0,p.F_)(m.I8),1)[0],k=(0,f.useRouter)(),y=(0,l.useRef)(null),Z=(0,l.useState)(""),j=Z[0],w=Z[1],O=(0,l.useState)(!0),P=O[0],S=O[1],_=(0,l.useState)(null),z=_[0],N=(_[1],(0,l.useState)(null)),V=N[0],F=N[1],J=((0,l.useContext)(E.v)||{darkMode:!1}).darkMode;(0,l.useEffect)((function(){var n=function(){S(!0),(0,D.Ix)(m.db)},e=function(){S(!1),(0,D.TF)(m.db)};return window.addEventListener("online",n),window.addEventListener("offline",e),function(){window.removeEventListener("online",n),window.removeEventListener("offline",e)}}),[]);var R=(null===k||void 0===k||null===(e=k.query)||void 0===e?void 0:e.id)||null,$=(0,l.useMemo)((function(){return R?(0,D.hJ)(m.db,"chats",R,"messages"):null}),[R]),H=(0,l.useMemo)((function(){return $?(0,D.IO)($,(0,D.Xo)("timestamp","asc")):null}),[$]),B=(0,a.Z)((0,v.Kx)(H||null),1)[0],K=(0,D.hJ)(m.db,"users"),q=b&&x?(0,h.Z)(x.users,b):null,W=q?(0,D.IO)(K,(0,D.ar)("email","==",q)):null,X=(0,a.Z)((0,v.Kx)(W||null),1)[0],Y=function(){(null===y||void 0===y?void 0:y.current)&&y.current.scrollIntoView({behavior:"smooth",block:"start"})};(0,l.useEffect)((function(){Y()}),[B]);var G=function(){var n=(0,r.Z)((function(n){var e,t;return(0,c.__generator)(this,(function(r){switch(r.label){case 0:if(n.preventDefault(),F(null),!(null===j||void 0===j?void 0:j.trim())||!R||!b)return[2];r.label=1;case 1:return r.trys.push([1,4,,5]),e=(0,D.JU)(m.db,"users",b.uid),[4,(0,D.pl)(e,{lastSeen:(0,D.Bt)()},{merge:!0})];case 2:return r.sent(),[4,(0,D.ET)((0,D.hJ)(m.db,"chats",R,"messages"),{timestamp:(0,D.Bt)(),message:j,user:b.email,photoURL:b.photoURL})];case 3:return r.sent(),w(""),Y(),[3,5];case 4:return t=r.sent(),console.error("Error sending message:",t),F("Failed to send message. Please try again."),[3,5];case 5:return[2]}}))}));return function(e){return n.apply(this,arguments)}}(),Q=null===X||void 0===X||null===(t=X.docs)||void 0===t||null===(u=t[0])||void 0===u?void 0:u.data();return P?z?(0,d.jsx)(gn,{darkMode:J,children:(0,d.jsx)(Pn,{darkMode:J,children:z})}):(0,d.jsxs)(gn,{darkMode:J,children:[(0,d.jsxs)(bn,{darkMode:J,children:[Q?(0,d.jsx)(T.Z,{src:Q.photoURL}):(0,d.jsx)(T.Z,{children:q?q[0]:"?"}),(0,d.jsxs)(kn,{darkMode:J,children:[(0,d.jsx)("h3",{children:null!==q&&void 0!==q?q:"Loading..."}),(0,d.jsxs)("p",{children:["Last active:"," ",X?(null===Q||void 0===Q||null===(s=Q.lastSeen)||void 0===s?void 0:s.toDate)?(0,d.jsx)(rn,{datetime:Q.lastSeen.toDate()}):"user not registered":"Loading Last active..."]})]}),(0,d.jsxs)(yn,{children:[(0,d.jsx)(L.Z,{children:(0,d.jsx)(I.Z,{style:{color:J?"#e0e0e0":"inherit"}})}),(0,d.jsx)(L.Z,{children:(0,d.jsx)(A.Z,{style:{color:J?"#e0e0e0":"inherit"}})})]})]}),(0,d.jsxs)(Zn,{darkMode:J,children:[B?B.docs.map((function(n){var e;return(0,d.jsx)(M,{user:n.data().user,message:i((0,o.Z)({},n.data()),{timestamp:null===(e=n.data().timestamp)||void 0===e?void 0:e.toMillis()})},n.id)})):g?JSON.parse(g).map((function(n){return(0,d.jsx)(M,{user:n.user,message:n},n.id)})):null,V&&(0,d.jsx)(Sn,{darkMode:J,children:V}),(0,d.jsx)(wn,{ref:y})]}),(0,d.jsxs)(jn,{onSubmit:G,darkMode:J,children:[(0,d.jsx)(L.Z,{children:(0,d.jsx)(C.Z,{style:{color:J?"#e0e0e0":"inherit"}})}),(0,d.jsx)(Mn,{darkMode:J,value:j,onChange:function(n){return w(n.target.value)},placeholder:"Type a message",type:"text"}),(0,d.jsx)(_n,{type:"submit",disabled:!(null===j||void 0===j?void 0:j.trim()),darkMode:J,children:"Send"}),(0,d.jsx)(L.Z,{children:(0,d.jsx)(U.Z,{style:{color:J?"#e0e0e0":"inherit"}})})]})]}):(0,d.jsx)(gn,{darkMode:J,children:(0,d.jsx)(On,{darkMode:J,children:"You are currently offline. Please check your internet connection."})})},gn=s.ZP.div(on(),(function(n){return n.darkMode?"#1e1e1e":"white"})),bn=s.ZP.div(an(),(function(n){return n.darkMode?"#2a2a2a":"white"}),(function(n){return n.darkMode?"#e0e0e0":"black"}),(function(n){return n.darkMode?"#333":"whitesmoke"})),kn=s.ZP.div(un(),(function(n){return n.darkMode?"#e0e0e0":"black"}),(function(n){return n.darkMode?"#e0e0e0":"black"}),(function(n){return n.darkMode?"#aaa":"gray"})),yn=s.ZP.div(cn()),Zn=s.ZP.div(dn(),(function(n){return n.darkMode?"#0d1117":"#e5ded8"})),jn=s.ZP.form(ln(),(function(n){return n.darkMode?"#2a2a2a":"white"}),(function(n){return n.darkMode?"#333":"whitesmoke"})),Mn=s.ZP.input(sn(),(function(n){return n.darkMode?"#1e1e1e":"whitesmoke"}),(function(n){return n.darkMode?"#e0e0e0":"black"}),(function(n){return n.darkMode?"#888":"#999"})),wn=s.ZP.div(fn()),On=s.ZP.div(pn(),(function(n){return n.darkMode?"#f8d7da":"#721c24"}),(function(n){return n.darkMode?"#5a1f1f":"#f8d7da"}),(function(n){return n.darkMode?"#721c24":"#f5c6cb"})),Pn=s.ZP.div(vn(),(function(n){return n.darkMode?"#ffeeba":"#856404"}),(function(n){return n.darkMode?"#664d03":"#fff3cd"}),(function(n){return n.darkMode?"#856404":"#ffeeba"})),Sn=s.ZP.div(mn(),(function(n){return n.darkMode?"#f8d7da":"#721c24"}),(function(n){return n.darkMode?"#5a1f1f":"#f8d7da"}),(function(n){return n.darkMode?"#721c24":"#f5c6cb"})),_n=s.ZP.button(hn(),(function(n){return n.darkMode?"#d32f2f":"#f44336"}),(function(n){return n.disabled?"0.5":"1"}),(function(n){return n.darkMode?"#b71c1c":"#d32f2f"}))},7896:function(n,e){e.Z=function(n,e){return null===n||void 0===n?void 0:n.filter((function(n){return n!==(null===e||void 0===e?void 0:e.email)}))[0]}}}]);