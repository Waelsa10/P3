(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[934],{4900:function(n,t,e){"use strict";var r=e(4836);t.Z=void 0;var i=r(e(4938)),o=e(5893);t.Z=(0,i.default)((0,o.jsx)("path",{d:"M16.5 6v11.5c0 2.21-1.79 4-4 4s-4-1.79-4-4V5c0-1.38 1.12-2.5 2.5-2.5s2.5 1.12 2.5 2.5v10.5c0 .55-.45 1-1 1s-1-.45-1-1V6H10v9.5c0 1.38 1.12 2.5 2.5 2.5s2.5-1.12 2.5-2.5V5c0-2.21-1.79-4-4-4S7 2.79 7 5v12.5c0 3.04 2.46 5.5 5.5 5.5s5.5-2.46 5.5-5.5V6z"}),"AttachFile")},3358:function(n,t,e){"use strict";var r=e(4836);t.Z=void 0;var i=r(e(4938)),o=e(5893);t.Z=(0,i.default)((0,o.jsx)("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2M12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8m3.5-9c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5m-7 0c.83 0 1.5-.67 1.5-1.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11m3.5 6.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5"}),"InsertEmoticon")},642:function(n,t,e){"use strict";var r=e(4836);t.Z=void 0;var i=r(e(4938)),o=e(5893);t.Z=(0,i.default)((0,o.jsx)("path",{d:"M12 14c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3m5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.48 6-3.3 6-6.72z"}),"Mic")},495:function(n,t,e){(window.__NEXT_P=window.__NEXT_P||[]).push(["/chat/[id]",function(){return e(2523)}])},6467:function(n,t,e){"use strict";e.d(t,{Z:function(){return C}});var r=e(7568),i=e(603),o=e(7297),u=e(7582),a=e(5893),c=(e(7294),e(3349)),s=e(3653),l=e(66),d=e(9800),f=e(9417),p=e(3946),h=e(1403),v=e(7976),x=e(2761),m=e(1163),g=e(6677),Z=e(7896),b=e(6100);function j(){var n=(0,o.Z)(["\n  display: flex;\n  align-items: center;\n  cursor: pointer;\n  padding: 15px;\n  word-break: break-word;\n\n  :hover {\n    background-color: #e9eaeb;\n  }\n"]);return j=function(){return n},n}function y(){var n=(0,o.Z)(["\n  margin: 5px;\n  margin-right: 15px;\n"]);return y=function(){return n},n}var w=function(n){var t,e,r=n.id,o=n.users,u=(0,m.useRouter)(),l=(0,i.Z)((0,c.F_)(s.I8),1)[0],d=(0,b.IO)((0,b.hJ)(s.db,"users"),(0,b.ar)("email","==",(0,Z.Z)(o,l))),f=(0,i.Z)((0,g.Kx)(d),1)[0],p=null===f||void 0===f||null===(t=f.docs)||void 0===t||null===(e=t[0])||void 0===e?void 0:e.data(),h=(0,Z.Z)(o,l);return(0,a.jsxs)(P,{onClick:function(){u.push("/chat/".concat(r))},children:[p?(0,a.jsx)(O,{src:p.photoURL}):(0,a.jsx)(O,{children:h[0]}),(0,a.jsx)("p",{children:h})]})},P=l.ZP.div(j()),O=(0,l.ZP)(d.Z)(y()),_=e(3999);function k(){var n=(0,o.Z)(["\n  flex: 0.45;\n  border-right: 1px solid whitesmoke;\n  height: 100vh;\n  min-width: 300px;\n  max-width: 350px;\n  overflow-y: scroll;\n\n  ::-webkit-scrollbar {\n    display: none;\n  }\n\n  -ms-overflow-style: none; /* IE and Edge */\n  scrollbar-width: none; /* Firefox */\n"]);return k=function(){return n},n}function S(){var n=(0,o.Z)(["\n  cursor: pointer;\n\n  :hover {\n    opacity: 0.8;\n  }\n"]);return S=function(){return n},n}function E(){var n=(0,o.Z)(["\n  width: 100%;\n  &&& {\n    border-top: 1px solid whitesmoke;\n    border-bottom: 1px solid whitesmoke;\n  }\n"]);return E=function(){return n},n}function I(){var n=(0,o.Z)(["\n  display: flex;\n  align-items: center;\n  padding: 5px;\n  border-radius: 2px;\n  padding: 20px;\n"]);return I=function(){return n},n}function D(){var n=(0,o.Z)(["\n  outline-width: 0;\n  border: none;\n  flex: 1;\n"]);return D=function(){return n},n}function T(){var n=(0,o.Z)(["\n  display: flex;\n  position: sticky;\n  top: 0;\n  background-color: white;\n  z-index: 1;\n  justify-content: space-between;\n  align-items: center;\n  padding: 15px;\n  height: 80px;\n  border-bottom: 1px solid whitesmoke;\n"]);return T=function(){return n},n}function M(){var n=(0,o.Z)([""]);return M=function(){return n},n}var C=function(){var n=(0,i.Z)((0,c.F_)(s.I8),1)[0],t=(0,b.IO)((0,b.hJ)(s.db,"chats"),(0,b.ar)("users","array-contains",n.email)),e=(0,i.Z)((0,g.Kx)(t),1)[0],o=function(){var t=(0,r.Z)((function(){var t;return(0,u.__generator)(this,(function(e){switch(e.label){case 0:return(t=prompt("Please enter an email address for the user you wish to chat with"))?!_.G(t)||l(t)||t===n.email?[3,2]:[4,(0,b.ET)((0,b.hJ)(s.db,"chats"),{users:[n.email,t]})]:[2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}));return function(){return t.apply(this,arguments)}}(),l=function(n){return!!(null===e||void 0===e?void 0:e.docs.find((function(t){return t.data().users.includes(n)})))};return(0,a.jsxs)(U,{children:[(0,a.jsxs)(F,{children:[(0,a.jsx)(N,{onClick:function(){return s.I8.signOut()},src:n.photoURL}),(0,a.jsxs)(R,{children:[(0,a.jsx)(p.Z,{children:(0,a.jsx)(h.Z,{})}),(0,a.jsx)(p.Z,{children:(0,a.jsx)(v.Z,{})})]})]}),(0,a.jsxs)(A,{children:[(0,a.jsx)(x.Z,{}),(0,a.jsx)(z,{placeholder:"Search in chats",type:"text"})]}),(0,a.jsx)(L,{onClick:o,children:"Start a new chat"}),null===e||void 0===e?void 0:e.docs.map((function(n){return(0,a.jsx)(w,{id:n.id,users:n.data().users},n.id)}))]})},U=l.ZP.div(k()),N=(0,l.ZP)(d.Z)(S()),L=(0,l.ZP)(f.Z)(E()),A=l.ZP.div(I()),z=l.ZP.input(D()),F=l.ZP.div(T()),R=l.ZP.div(M())},2523:function(n,t,e){"use strict";e.r(t),e.d(t,{__N_SSP:function(){return _n},default:function(){return kn}});var r=e(603),i=e(7297),o=e(5893),u=e(7294),a=e(3653),c=e(66),s=e(6467),l=e(7568),d=e(1799);function f(n,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):function(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),e.push.apply(e,r)}return e}(Object(t)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))})),n}var p=e(7582),h=e(1163),v=e(3349),x=e(6677),m=e(7896),g=e(381),Z=e.n(g);function b(){var n=(0,i.Z)([""]);return b=function(){return n},n}function j(){var n=(0,i.Z)(["\n  width: fit-content;\n  padding: 15px;\n  border-radius: 8px;\n  margin: 10px;\n  min-width: 60px;\n  padding-bottom: 26px;\n  position: relative;\n  text-align: right;\n"]);return j=function(){return n},n}function y(){var n=(0,i.Z)(["\n  margin-left: auto;\n  background-color: #dcf8c6;\n"]);return y=function(){return n},n}function w(){var n=(0,i.Z)(["\n  background-color: whitesmoke;\n  text-align: left;\n"]);return w=function(){return n},n}function P(){var n=(0,i.Z)(["\n  color: gray;\n  padding: 10px;\n  font-size: 9px;\n  position: absolute;\n  bottom: 0;\n  text-align: right;\n  right: 0;\n"]);return P=function(){return n},n}var O=function(n){var t=n.user,e=n.message,i=t===(0,r.Z)((0,v.F_)(a.I8),1)[0].email?S:E;return(0,o.jsx)(_,{children:(0,o.jsxs)(i,{children:[e.message,(0,o.jsx)(I,{children:e.timestamp?Z()(e.timestamp).format("LT"):"..."})]})})},_=c.ZP.div(b()),k=c.ZP.p(j()),S=(0,c.ZP)(k)(y()),E=(0,c.ZP)(k)(w()),I=c.ZP.span(P()),D=e(6100),T=e(9800),M=e(3946),C=e(4900),U=e(3358),N=e(7976),L=e(642),A=["second","minute","hour","day","week","month","year"];var z=["\u79d2","\u5206\u949f","\u5c0f\u65f6","\u5929","\u5468","\u4e2a\u6708","\u5e74"];var F={},R=function(n,t){F[n]=t},J=function(n){return F[n]||F.en_US},V=[60,60,24,7,365/7/12,12];function $(n){return n instanceof Date?n:!isNaN(n)||/^\d+$/.test(n)?new Date(parseInt(n)):(n=(n||"").trim().replace(/\.\d+/,"").replace(/-/,"/").replace(/-/,"/").replace(/(\d)T(\d)/,"$1 $2").replace(/Z/," UTC").replace(/([+-]\d\d):?(\d\d)/," $1$2"),new Date(n))}function K(n,t){for(var e=n<0?1:0,r=n=Math.abs(n),i=0;n>=V[i]&&i<V.length;i++)n/=V[i];return(n=Math.floor(n))>(0===(i*=2)?9:1)&&(i+=1),t(n,i,r)[e].replace("%s",n.toString())}function H(n,t){return(+(t?$(t):new Date)-+$(n))/1e3}var X="timeago-id";function B(n){return parseInt(n.getAttribute(X))}var q={},G=function(n){clearTimeout(n),delete q[n]};function W(n,t,e,r){G(B(n));var i=r.relativeDate,o=r.minInterval,u=H(t,i);n.innerText=K(u,e);var a=setTimeout((function(){W(n,t,e,r)}),Math.min(1e3*Math.max(function(n){for(var t=1,e=0,r=Math.abs(n);n>=V[e]&&e<V.length;e++)n/=V[e],t*=V[e];return r=(r%=t)?t-r:t,Math.ceil(r)}(u),o||1),2147483647));q[a]=0,function(n,t){n.setAttribute(X,t)}(n,a)}function Q(n){n?G(B(n)):Object.keys(q).forEach(G)}R("en_US",(function(n,t){if(0===t)return["just now","right now"];var e=A[Math.floor(t/2)];return n>1&&(e+="s"),[n+" "+e+" ago","in "+n+" "+e]})),R("zh_CN",(function(n,t){if(0===t)return["\u521a\u521a","\u7247\u523b\u540e"];var e=z[~~(t/2)];return[n+" "+e+"\u524d",n+" "+e+"\u540e"]}));var Y=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e])},n(t,e)};return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),nn=function(){return nn=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n},nn.apply(this,arguments)},tn=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(null!=n&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]])}return e},en=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.dom=null,t}return Y(t,n),t.prototype.componentDidMount=function(){this.renderTimeAgo()},t.prototype.componentDidUpdate=function(){this.renderTimeAgo()},t.prototype.renderTimeAgo=function(){var n,t=this.props,e=t.live,r=t.datetime,i=t.locale,o=t.opts;Q(this.dom),!1!==e&&(this.dom.setAttribute("datetime",""+((n=r)instanceof Date?n.getTime():n)),function(n,t,e){var r=n.length?n:[n];r.forEach((function(n){W(n,function(n){return n.getAttribute("datetime")}(n),J(t),e||{})}))}(this.dom,i,o))},t.prototype.componentWillUnmount=function(){Q(this.dom)},t.prototype.render=function(){var n=this,t=this.props,e=t.datetime,r=(t.live,t.locale),i=t.opts,o=tn(t,["datetime","live","locale","opts"]);return u.createElement("time",nn({ref:function(t){n.dom=t}},o),function(n,t,e){return K(H(n,e&&e.relativeDate),J(t))}(e,r,i))},t.defaultProps={live:!0,className:""},t}(u.PureComponent),rn=en;function on(){var n=(0,i.Z)(["\n  display: flex;\n  flex-direction: column;\n"]);return on=function(){return n},n}function un(){var n=(0,i.Z)(["\n  position: sticky;\n  background-color: white;\n  z-index: 100;\n  top: 0;\n  display: flex;\n  padding: 11px;\n  height: 80px;\n  align-items: center;\n  border-bottom: 1px solid whitesmoke;\n"]);return un=function(){return n},n}function an(){var n=(0,i.Z)(["\n  margin-left: 15px;\n  flex: 1;\n\n  > h3 {\n    margin-bottom: 3px;\n  }\n  > p {\n    font-size: 14px;\n    color: gray;\n  }\n"]);return an=function(){return n},n}function cn(){var n=(0,i.Z)([""]);return cn=function(){return n},n}function sn(){var n=(0,i.Z)(["\n  padding: 30px;\n  background-color: #e5ded8;\n  min-height: 90vh;\n"]);return sn=function(){return n},n}function ln(){var n=(0,i.Z)(["\n  display: flex;\n  align-items: center;\n  padding: 10px;\n  position: sticky;\n  bottom: 0;\n  background-color: white;\n  z-index: 100;\n"]);return ln=function(){return n},n}function dn(){var n=(0,i.Z)(["\n  flex: 1;\n  outline: 0;\n  border: none;\n  border-radius: 10px;\n  background-color: whitesmoke;\n  padding: 20px;\n  margin-left: 15px;\n  margin-right: 15px;\n"]);return dn=function(){return n},n}function fn(){var n=(0,i.Z)(["\n  margin-bottom: 50px;\n"]);return fn=function(){return n},n}var pn=function(n){var t,e,i,c=n.chat,s=n.messages,g=(0,r.Z)((0,v.F_)(a.I8),1)[0],Z=(0,h.useRouter)(),b=(0,u.useRef)(null),j=(0,u.useState)(""),y=j[0],w=j[1],P=(0,D.hJ)(a.db,"chats",Z.query.id,"messages"),_=(0,D.IO)(P,(0,D.Xo)("timestamp","asc")),k=(0,r.Z)((0,x.Kx)(_),1)[0],S=(0,D.hJ)(a.db,"users"),E=(0,D.IO)(S,(0,D.ar)("email","==",(0,m.Z)(c.users,g))),I=(0,r.Z)((0,x.Kx)(E),1)[0],A=function(){var n=(0,l.Z)((function(n){var t;return(0,p.__generator)(this,(function(e){switch(e.label){case 0:return n.preventDefault(),t=(0,D.JU)(a.db,"users",g.uid),[4,(0,D.pl)(t,{lastSeen:(0,D.Bt)()},{merge:!0})];case 1:return e.sent(),[4,(0,D.ET)(P,{timestamp:(0,D.Bt)(),message:y,user:g.email,photoURL:g.photoURL})];case 2:return e.sent(),w(""),b.current.scrollIntoView({behavior:"smooth",block:"start"}),[2]}}))}));return function(t){return n.apply(this,arguments)}}(),z=null===I||void 0===I||null===(t=I.docs)||void 0===t||null===(e=t[0])||void 0===e?void 0:e.data(),F=(0,m.Z)(c.users,g);return(0,o.jsxs)(hn,{children:[(0,o.jsxs)(vn,{children:[z?(0,o.jsx)(T.Z,{src:z.photoURL}):(0,o.jsx)(T.Z,{children:F[0]}),(0,o.jsxs)(xn,{children:[(0,o.jsx)("h3",{children:F}),(0,o.jsxs)("p",{children:["Last active:"," ",I?(null===z||void 0===z||null===(i=z.lastSeen)||void 0===i?void 0:i.toDate)?(0,o.jsx)(rn,{datetime:z.lastSeen.toDate()}):"Unavailable":"Loading Last active..."]})]}),(0,o.jsxs)(mn,{children:[(0,o.jsx)(M.Z,{children:(0,o.jsx)(C.Z,{})}),(0,o.jsx)(M.Z,{children:(0,o.jsx)(N.Z,{})})]})]}),(0,o.jsxs)(gn,{children:[k?k.docs.map((function(n){var t;return(0,o.jsx)(O,{user:n.data().user,message:f((0,d.Z)({},n.data()),{timestamp:null===(t=n.data().timestamp)||void 0===t?void 0:t.toMillis()})},n.id)})):JSON.parse(s).map((function(n){return(0,o.jsx)(O,{user:n.user,message:n},n.id)})),(0,o.jsx)(jn,{ref:b})]}),(0,o.jsxs)(Zn,{onSubmit:A,children:[(0,o.jsx)(U.Z,{}),(0,o.jsx)(bn,{value:y,onChange:function(n){return w(n.target.value)},type:"text"}),(0,o.jsx)("button",{hidden:!0,disabled:!y,type:"submit",children:"Send"}),(0,o.jsx)(L.Z,{})]})]})},hn=c.ZP.div(on()),vn=c.ZP.div(un()),xn=c.ZP.div(an()),mn=c.ZP.div(cn()),gn=c.ZP.div(sn()),Zn=c.ZP.form(ln()),bn=c.ZP.input(dn()),jn=c.ZP.div(fn()),yn=e(9008),wn=e.n(yn);function Pn(){var n=(0,i.Z)(["\n  display: flex;\n  box-shadow: 1px 1px 4px -1px rgba(0, 0, 0, 0.75);\n"]);return Pn=function(){return n},n}function On(){var n=(0,i.Z)(["\n  flex: 1;\n  overflow: scroll;\n  height: 100vh;\n\n  ::-webkit-scrollbar {\n    display: none;\n  }\n  -ms-overflow-style: none; /* IE and Edge */\n  scrollbar-width: none; /* Firefox */\n"]);return On=function(){return n},n}var _n=!0,kn=function(n){var t=n.chat,e=n.messages,i=(0,r.Z)((0,v.F_)(a.I8),1)[0];return(0,o.jsxs)(Sn,{children:[(0,o.jsx)(wn(),{children:(0,o.jsxs)("title",{children:["Chat with ",(0,m.Z)(t.users,i)]})}),(0,o.jsx)(s.Z,{}),(0,o.jsx)(En,{children:(0,o.jsx)(pn,{chat:t,messages:e})})]})},Sn=c.ZP.div(Pn()),En=c.ZP.div(On())},7896:function(n,t){"use strict";t.Z=function(n,t){return null===n||void 0===n?void 0:n.filter((function(n){return n!==(null===t||void 0===t?void 0:t.email)}))[0]}}},function(n){n.O(0,[885,822,774,888,179],(function(){return t=495,n(n.s=t);var t}));var t=n.O();_N_E=t}]);